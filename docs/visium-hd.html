<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Visium HD | Workshop: Spatial multi-omics data analysis with Giotto Suite</title>
  <meta name="description" content="9 Visium HD | Workshop: Spatial multi-omics data analysis with Giotto Suite" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Visium HD | Workshop: Spatial multi-omics data analysis with Giotto Suite" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="drieslab/giotto_workshop_2024" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Visium HD | Workshop: Spatial multi-omics data analysis with Giotto Suite" />
  
  
  

<meta name="author" content="Ruben Dries, Jiaji George Chen, Joselyn Cristina Chávez-Fuentes, Junxiang Xu ,Edward Ruiz, Jeff Sheridan, Iqra Amin, Wen Wang" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="visium-part-ii.html"/>
<link rel="next" href="xenium-1.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Giotto Suite Workshop 2024</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#instructors"><i class="fa fa-check"></i><b>1.1</b> Instructors</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#topics-and-schedule"><i class="fa fa-check"></i><b>1.2</b> Topics and Schedule:</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i><b>1.3</b> License</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="datasets-packages.html"><a href="datasets-packages.html"><i class="fa fa-check"></i><b>2</b> Datasets &amp; Packages</a>
<ul>
<li class="chapter" data-level="2.1" data-path="datasets-packages.html"><a href="datasets-packages.html#datasets-to-download"><i class="fa fa-check"></i><b>2.1</b> Datasets to download</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="datasets-packages.html"><a href="datasets-packages.html#zenodo-repository"><i class="fa fa-check"></i><b>2.1.1</b> Zenodo repository</a></li>
<li class="chapter" data-level="2.1.2" data-path="datasets-packages.html"><a href="datasets-packages.html#x-genomics-visium-mouse-brain-section-coronal-dataset"><i class="fa fa-check"></i><b>2.1.2</b> 10X Genomics Visium Mouse Brain Section (Coronal) dataset</a></li>
<li class="chapter" data-level="2.1.3" data-path="datasets-packages.html"><a href="datasets-packages.html#x-genomics-visium-hd-ffpe-human-colon-cancer"><i class="fa fa-check"></i><b>2.1.3</b> 10X Genomics Visium HD: FFPE Human Colon Cancer</a></li>
<li class="chapter" data-level="2.1.4" data-path="datasets-packages.html"><a href="datasets-packages.html#x-genomics-multi-modal-dataset"><i class="fa fa-check"></i><b>2.1.4</b> 10X Genomics multi-modal dataset</a></li>
<li class="chapter" data-level="2.1.5" data-path="datasets-packages.html"><a href="datasets-packages.html#x-genomics-multi-omics-visium-cytassist-human-tonsil-dataset"><i class="fa fa-check"></i><b>2.1.5</b> 10X Genomics multi-omics Visium CytAssist Human Tonsil dataset</a></li>
<li class="chapter" data-level="2.1.6" data-path="datasets-packages.html"><a href="datasets-packages.html#x-genomics-human-prostate-cancer-adenocarcinoma-with-invasive-carcinoma-ffpe"><i class="fa fa-check"></i><b>2.1.6</b> 10X Genomics Human Prostate Cancer Adenocarcinoma with Invasive Carcinoma (FFPE)</a></li>
<li class="chapter" data-level="2.1.7" data-path="datasets-packages.html"><a href="datasets-packages.html#x-genomics-normal-human-prostate-ffpe"><i class="fa fa-check"></i><b>2.1.7</b> 10X Genomics Normal Human Prostate (FFPE)</a></li>
<li class="chapter" data-level="2.1.8" data-path="datasets-packages.html"><a href="datasets-packages.html#xenium"><i class="fa fa-check"></i><b>2.1.8</b> Xenium</a></li>
<li class="chapter" data-level="2.1.9" data-path="datasets-packages.html"><a href="datasets-packages.html#merfish-cortex-dataset"><i class="fa fa-check"></i><b>2.1.9</b> MERFISH cortex dataset</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="datasets-packages.html"><a href="datasets-packages.html#needed-packages"><i class="fa fa-check"></i><b>2.2</b> Needed packages</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="datasets-packages.html"><a href="datasets-packages.html#cran-dependencies"><i class="fa fa-check"></i><b>2.2.1</b> CRAN dependencies:</a></li>
<li class="chapter" data-level="2.2.2" data-path="datasets-packages.html"><a href="datasets-packages.html#terra-installation"><i class="fa fa-check"></i><b>2.2.2</b> <em>terra</em> installation</a></li>
<li class="chapter" data-level="2.2.3" data-path="datasets-packages.html"><a href="datasets-packages.html#matrix-installation"><i class="fa fa-check"></i><b>2.2.3</b> <em>Matrix</em> installation</a></li>
<li class="chapter" data-level="2.2.4" data-path="datasets-packages.html"><a href="datasets-packages.html#rtools-installation"><i class="fa fa-check"></i><b>2.2.4</b> <em>Rtools</em> installation</a></li>
<li class="chapter" data-level="2.2.5" data-path="datasets-packages.html"><a href="datasets-packages.html#giotto-installation"><i class="fa fa-check"></i><b>2.2.5</b> <em>Giotto</em> installation</a></li>
<li class="chapter" data-level="2.2.6" data-path="datasets-packages.html"><a href="datasets-packages.html#irlba-install"><i class="fa fa-check"></i><b>2.2.6</b> <em>irlba</em> install</a></li>
<li class="chapter" data-level="2.2.7" data-path="datasets-packages.html"><a href="datasets-packages.html#arrow-install"><i class="fa fa-check"></i><b>2.2.7</b> <em>arrow</em> install</a></li>
<li class="chapter" data-level="2.2.8" data-path="datasets-packages.html"><a href="datasets-packages.html#bioconductor-dependencies"><i class="fa fa-check"></i><b>2.2.8</b> Bioconductor dependencies:</a></li>
<li class="chapter" data-level="2.2.9" data-path="datasets-packages.html"><a href="datasets-packages.html#cran-packages"><i class="fa fa-check"></i><b>2.2.9</b> CRAN packages:</a></li>
<li class="chapter" data-level="2.2.10" data-path="datasets-packages.html"><a href="datasets-packages.html#packages-from-github"><i class="fa fa-check"></i><b>2.2.10</b> Packages from GitHub</a></li>
<li class="chapter" data-level="2.2.11" data-path="datasets-packages.html"><a href="datasets-packages.html#python-environments"><i class="fa fa-check"></i><b>2.2.11</b> Python environments</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="spatial-omics-technologies.html"><a href="spatial-omics-technologies.html"><i class="fa fa-check"></i><b>3</b> Spatial omics technologies</a>
<ul>
<li class="chapter" data-level="3.1" data-path="spatial-omics-technologies.html"><a href="spatial-omics-technologies.html#presentation"><i class="fa fa-check"></i><b>3.1</b> Presentation</a></li>
<li class="chapter" data-level="3.2" data-path="spatial-omics-technologies.html"><a href="spatial-omics-technologies.html#short-summary"><i class="fa fa-check"></i><b>3.2</b> Short summary</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="spatial-omics-technologies.html"><a href="spatial-omics-technologies.html#why-do-we-need-spatial-omics-technologies"><i class="fa fa-check"></i><b>3.2.1</b> Why do we need spatial omics technologies?</a></li>
<li class="chapter" data-level="3.2.2" data-path="spatial-omics-technologies.html"><a href="spatial-omics-technologies.html#what-is-spatial-omics"><i class="fa fa-check"></i><b>3.2.2</b> What is spatial omics?</a></li>
<li class="chapter" data-level="3.2.3" data-path="spatial-omics-technologies.html"><a href="spatial-omics-technologies.html#what-are-the-main-spatial-omics-technologies"><i class="fa fa-check"></i><b>3.2.3</b> What are the main spatial omics technologies?</a></li>
<li class="chapter" data-level="3.2.4" data-path="spatial-omics-technologies.html"><a href="spatial-omics-technologies.html#other-spatial-omics-atac-seq-cuttag-lipidomics-etc"><i class="fa fa-check"></i><b>3.2.4</b> Other Spatial omics: ATAC-seq, CUT&amp;Tag, lipidomics, etc</a></li>
<li class="chapter" data-level="3.2.5" data-path="spatial-omics-technologies.html"><a href="spatial-omics-technologies.html#what-are-the-different-types-of-spatial-downstream-analyses"><i class="fa fa-check"></i><b>3.2.5</b> What are the different types of spatial downstream analyses?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introduction-to-the-giotto-package.html"><a href="introduction-to-the-giotto-package.html"><i class="fa fa-check"></i><b>4</b> Introduction to the Giotto package</a>
<ul>
<li class="chapter" data-level="4.1" data-path="introduction-to-the-giotto-package.html"><a href="introduction-to-the-giotto-package.html#presentation-1"><i class="fa fa-check"></i><b>4.1</b> Presentation</a></li>
<li class="chapter" data-level="4.2" data-path="introduction-to-the-giotto-package.html"><a href="introduction-to-the-giotto-package.html#ecosystem"><i class="fa fa-check"></i><b>4.2</b> Ecosystem</a></li>
<li class="chapter" data-level="4.3" data-path="introduction-to-the-giotto-package.html"><a href="introduction-to-the-giotto-package.html#installation-python-environment"><i class="fa fa-check"></i><b>4.3</b> Installation + python environment</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="introduction-to-the-giotto-package.html"><a href="introduction-to-the-giotto-package.html#giotto-installation-1"><i class="fa fa-check"></i><b>4.3.1</b> Giotto installation</a></li>
<li class="chapter" data-level="4.3.2" data-path="introduction-to-the-giotto-package.html"><a href="introduction-to-the-giotto-package.html#python-environment"><i class="fa fa-check"></i><b>4.3.2</b> Python environment</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="introduction-to-the-giotto-package.html"><a href="introduction-to-the-giotto-package.html#giotto-instructions"><i class="fa fa-check"></i><b>4.4</b> Giotto instructions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-formatting-and-pre-processing.html"><a href="data-formatting-and-pre-processing.html"><i class="fa fa-check"></i><b>5</b> Data formatting and Pre-processing</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-formatting-and-pre-processing.html"><a href="data-formatting-and-pre-processing.html#data-formats"><i class="fa fa-check"></i><b>5.1</b> Data formats</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="data-formatting-and-pre-processing.html"><a href="data-formatting-and-pre-processing.html#general-formats"><i class="fa fa-check"></i><b>5.1.1</b> General formats</a></li>
<li class="chapter" data-level="5.1.2" data-path="data-formatting-and-pre-processing.html"><a href="data-formatting-and-pre-processing.html#matrix-formats"><i class="fa fa-check"></i><b>5.1.2</b> Matrix formats</a></li>
<li class="chapter" data-level="5.1.3" data-path="data-formatting-and-pre-processing.html"><a href="data-formatting-and-pre-processing.html#tabular-formats"><i class="fa fa-check"></i><b>5.1.3</b> Tabular formats</a></li>
<li class="chapter" data-level="5.1.4" data-path="data-formatting-and-pre-processing.html"><a href="data-formatting-and-pre-processing.html#spatial-formats"><i class="fa fa-check"></i><b>5.1.4</b> Spatial formats</a></li>
<li class="chapter" data-level="5.1.5" data-path="data-formatting-and-pre-processing.html"><a href="data-formatting-and-pre-processing.html#mask-files"><i class="fa fa-check"></i><b>5.1.5</b> Mask files</a></li>
<li class="chapter" data-level="5.1.6" data-path="data-formatting-and-pre-processing.html"><a href="data-formatting-and-pre-processing.html#images"><i class="fa fa-check"></i><b>5.1.6</b> images</a></li>
<li class="chapter" data-level="5.1.7" data-path="data-formatting-and-pre-processing.html"><a href="data-formatting-and-pre-processing.html#jsonlike-formats"><i class="fa fa-check"></i><b>5.1.7</b> jsonlike formats</a></li>
<li class="chapter" data-level="5.1.8" data-path="data-formatting-and-pre-processing.html"><a href="data-formatting-and-pre-processing.html#hierarchical-formats"><i class="fa fa-check"></i><b>5.1.8</b> Hierarchical formats</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="data-formatting-and-pre-processing.html"><a href="data-formatting-and-pre-processing.html#pre-processing"><i class="fa fa-check"></i><b>5.2</b> Pre-processing</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="data-formatting-and-pre-processing.html"><a href="data-formatting-and-pre-processing.html#expression-matrix"><i class="fa fa-check"></i><b>5.2.1</b> Expression matrix</a></li>
<li class="chapter" data-level="5.2.2" data-path="data-formatting-and-pre-processing.html"><a href="data-formatting-and-pre-processing.html#spatial-locations"><i class="fa fa-check"></i><b>5.2.2</b> Spatial locations</a></li>
<li class="chapter" data-level="5.2.3" data-path="data-formatting-and-pre-processing.html"><a href="data-formatting-and-pre-processing.html#giottopoints"><i class="fa fa-check"></i><b>5.2.3</b> giottoPoints</a></li>
<li class="chapter" data-level="5.2.4" data-path="data-formatting-and-pre-processing.html"><a href="data-formatting-and-pre-processing.html#giottopolygon"><i class="fa fa-check"></i><b>5.2.4</b> giottoPolygon</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="data-formatting-and-pre-processing.html"><a href="data-formatting-and-pre-processing.html#subobject-utility-functions"><i class="fa fa-check"></i><b>5.3</b> Subobject utility functions</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="data-formatting-and-pre-processing.html"><a href="data-formatting-and-pre-processing.html#ids"><i class="fa fa-check"></i><b>5.3.1</b> IDs</a></li>
<li class="chapter" data-level="5.3.2" data-path="data-formatting-and-pre-processing.html"><a href="data-formatting-and-pre-processing.html#bracket-subsetting-and-extraction"><i class="fa fa-check"></i><b>5.3.2</b> Bracket subsetting and extraction</a></li>
<li class="chapter" data-level="5.3.3" data-path="data-formatting-and-pre-processing.html"><a href="data-formatting-and-pre-processing.html#nesting-metadata-generics"><i class="fa fa-check"></i><b>5.3.3</b> Nesting metadata generics</a></li>
<li class="chapter" data-level="5.3.4" data-path="data-formatting-and-pre-processing.html"><a href="data-formatting-and-pre-processing.html#appending-to-a-giotto-object"><i class="fa fa-check"></i><b>5.3.4</b> Appending to a giotto object</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="creating-a-giotto-object.html"><a href="creating-a-giotto-object.html"><i class="fa fa-check"></i><b>6</b> Creating a Giotto object</a>
<ul>
<li class="chapter" data-level="6.0.1" data-path="creating-a-giotto-object.html"><a href="creating-a-giotto-object.html#used-packages"><i class="fa fa-check"></i><b>6.0.1</b> Used packages</a></li>
<li class="chapter" data-level="6.1" data-path="creating-a-giotto-object.html"><a href="creating-a-giotto-object.html#overview"><i class="fa fa-check"></i><b>6.1</b> Overview</a></li>
<li class="chapter" data-level="6.2" data-path="creating-a-giotto-object.html"><a href="creating-a-giotto-object.html#from-matrix-locations"><i class="fa fa-check"></i><b>6.2</b> From matrix + locations</a></li>
<li class="chapter" data-level="6.3" data-path="creating-a-giotto-object.html"><a href="creating-a-giotto-object.html#from-subcellular-raw-data-transcripts-or-images-polygons"><i class="fa fa-check"></i><b>6.3</b> From subcellular raw data (transcripts or images) + polygons</a></li>
<li class="chapter" data-level="6.4" data-path="creating-a-giotto-object.html"><a href="creating-a-giotto-object.html#from-piece-wise"><i class="fa fa-check"></i><b>6.4</b> From piece-wise</a></li>
<li class="chapter" data-level="6.5" data-path="creating-a-giotto-object.html"><a href="creating-a-giotto-object.html#using-convenience-functions-for-popular-technologies-vizgen-xenium-cosmx"><i class="fa fa-check"></i><b>6.5</b> Using convenience functions for popular technologies (Vizgen, Xenium, CosMx, …)</a></li>
<li class="chapter" data-level="6.6" data-path="creating-a-giotto-object.html"><a href="creating-a-giotto-object.html#spatial-plots"><i class="fa fa-check"></i><b>6.6</b> Spatial plots</a></li>
<li class="chapter" data-level="6.7" data-path="creating-a-giotto-object.html"><a href="creating-a-giotto-object.html#subsetting"><i class="fa fa-check"></i><b>6.7</b> Subsetting</a></li>
<li class="chapter" data-level="6.8" data-path="creating-a-giotto-object.html"><a href="creating-a-giotto-object.html#mini-objects-giottodata"><i class="fa fa-check"></i><b>6.8</b> Mini objects &amp; GiottoData</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="visium-part-i.html"><a href="visium-part-i.html"><i class="fa fa-check"></i><b>7</b> Visium Part I</a>
<ul>
<li class="chapter" data-level="7.1" data-path="visium-part-i.html"><a href="visium-part-i.html#the-visium-technology"><i class="fa fa-check"></i><b>7.1</b> The Visium technology</a></li>
<li class="chapter" data-level="7.2" data-path="visium-part-i.html"><a href="visium-part-i.html#introduction-to-the-spatial-dataset"><i class="fa fa-check"></i><b>7.2</b> Introduction to the spatial dataset</a></li>
<li class="chapter" data-level="7.3" data-path="visium-part-i.html"><a href="visium-part-i.html#download-dataset"><i class="fa fa-check"></i><b>7.3</b> Download dataset</a></li>
<li class="chapter" data-level="7.4" data-path="visium-part-i.html"><a href="visium-part-i.html#create-the-giotto-object"><i class="fa fa-check"></i><b>7.4</b> Create the Giotto object</a></li>
<li class="chapter" data-level="7.5" data-path="visium-part-i.html"><a href="visium-part-i.html#subset-on-spots-that-were-covered-by-tissue"><i class="fa fa-check"></i><b>7.5</b> Subset on spots that were covered by tissue</a></li>
<li class="chapter" data-level="7.6" data-path="visium-part-i.html"><a href="visium-part-i.html#quality-control"><i class="fa fa-check"></i><b>7.6</b> Quality control</a></li>
<li class="chapter" data-level="7.7" data-path="visium-part-i.html"><a href="visium-part-i.html#filtering"><i class="fa fa-check"></i><b>7.7</b> Filtering</a></li>
<li class="chapter" data-level="7.8" data-path="visium-part-i.html"><a href="visium-part-i.html#normalization"><i class="fa fa-check"></i><b>7.8</b> Normalization</a></li>
<li class="chapter" data-level="7.9" data-path="visium-part-i.html"><a href="visium-part-i.html#feature-selection"><i class="fa fa-check"></i><b>7.9</b> Feature selection</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="visium-part-i.html"><a href="visium-part-i.html#highly-variable-features"><i class="fa fa-check"></i><b>7.9.1</b> Highly Variable Features:</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="visium-part-i.html"><a href="visium-part-i.html#dimension-reduction"><i class="fa fa-check"></i><b>7.10</b> Dimension Reduction</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="visium-part-i.html"><a href="visium-part-i.html#pca"><i class="fa fa-check"></i><b>7.10.1</b> PCA</a></li>
<li class="chapter" data-level="7.10.2" data-path="visium-part-i.html"><a href="visium-part-i.html#umap"><i class="fa fa-check"></i><b>7.10.2</b> UMAP</a></li>
<li class="chapter" data-level="7.10.3" data-path="visium-part-i.html"><a href="visium-part-i.html#t-sne"><i class="fa fa-check"></i><b>7.10.3</b> t-SNE</a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="visium-part-i.html"><a href="visium-part-i.html#clustering"><i class="fa fa-check"></i><b>7.11</b> Clustering</a>
<ul>
<li class="chapter" data-level="7.11.1" data-path="visium-part-i.html"><a href="visium-part-i.html#calculate-leiden-clustering"><i class="fa fa-check"></i><b>7.11.1</b> Calculate Leiden clustering</a></li>
<li class="chapter" data-level="7.11.2" data-path="visium-part-i.html"><a href="visium-part-i.html#calculate-louvain-clustering"><i class="fa fa-check"></i><b>7.11.2</b> Calculate Louvain clustering</a></li>
</ul></li>
<li class="chapter" data-level="7.12" data-path="visium-part-i.html"><a href="visium-part-i.html#save-the-object"><i class="fa fa-check"></i><b>7.12</b> Save the object</a></li>
<li class="chapter" data-level="7.13" data-path="visium-part-i.html"><a href="visium-part-i.html#session-info"><i class="fa fa-check"></i><b>7.13</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="visium-part-ii.html"><a href="visium-part-ii.html"><i class="fa fa-check"></i><b>8</b> Visium Part II</a>
<ul>
<li class="chapter" data-level="8.1" data-path="visium-part-ii.html"><a href="visium-part-ii.html#load-the-object"><i class="fa fa-check"></i><b>8.1</b> Load the object</a></li>
<li class="chapter" data-level="8.2" data-path="visium-part-ii.html"><a href="visium-part-ii.html#differential-expression"><i class="fa fa-check"></i><b>8.2</b> Differential expression</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="visium-part-ii.html"><a href="visium-part-ii.html#gini-markers"><i class="fa fa-check"></i><b>8.2.1</b> Gini markers</a></li>
<li class="chapter" data-level="8.2.2" data-path="visium-part-ii.html"><a href="visium-part-ii.html#scran-markers"><i class="fa fa-check"></i><b>8.2.2</b> Scran markers</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="visium-part-ii.html"><a href="visium-part-ii.html#enrichment-deconvolution"><i class="fa fa-check"></i><b>8.3</b> Enrichment &amp; Deconvolution</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="visium-part-ii.html"><a href="visium-part-ii.html#pagerank"><i class="fa fa-check"></i><b>8.3.1</b> PAGE/Rank</a></li>
<li class="chapter" data-level="8.3.2" data-path="visium-part-ii.html"><a href="visium-part-ii.html#spatialdwls"><i class="fa fa-check"></i><b>8.3.2</b> SpatialDWLS</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="visium-part-ii.html"><a href="visium-part-ii.html#spatial-expression-patterns"><i class="fa fa-check"></i><b>8.4</b> Spatial expression patterns</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="visium-part-ii.html"><a href="visium-part-ii.html#spatial-variable-genes"><i class="fa fa-check"></i><b>8.4.1</b> Spatial variable genes</a></li>
<li class="chapter" data-level="8.4.2" data-path="visium-part-ii.html"><a href="visium-part-ii.html#spatial-co-expression-modules"><i class="fa fa-check"></i><b>8.4.2</b> Spatial co-expression modules</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="visium-part-ii.html"><a href="visium-part-ii.html#spatially-informed-clusters"><i class="fa fa-check"></i><b>8.5</b> Spatially informed clusters</a></li>
<li class="chapter" data-level="8.6" data-path="visium-part-ii.html"><a href="visium-part-ii.html#spatial-domains-hmrf"><i class="fa fa-check"></i><b>8.6</b> Spatial domains HMRF</a></li>
<li class="chapter" data-level="8.7" data-path="visium-part-ii.html"><a href="visium-part-ii.html#interactive-tools"><i class="fa fa-check"></i><b>8.7</b> Interactive tools</a></li>
<li class="chapter" data-level="8.8" data-path="visium-part-ii.html"><a href="visium-part-ii.html#session-info-1"><i class="fa fa-check"></i><b>8.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="visium-hd.html"><a href="visium-hd.html"><i class="fa fa-check"></i><b>9</b> Visium HD</a>
<ul>
<li class="chapter" data-level="9.1" data-path="visium-hd.html"><a href="visium-hd.html#objective"><i class="fa fa-check"></i><b>9.1</b> Objective</a></li>
<li class="chapter" data-level="9.2" data-path="visium-hd.html"><a href="visium-hd.html#background"><i class="fa fa-check"></i><b>9.2</b> Background</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="visium-hd.html"><a href="visium-hd.html#visium-hd-technology"><i class="fa fa-check"></i><b>9.2.1</b> Visium HD Technology</a></li>
<li class="chapter" data-level="9.2.2" data-path="visium-hd.html"><a href="visium-hd.html#colorectal-cancer-sample"><i class="fa fa-check"></i><b>9.2.2</b> Colorectal Cancer Sample</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="visium-hd.html"><a href="visium-hd.html#data-ingestion"><i class="fa fa-check"></i><b>9.3</b> Data Ingestion</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="visium-hd.html"><a href="visium-hd.html#visium-hd-output-data-format"><i class="fa fa-check"></i><b>9.3.1</b> Visium HD output data format</a></li>
<li class="chapter" data-level="9.3.2" data-path="visium-hd.html"><a href="visium-hd.html#mini-visium-hd-dataset"><i class="fa fa-check"></i><b>9.3.2</b> Mini Visium HD dataset</a></li>
<li class="chapter" data-level="9.3.3" data-path="visium-hd.html"><a href="visium-hd.html#giotto-visium-hd-convenience-function"><i class="fa fa-check"></i><b>9.3.3</b> Giotto Visium HD convenience function</a></li>
<li class="chapter" data-level="9.3.4" data-path="visium-hd.html"><a href="visium-hd.html#read-in-data-manually"><i class="fa fa-check"></i><b>9.3.4</b> Read in data manually</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="visium-hd.html"><a href="visium-hd.html#create-giotto-object"><i class="fa fa-check"></i><b>9.4</b> Create Giotto object</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="visium-hd.html"><a href="visium-hd.html#create-giotto-points"><i class="fa fa-check"></i><b>9.4.1</b> create giotto points</a></li>
<li class="chapter" data-level="9.4.2" data-path="visium-hd.html"><a href="visium-hd.html#create-giotto-polygons"><i class="fa fa-check"></i><b>9.4.2</b> create giotto polygons</a></li>
<li class="chapter" data-level="9.4.3" data-path="visium-hd.html"><a href="visium-hd.html#combine-giotto-points-and-polygons-to-create-giotto-object"><i class="fa fa-check"></i><b>9.4.3</b> combine Giotto points and polygons to create Giotto object</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="visium-hd.html"><a href="visium-hd.html#process-giotto-object"><i class="fa fa-check"></i><b>9.5</b> Process Giotto object</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="visium-hd.html"><a href="visium-hd.html#calculate-overlap-between-points-and-polygons"><i class="fa fa-check"></i><b>9.5.1</b> calculate overlap between points and polygons</a></li>
<li class="chapter" data-level="9.5.2" data-path="visium-hd.html"><a href="visium-hd.html#convert-overlap-results-to-a-bin-by-gene-matrix"><i class="fa fa-check"></i><b>9.5.2</b> convert overlap results to a bin-by-gene matrix</a></li>
<li class="chapter" data-level="9.5.3" data-path="visium-hd.html"><a href="visium-hd.html#default-processing-steps"><i class="fa fa-check"></i><b>9.5.3</b> default processing steps</a></li>
<li class="chapter" data-level="9.5.4" data-path="visium-hd.html"><a href="visium-hd.html#visualize-number-of-features"><i class="fa fa-check"></i><b>9.5.4</b> visualize number of features</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="visium-hd.html"><a href="visium-hd.html#dimension-reduction-clustering"><i class="fa fa-check"></i><b>9.6</b> Dimension reduction + clustering</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="visium-hd.html"><a href="visium-hd.html#highly-variable-features-pca"><i class="fa fa-check"></i><b>9.6.1</b> Highly variable features + PCA</a></li>
<li class="chapter" data-level="9.6.2" data-path="visium-hd.html"><a href="visium-hd.html#umap-reduction-for-visualization"><i class="fa fa-check"></i><b>9.6.2</b> UMAP reduction for visualization</a></li>
<li class="chapter" data-level="9.6.3" data-path="visium-hd.html"><a href="visium-hd.html#create-network-based-on-expression-similarity-graph-partition-cluster"><i class="fa fa-check"></i><b>9.6.3</b> Create network based on expression similarity + graph partition cluster</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="visium-hd.html"><a href="visium-hd.html#hexbin-100"><i class="fa fa-check"></i><b>9.7</b> Hexbin 100</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="visium-hd.html"><a href="visium-hd.html#standard-subcellular-pipeline"><i class="fa fa-check"></i><b>9.7.1</b> Standard subcellular pipeline</a></li>
<li class="chapter" data-level="9.7.2" data-path="visium-hd.html"><a href="visium-hd.html#spatial-expression-patterns-1"><i class="fa fa-check"></i><b>9.7.2</b> Spatial expression patterns</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="visium-hd.html"><a href="visium-hd.html#hexbin-25"><i class="fa fa-check"></i><b>9.8</b> Hexbin 25</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="visium-hd.html"><a href="visium-hd.html#subcellular-workflow-and-projection-functions"><i class="fa fa-check"></i><b>9.8.1</b> Subcellular workflow and projection functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="xenium-1.html"><a href="xenium-1.html"><i class="fa fa-check"></i><b>10</b> Xenium</a>
<ul>
<li class="chapter" data-level="10.1" data-path="xenium-1.html"><a href="xenium-1.html#introduction-to-spatial-dataset"><i class="fa fa-check"></i><b>10.1</b> Introduction to spatial dataset</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="xenium-1.html"><a href="xenium-1.html#output-directory-structure"><i class="fa fa-check"></i><b>10.1.1</b> Output directory structure</a></li>
<li class="chapter" data-level="10.1.2" data-path="xenium-1.html"><a href="xenium-1.html#mini-xenium-dataset"><i class="fa fa-check"></i><b>10.1.2</b> Mini Xenium Dataset</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="xenium-1.html"><a href="xenium-1.html#data-prep"><i class="fa fa-check"></i><b>10.2</b> Data prep</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="xenium-1.html"><a href="xenium-1.html#image-conversion-may-change"><i class="fa fa-check"></i><b>10.2.1</b> Image conversion (may change)</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="xenium-1.html"><a href="xenium-1.html#convenience-function"><i class="fa fa-check"></i><b>10.3</b> Convenience function</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="xenium-1.html"><a href="xenium-1.html#specific-filepaths"><i class="fa fa-check"></i><b>10.3.1</b> Specific filepaths</a></li>
<li class="chapter" data-level="10.3.2" data-path="xenium-1.html"><a href="xenium-1.html#quality-value"><i class="fa fa-check"></i><b>10.3.2</b> Quality value</a></li>
<li class="chapter" data-level="10.3.3" data-path="xenium-1.html"><a href="xenium-1.html#transcript-type-splitting"><i class="fa fa-check"></i><b>10.3.3</b> Transcript type splitting</a></li>
<li class="chapter" data-level="10.3.4" data-path="xenium-1.html"><a href="xenium-1.html#centroids-calculation"><i class="fa fa-check"></i><b>10.3.4</b> Centroids calculation</a></li>
<li class="chapter" data-level="10.3.5" data-path="xenium-1.html"><a href="xenium-1.html#simple-visualization"><i class="fa fa-check"></i><b>10.3.5</b> Simple visualization</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="xenium-1.html"><a href="xenium-1.html#piecewise-loading"><i class="fa fa-check"></i><b>10.4</b> Piecewise loading</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="xenium-1.html"><a href="xenium-1.html#load-giottopoints-transcripts"><i class="fa fa-check"></i><b>10.4.1</b> load giottoPoints transcripts</a></li>
<li class="chapter" data-level="10.4.2" data-path="xenium-1.html"><a href="xenium-1.html#optional-loading-pre-aggregated-data"><i class="fa fa-check"></i><b>10.4.2</b> (optional) Loading pre-aggregated data</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="xenium-1.html"><a href="xenium-1.html#xenium-images"><i class="fa fa-check"></i><b>10.5</b> Xenium Images</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="xenium-1.html"><a href="xenium-1.html#image-metadata"><i class="fa fa-check"></i><b>10.5.1</b> Image metadata</a></li>
<li class="chapter" data-level="10.5.2" data-path="xenium-1.html"><a href="xenium-1.html#image-loading"><i class="fa fa-check"></i><b>10.5.2</b> Image loading</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="xenium-1.html"><a href="xenium-1.html#spatial-aggregation"><i class="fa fa-check"></i><b>10.6</b> Spatial aggregation</a></li>
<li class="chapter" data-level="10.7" data-path="xenium-1.html"><a href="xenium-1.html#aggregate-analyses-workflow"><i class="fa fa-check"></i><b>10.7</b> Aggregate analyses workflow</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="xenium-1.html"><a href="xenium-1.html#filtering-1"><i class="fa fa-check"></i><b>10.7.1</b> Filtering</a></li>
<li class="chapter" data-level="10.7.2" data-path="xenium-1.html"><a href="xenium-1.html#normalization-1"><i class="fa fa-check"></i><b>10.7.2</b> Normalization</a></li>
<li class="chapter" data-level="10.7.3" data-path="xenium-1.html"><a href="xenium-1.html#dimension-reduction-1"><i class="fa fa-check"></i><b>10.7.3</b> Dimension Reduction</a></li>
<li class="chapter" data-level="10.7.4" data-path="xenium-1.html"><a href="xenium-1.html#clustering-1"><i class="fa fa-check"></i><b>10.7.4</b> Clustering</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="xenium-1.html"><a href="xenium-1.html#niche-clustering"><i class="fa fa-check"></i><b>10.8</b> Niche clustering</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="xenium-1.html"><a href="xenium-1.html#spatial-network"><i class="fa fa-check"></i><b>10.8.1</b> Spatial network</a></li>
<li class="chapter" data-level="10.8.2" data-path="xenium-1.html"><a href="xenium-1.html#niche-calculation"><i class="fa fa-check"></i><b>10.8.2</b> Niche calculation</a></li>
<li class="chapter" data-level="10.8.3" data-path="xenium-1.html"><a href="xenium-1.html#kmeans-clustering-based-on-niche-signature"><i class="fa fa-check"></i><b>10.8.3</b> kmeans clustering based on niche signature</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="xenium-1.html"><a href="xenium-1.html#cell-proximity-enrichment"><i class="fa fa-check"></i><b>10.9</b> Cell proximity enrichment</a></li>
<li class="chapter" data-level="10.10" data-path="xenium-1.html"><a href="xenium-1.html#pseudovisium"><i class="fa fa-check"></i><b>10.10</b> Pseudovisium</a>
<ul>
<li class="chapter" data-level="10.10.1" data-path="xenium-1.html"><a href="xenium-1.html#pseudovisium-aggregation-and-workflow"><i class="fa fa-check"></i><b>10.10.1</b> Pseudovisium aggregation and workflow</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="spatial-proteomics-multiplexed-immunofluorescence.html"><a href="spatial-proteomics-multiplexed-immunofluorescence.html"><i class="fa fa-check"></i><b>11</b> Spatial proteomics: Multiplexed Immunofluorescence</a>
<ul>
<li class="chapter" data-level="11.1" data-path="spatial-proteomics-multiplexed-immunofluorescence.html"><a href="spatial-proteomics-multiplexed-immunofluorescence.html#spatial-proteomics-technologies"><i class="fa fa-check"></i><b>11.1</b> Spatial Proteomics Technologies</a></li>
<li class="chapter" data-level="11.2" data-path="spatial-proteomics-multiplexed-immunofluorescence.html"><a href="spatial-proteomics-multiplexed-immunofluorescence.html#raw-data-type-coming-out-of-different-technologies"><i class="fa fa-check"></i><b>11.2</b> Raw data type coming out of different technologies</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="spatial-proteomics-multiplexed-immunofluorescence.html"><a href="spatial-proteomics-multiplexed-immunofluorescence.html#use-ome.tiff-as-an-example-output-data-to-begin-with"><i class="fa fa-check"></i><b>11.2.1</b> Use ome.tiff as an example output data to begin with</a></li>
<li class="chapter" data-level="11.2.2" data-path="spatial-proteomics-multiplexed-immunofluorescence.html"><a href="spatial-proteomics-multiplexed-immunofluorescence.html#use-single-channel-images-as-an-example-output-data-to-begin-with"><i class="fa fa-check"></i><b>11.2.2</b> Use single channel images as an example output data to begin with</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="spatial-proteomics-multiplexed-immunofluorescence.html"><a href="spatial-proteomics-multiplexed-immunofluorescence.html#cell-segmentation-file-to-get-single-cell-level-protein-expression"><i class="fa fa-check"></i><b>11.3</b> Cell Segmentation file to get single cell level protein expression</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="spatial-proteomics-multiplexed-immunofluorescence.html"><a href="spatial-proteomics-multiplexed-immunofluorescence.html#using-segmentation-output-file-from-deepcellmesmer-as-an-example."><i class="fa fa-check"></i><b>11.3.1</b> Using segmentation output file from DeepCell(mesmer) as an example.</a></li>
<li class="chapter" data-level="11.3.2" data-path="spatial-proteomics-multiplexed-immunofluorescence.html"><a href="spatial-proteomics-multiplexed-immunofluorescence.html#using-giotto-wrapper-of-cellpose-to-perform-segmentation"><i class="fa fa-check"></i><b>11.3.2</b> Using Giotto wrapper of Cellpose to perform segmentation</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="spatial-proteomics-multiplexed-immunofluorescence.html"><a href="spatial-proteomics-multiplexed-immunofluorescence.html#create-a-giotto-object-using-list-of-gitto-large-images-and-polygons"><i class="fa fa-check"></i><b>11.4</b> Create a Giotto Object using list of gitto large images and polygons</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="spatial-proteomics-multiplexed-immunofluorescence.html"><a href="spatial-proteomics-multiplexed-immunofluorescence.html#overlap-to-matrix"><i class="fa fa-check"></i><b>11.4.1</b> Overlap to matrix</a></li>
<li class="chapter" data-level="11.4.2" data-path="spatial-proteomics-multiplexed-immunofluorescence.html"><a href="spatial-proteomics-multiplexed-immunofluorescence.html#manipulate-expression-information"><i class="fa fa-check"></i><b>11.4.2</b> Manipulate Expression information</a></li>
<li class="chapter" data-level="11.4.3" data-path="spatial-proteomics-multiplexed-immunofluorescence.html"><a href="spatial-proteomics-multiplexed-immunofluorescence.html#rescale-polygons"><i class="fa fa-check"></i><b>11.4.3</b> Rescale polygons</a></li>
<li class="chapter" data-level="11.4.4" data-path="spatial-proteomics-multiplexed-immunofluorescence.html"><a href="spatial-proteomics-multiplexed-immunofluorescence.html#perform-clustering-and-differential-expression"><i class="fa fa-check"></i><b>11.4.4</b> Perform clustering and differential expression</a></li>
<li class="chapter" data-level="11.4.5" data-path="spatial-proteomics-multiplexed-immunofluorescence.html"><a href="spatial-proteomics-multiplexed-immunofluorescence.html#give-the-cluster-an-annotation-based-on-expression-values"><i class="fa fa-check"></i><b>11.4.5</b> Give the cluster an annotation based on expression values</a></li>
<li class="chapter" data-level="11.4.6" data-path="spatial-proteomics-multiplexed-immunofluorescence.html"><a href="spatial-proteomics-multiplexed-immunofluorescence.html#spatial-network-1"><i class="fa fa-check"></i><b>11.4.6</b> spatial network</a></li>
<li class="chapter" data-level="11.4.7" data-path="spatial-proteomics-multiplexed-immunofluorescence.html"><a href="spatial-proteomics-multiplexed-immunofluorescence.html#cell-neighborhood-cell-typecell-type-interactions"><i class="fa fa-check"></i><b>11.4.7</b> Cell Neighborhood: Cell-Type/Cell-Type Interactions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html"><i class="fa fa-check"></i><b>12</b> Working with multiple samples</a>
<ul>
<li class="chapter" data-level="12.1" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#objective-1"><i class="fa fa-check"></i><b>12.1</b> Objective</a></li>
<li class="chapter" data-level="12.2" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#background-1"><i class="fa fa-check"></i><b>12.2</b> Background</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#dataset"><i class="fa fa-check"></i><b>12.2.1</b> Dataset</a></li>
<li class="chapter" data-level="12.2.2" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#visium-technology"><i class="fa fa-check"></i><b>12.2.2</b> Visium technology</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#create-individual-giotto-objects"><i class="fa fa-check"></i><b>12.3</b> Create individual giotto objects</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#download-the-data"><i class="fa fa-check"></i><b>12.3.1</b> Download the data</a></li>
<li class="chapter" data-level="12.3.2" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#create-giotto-instructions"><i class="fa fa-check"></i><b>12.3.2</b> Create giotto instructions</a></li>
<li class="chapter" data-level="12.3.3" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#load-visium-data-into-giotto"><i class="fa fa-check"></i><b>12.3.3</b> Load visium data into Giotto</a></li>
<li class="chapter" data-level="12.3.4" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#healthy-prostate-tissue-coverage"><i class="fa fa-check"></i><b>12.3.4</b> Healthy prostate tissue coverage</a></li>
<li class="chapter" data-level="12.3.5" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#adenocarcinoma-prostate-tissue-coverage"><i class="fa fa-check"></i><b>12.3.5</b> Adenocarcinoma prostate tissue coverage</a></li>
<li class="chapter" data-level="12.3.6" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#showing-the-data-strucutre-for-the-inidividual-objects"><i class="fa fa-check"></i><b>12.3.6</b> Showing the data strucutre for the inidividual objects</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#join-giotto-objects"><i class="fa fa-check"></i><b>12.4</b> Join Giotto Objects</a></li>
<li class="chapter" data-level="12.5" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#visualizing-combined-datasets"><i class="fa fa-check"></i><b>12.5</b> Visualizing combined datasets</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#vizualizing-in-the-same-plot"><i class="fa fa-check"></i><b>12.5.1</b> Vizualizing in the same plot</a></li>
<li class="chapter" data-level="12.5.2" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#vizualizing-on-separate-plots"><i class="fa fa-check"></i><b>12.5.2</b> Vizualizing on separate plots</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#splitting-combined-dataset"><i class="fa fa-check"></i><b>12.6</b> Splitting combined dataset</a></li>
<li class="chapter" data-level="12.7" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#analyzing-joined-objects"><i class="fa fa-check"></i><b>12.7</b> Analyzing joined objects</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#normalization-and-adding-statistics"><i class="fa fa-check"></i><b>12.7.1</b> Normalization and adding statistics</a></li>
<li class="chapter" data-level="12.7.2" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#clustering-the-datasets"><i class="fa fa-check"></i><b>12.7.2</b> Clustering the datasets</a></li>
<li class="chapter" data-level="12.7.3" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#vizualizing-spatial-location-of-clusters"><i class="fa fa-check"></i><b>12.7.3</b> Vizualizing spatial location of clusters</a></li>
<li class="chapter" data-level="12.7.4" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#vizualizing-tissue-contribution-to-clusters"><i class="fa fa-check"></i><b>12.7.4</b> Vizualizing tissue contribution to clusters</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#perform-harmony-and-default-workflows"><i class="fa fa-check"></i><b>12.8</b> Perform Harmony and default workflows</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#clustering-harmonized-object"><i class="fa fa-check"></i><b>12.8.1</b> Clustering harmonized object</a></li>
<li class="chapter" data-level="12.8.2" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#vizualizing-the-tissue-contribution"><i class="fa fa-check"></i><b>12.8.2</b> Vizualizing the tissue contribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="spatial-multi-modal-analysis.html"><a href="spatial-multi-modal-analysis.html"><i class="fa fa-check"></i><b>13</b> Spatial multi-modal analysis</a>
<ul>
<li class="chapter" data-level="13.1" data-path="spatial-multi-modal-analysis.html"><a href="spatial-multi-modal-analysis.html#overview-1"><i class="fa fa-check"></i><b>13.1</b> Overview</a></li>
<li class="chapter" data-level="13.2" data-path="spatial-multi-modal-analysis.html"><a href="spatial-multi-modal-analysis.html#spatial-manipulation"><i class="fa fa-check"></i><b>13.2</b> Spatial manipulation</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="spatial-multi-modal-analysis.html"><a href="spatial-multi-modal-analysis.html#spatial-transforms"><i class="fa fa-check"></i><b>13.2.1</b> Spatial transforms:</a></li>
<li class="chapter" data-level="13.2.2" data-path="spatial-multi-modal-analysis.html"><a href="spatial-multi-modal-analysis.html#spatial-utilities"><i class="fa fa-check"></i><b>13.2.2</b> Spatial utilities:</a></li>
<li class="chapter" data-level="13.2.3" data-path="spatial-multi-modal-analysis.html"><a href="spatial-multi-modal-analysis.html#spatial-classes"><i class="fa fa-check"></i><b>13.2.3</b> Spatial classes:</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="spatial-multi-modal-analysis.html"><a href="spatial-multi-modal-analysis.html#examples-of-the-simple-transforms-with-a-giottopolygon"><i class="fa fa-check"></i><b>13.3</b> Examples of the simple transforms with a giottoPolygon</a></li>
<li class="chapter" data-level="13.4" data-path="spatial-multi-modal-analysis.html"><a href="spatial-multi-modal-analysis.html#affine-transforms"><i class="fa fa-check"></i><b>13.4</b> Affine transforms</a></li>
<li class="chapter" data-level="13.5" data-path="spatial-multi-modal-analysis.html"><a href="spatial-multi-modal-analysis.html#image-transforms"><i class="fa fa-check"></i><b>13.5</b> Image transforms</a></li>
<li class="chapter" data-level="13.6" data-path="spatial-multi-modal-analysis.html"><a href="spatial-multi-modal-analysis.html#the-practical-usage-of-multi-modality-co-registration"><i class="fa fa-check"></i><b>13.6</b> The practical usage of multi-modality co-registration</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="spatial-multi-modal-analysis.html"><a href="spatial-multi-modal-analysis.html#example-dataset-xenium-breast-cancer-pre-release-pack"><i class="fa fa-check"></i><b>13.6.1</b> Example dataset: Xenium Breast Cancer pre-release pack</a></li>
<li class="chapter" data-level="13.6.2" data-path="spatial-multi-modal-analysis.html"><a href="spatial-multi-modal-analysis.html#target-coordinate-system"><i class="fa fa-check"></i><b>13.6.2</b> Target Coordinate system</a></li>
<li class="chapter" data-level="13.6.3" data-path="spatial-multi-modal-analysis.html"><a href="spatial-multi-modal-analysis.html#visium-to-register"><i class="fa fa-check"></i><b>13.6.3</b> Visium to register</a></li>
<li class="chapter" data-level="13.6.4" data-path="spatial-multi-modal-analysis.html"><a href="spatial-multi-modal-analysis.html#register-post-xenium-he-and-if-image"><i class="fa fa-check"></i><b>13.6.4</b> Register post-Xenium H&amp;E and IF image</a></li>
<li class="chapter" data-level="13.6.5" data-path="spatial-multi-modal-analysis.html"><a href="spatial-multi-modal-analysis.html#automatic-alignment-via-sift-feature-descriptor-matching-and-affine-transformation"><i class="fa fa-check"></i><b>13.6.5</b> Automatic alignment via SIFT feature descriptor matching and affine transformation</a></li>
<li class="chapter" data-level="13.6.6" data-path="spatial-multi-modal-analysis.html"><a href="spatial-multi-modal-analysis.html#final-notes"><i class="fa fa-check"></i><b>13.6.6</b> Final Notes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="multi-omics-integration.html"><a href="multi-omics-integration.html"><i class="fa fa-check"></i><b>14</b> Multi-omics integration</a>
<ul>
<li class="chapter" data-level="14.1" data-path="multi-omics-integration.html"><a href="multi-omics-integration.html#the-cytassist-technology"><i class="fa fa-check"></i><b>14.1</b> The CytAssist technology</a></li>
<li class="chapter" data-level="14.2" data-path="multi-omics-integration.html"><a href="multi-omics-integration.html#introduction-to-the-spatial-dataset-1"><i class="fa fa-check"></i><b>14.2</b> Introduction to the spatial dataset</a></li>
<li class="chapter" data-level="14.3" data-path="multi-omics-integration.html"><a href="multi-omics-integration.html#download-dataset-1"><i class="fa fa-check"></i><b>14.3</b> Download dataset</a></li>
<li class="chapter" data-level="14.4" data-path="multi-omics-integration.html"><a href="multi-omics-integration.html#create-the-giotto-object-1"><i class="fa fa-check"></i><b>14.4</b> Create the Giotto object</a></li>
<li class="chapter" data-level="14.5" data-path="multi-omics-integration.html"><a href="multi-omics-integration.html#subset-on-spots-that-were-covered-by-tissue-1"><i class="fa fa-check"></i><b>14.5</b> Subset on spots that were covered by tissue</a></li>
<li class="chapter" data-level="14.6" data-path="multi-omics-integration.html"><a href="multi-omics-integration.html#rna-processing"><i class="fa fa-check"></i><b>14.6</b> RNA processing</a></li>
<li class="chapter" data-level="14.7" data-path="multi-omics-integration.html"><a href="multi-omics-integration.html#protein-processing"><i class="fa fa-check"></i><b>14.7</b> Protein processing</a></li>
<li class="chapter" data-level="14.8" data-path="multi-omics-integration.html"><a href="multi-omics-integration.html#multi-omics-integration-1"><i class="fa fa-check"></i><b>14.8</b> Multi-omics integration</a></li>
<li class="chapter" data-level="14.9" data-path="multi-omics-integration.html"><a href="multi-omics-integration.html#session-info-2"><i class="fa fa-check"></i><b>14.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="interoperability-with-other-frameworks.html"><a href="interoperability-with-other-frameworks.html"><i class="fa fa-check"></i><b>15</b> Interoperability with other frameworks</a>
<ul>
<li class="chapter" data-level="15.1" data-path="interoperability-with-other-frameworks.html"><a href="interoperability-with-other-frameworks.html#load-giotto-object"><i class="fa fa-check"></i><b>15.1</b> Load Giotto object</a></li>
<li class="chapter" data-level="15.2" data-path="interoperability-with-other-frameworks.html"><a href="interoperability-with-other-frameworks.html#seurat"><i class="fa fa-check"></i><b>15.2</b> Seurat</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="interoperability-with-other-frameworks.html"><a href="interoperability-with-other-frameworks.html#conversion-of-giotto-object-to-seurat-object"><i class="fa fa-check"></i><b>15.2.1</b> Conversion of Giotto Object to Seurat Object</a></li>
<li class="chapter" data-level="15.2.2" data-path="interoperability-with-other-frameworks.html"><a href="interoperability-with-other-frameworks.html#conversion-of-seurat-object-back-to-giotto-object"><i class="fa fa-check"></i><b>15.2.2</b> Conversion of Seurat object Back to Giotto Object</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="interoperability-with-other-frameworks.html"><a href="interoperability-with-other-frameworks.html#spatialexperiment"><i class="fa fa-check"></i><b>15.3</b> SpatialExperiment</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="interoperability-with-other-frameworks.html"><a href="interoperability-with-other-frameworks.html#convert-giotto-object-to-spatialexperiment-object"><i class="fa fa-check"></i><b>15.3.1</b> Convert Giotto Object to SpatialExperiment Object</a></li>
<li class="chapter" data-level="15.3.2" data-path="interoperability-with-other-frameworks.html"><a href="interoperability-with-other-frameworks.html#conversion-of-spatialexperiment-object-back-to-giotto"><i class="fa fa-check"></i><b>15.3.2</b> Conversion of SpatialExperiment object back to Giotto</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="interoperability-with-other-frameworks.html"><a href="interoperability-with-other-frameworks.html#anndata"><i class="fa fa-check"></i><b>15.4</b> AnnData</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="interoperability-with-other-frameworks.html"><a href="interoperability-with-other-frameworks.html#load-required-libraries"><i class="fa fa-check"></i><b>15.4.1</b> Load Required Libraries</a></li>
<li class="chapter" data-level="15.4.2" data-path="interoperability-with-other-frameworks.html"><a href="interoperability-with-other-frameworks.html#specify-path-for-results"><i class="fa fa-check"></i><b>15.4.2</b> Specify Path for Results</a></li>
<li class="chapter" data-level="15.4.3" data-path="interoperability-with-other-frameworks.html"><a href="interoperability-with-other-frameworks.html#giotto-to-anndata"><i class="fa fa-check"></i><b>15.4.3</b> Giotto To AnnData</a></li>
<li class="chapter" data-level="15.4.4" data-path="interoperability-with-other-frameworks.html"><a href="interoperability-with-other-frameworks.html#convert-anndata-to-giotto"><i class="fa fa-check"></i><b>15.4.4</b> Convert AnnData to Giotto</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="interoperability-with-other-frameworks.html"><a href="interoperability-with-other-frameworks.html#create-mini-vizgen-object"><i class="fa fa-check"></i><b>15.5</b> Create mini Vizgen object</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="interoperability-with-isolated-tools.html"><a href="interoperability-with-isolated-tools.html"><i class="fa fa-check"></i><b>16</b> Interoperability with isolated tools</a>
<ul>
<li class="chapter" data-level="16.1" data-path="interoperability-with-isolated-tools.html"><a href="interoperability-with-isolated-tools.html#spatial-niche-trajectory-analysis-ontrac"><i class="fa fa-check"></i><b>16.1</b> Spatial niche trajectory analysis (ONTraC)</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="interoperability-with-isolated-tools.html"><a href="interoperability-with-isolated-tools.html#introduction-to-ontrac"><i class="fa fa-check"></i><b>16.1.1</b> Introduction to ONTraC</a></li>
<li class="chapter" data-level="16.1.2" data-path="interoperability-with-isolated-tools.html"><a href="interoperability-with-isolated-tools.html#introduction-to-merfish"><i class="fa fa-check"></i><b>16.1.2</b> Introduction to MERFISH</a></li>
<li class="chapter" data-level="16.1.3" data-path="interoperability-with-isolated-tools.html"><a href="interoperability-with-isolated-tools.html#settings"><i class="fa fa-check"></i><b>16.1.3</b> settings</a></li>
<li class="chapter" data-level="16.1.4" data-path="interoperability-with-isolated-tools.html"><a href="interoperability-with-isolated-tools.html#dataset-1"><i class="fa fa-check"></i><b>16.1.4</b> Dataset</a></li>
<li class="chapter" data-level="16.1.5" data-path="interoperability-with-isolated-tools.html"><a href="interoperability-with-isolated-tools.html#create-the-giotto-object-2"><i class="fa fa-check"></i><b>16.1.5</b> Create the Giotto object</a></li>
<li class="chapter" data-level="16.1.6" data-path="interoperability-with-isolated-tools.html"><a href="interoperability-with-isolated-tools.html#perform-spatial-niche-trajectory-analysis-using-ontrac"><i class="fa fa-check"></i><b>16.1.6</b> Perform spatial niche trajectory analysis using ONTraC</a></li>
<li class="chapter" data-level="16.1.7" data-path="interoperability-with-isolated-tools.html"><a href="interoperability-with-isolated-tools.html#visualization"><i class="fa fa-check"></i><b>16.1.7</b> visualization</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="interoperability-with-isolated-tools.html"><a href="interoperability-with-isolated-tools.html#session-info-3"><i class="fa fa-check"></i><b>16.2</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html"><i class="fa fa-check"></i><b>17</b> Interactivity with the R/Spatial ecosystem</a>
<ul>
<li class="chapter" data-level="17.1" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#kriging"><i class="fa fa-check"></i><b>17.1</b> Kriging</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#visium-technology-1"><i class="fa fa-check"></i><b>17.1.1</b> Visium technology</a></li>
<li class="chapter" data-level="17.1.2" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#dataset-2"><i class="fa fa-check"></i><b>17.1.2</b> Dataset</a></li>
<li class="chapter" data-level="17.1.3" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#generating-a-geojson-file-of-nuclei-location"><i class="fa fa-check"></i><b>17.1.3</b> Generating a geojson file of nuclei location</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#downloading-the-dataset"><i class="fa fa-check"></i><b>17.2</b> Downloading the dataset</a></li>
<li class="chapter" data-level="17.3" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#importing-visium-data"><i class="fa fa-check"></i><b>17.3</b> Importing visium data</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#identifying-spatially-organized-features"><i class="fa fa-check"></i><b>17.3.1</b> Identifying spatially organized features</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#adding-cell-polygons-to-giotto-object"><i class="fa fa-check"></i><b>17.4</b> Adding cell polygons to Giotto object</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#read-in-the-poly-information"><i class="fa fa-check"></i><b>17.4.1</b> Read in the poly information</a></li>
<li class="chapter" data-level="17.4.2" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#vizualizing-polygons"><i class="fa fa-check"></i><b>17.4.2</b> Vizualizing polygons</a></li>
<li class="chapter" data-level="17.4.3" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#showing-giotto-object-prior-to-polygon-addition"><i class="fa fa-check"></i><b>17.4.3</b> Showing Giotto object prior to polygon addition</a></li>
<li class="chapter" data-level="17.4.4" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#adding-polygons-to-giotto-object"><i class="fa fa-check"></i><b>17.4.4</b> Adding polygons to giotto object</a></li>
<li class="chapter" data-level="17.4.5" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#check-polygon-information"><i class="fa fa-check"></i><b>17.4.5</b> Check polygon information</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#performing-kriging"><i class="fa fa-check"></i><b>17.5</b> Performing kriging</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#interpolating-features"><i class="fa fa-check"></i><b>17.5.1</b> Interpolating features</a></li>
<li class="chapter" data-level="17.5.2" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#expression-overlap"><i class="fa fa-check"></i><b>17.5.2</b> Expression overlap</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#reading-in-larger-dataset"><i class="fa fa-check"></i><b>17.6</b> Reading in larger dataset</a></li>
<li class="chapter" data-level="17.7" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#analyzing-interpolated-features"><i class="fa fa-check"></i><b>17.7</b> Analyzing interpolated features</a>
<ul>
<li class="chapter" data-level="17.7.1" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#filter-and-normalization"><i class="fa fa-check"></i><b>17.7.1</b> Filter and normalization</a></li>
<li class="chapter" data-level="17.7.2" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#visualizing-gene-expression-from-interpolated-expression"><i class="fa fa-check"></i><b>17.7.2</b> Visualizing gene expression from interpolated expression</a></li>
<li class="chapter" data-level="17.7.3" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#run-pca"><i class="fa fa-check"></i><b>17.7.3</b> Run PCA</a></li>
<li class="chapter" data-level="17.7.4" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#clustering-2"><i class="fa fa-check"></i><b>17.7.4</b> Clustering</a></li>
<li class="chapter" data-level="17.7.5" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#visualizing-clustering"><i class="fa fa-check"></i><b>17.7.5</b> Visualizing clustering</a></li>
<li class="chapter" data-level="17.7.6" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#cropping-objects"><i class="fa fa-check"></i><b>17.7.6</b> Cropping objects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="contributing-to-giotto.html"><a href="contributing-to-giotto.html"><i class="fa fa-check"></i><b>18</b> Contributing to Giotto</a>
<ul>
<li class="chapter" data-level="18.1" data-path="contributing-to-giotto.html"><a href="contributing-to-giotto.html#contribution-guideline"><i class="fa fa-check"></i><b>18.1</b> Contribution guideline</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Workshop: Spatial multi-omics data analysis with Giotto Suite</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="visium-hd" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">9</span> Visium HD<a href="visium-hd.html#visium-hd" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Ruben Dries &amp; Edward C. Ruiz</p>
<p>August 6th 2024</p>
<div id="objective" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Objective<a href="visium-hd.html#objective" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This tutorial demonstrates how to process Visium HD data at the highest 2 micron bin resolution using <a href="https://drieslab.github.io/Giotto_website/">Giotto Suite</a>. Notably, a similar strategy can be used for other spatial sequencing methods that operate at the subcellular level, including:<br />
- Stereo-seq<br />
- <a href="https://drieslab.github.io/Giotto_website/articles/seqscope_mouse_liver.html">Seq-Scope</a><br />
- Open-ST</p>
<p>The resulting datasets from all these technologies can be very large since they provide both a high spatial resolution and genome-wide capture of <em>all</em> transcripts.</p>
</div>
<div id="background" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Background<a href="visium-hd.html#background" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="visium-hd-technology" class="section level3 hasAnchor" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Visium HD Technology<a href="visium-hd.html#visium-hd-technology" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-1"></span>
<img src="img/02_session2/1.png" alt="Overview of Visium HD. Source: *10X Genomics*" width="80%" />
<p class="caption">
Figure 9.1: Overview of Visium HD. Source: <em>10X Genomics</em>
</p>
</div>
<p>Visium HD is a spatial transcriptomics technology recently developed by 10X Genomics. Details about this platform are discussed on the official <a href="https://www.10xgenomics.com/products/visium-hd-spatial-gene-expression">10X Genomics Visium HD website</a> and the preprint by <a href="https://doi.org/10.1101/2024.06.04.597233">Oliveira <em>et al.</em> 2024</a> on <em>bioRxiv</em>.</p>
<p>Visium HD has a 2 micron bin size resolution. The default SpaceRanger pipeline from 10X Genomics also returns aggregated data at the 8 and 16 micron bin size.</p>
</div>
<div id="colorectal-cancer-sample" class="section level3 hasAnchor" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Colorectal Cancer Sample<a href="visium-hd.html#colorectal-cancer-sample" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-2"></span>
<img src="img/02_session2/2.png" alt="Colorectal Cancer Overview. Source: *10X Genomics*" width="80%" />
<p class="caption">
Figure 9.2: Colorectal Cancer Overview. Source: <em>10X Genomics</em>
</p>
</div>
<p>For this tutorial we will be using the publicly available Colorectal Cancer Visium HD dataset.</p>
<p>Details about this dataset and a link to download the raw data can be found at the <a href="https://www.10xgenomics.com/datasets/visium-hd-cytassist-gene-expression-libraries-of-human-crc">10X Genomics website</a>.</p>
</div>
</div>
<div id="data-ingestion" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Data Ingestion<a href="visium-hd.html#data-ingestion" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="visium-hd-output-data-format" class="section level3 hasAnchor" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Visium HD output data format<a href="visium-hd.html#visium-hd-output-data-format" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-3"></span>
<img src="img/02_session2/3.png" alt="File structure of Visium HD data processed with spaceranger pipeline." width="80%" />
<p class="caption">
Figure 9.3: File structure of Visium HD data processed with spaceranger pipeline.
</p>
</div>
<p>Visium HD data processed with the spaceranger pipeline is organized in this format containing various files associated with the sample. The files highlighted in yellow are what we will be using to read in these datasets.</p>
</div>
<div id="mini-visium-hd-dataset" class="section level3 hasAnchor" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> Mini Visium HD dataset<a href="visium-hd.html#mini-visium-hd-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="visium-hd.html#cb1-1" tabindex="-1"></a><span class="fu">library</span>(Giotto)</span>
<span id="cb1-2"><a href="visium-hd.html#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="visium-hd.html#cb1-3" tabindex="-1"></a><span class="co"># set up paths</span></span>
<span id="cb1-4"><a href="visium-hd.html#cb1-4" tabindex="-1"></a>data_path <span class="ot">&lt;-</span> <span class="st">&quot;data/02_session2/&quot;</span></span>
<span id="cb1-5"><a href="visium-hd.html#cb1-5" tabindex="-1"></a>save_dir <span class="ot">&lt;-</span> <span class="st">&quot;results/02_session2/&quot;</span></span>
<span id="cb1-6"><a href="visium-hd.html#cb1-6" tabindex="-1"></a><span class="fu">dir.create</span>(save_dir, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-7"><a href="visium-hd.html#cb1-7" tabindex="-1"></a></span>
<span id="cb1-8"><a href="visium-hd.html#cb1-8" tabindex="-1"></a><span class="co"># download the mini dataset and untar</span></span>
<span id="cb1-9"><a href="visium-hd.html#cb1-9" tabindex="-1"></a><span class="fu">options</span>(<span class="st">&quot;timeout&quot;</span> <span class="ot">=</span> <span class="cn">Inf</span>)</span>
<span id="cb1-10"><a href="visium-hd.html#cb1-10" tabindex="-1"></a><span class="fu">download.file</span>(</span>
<span id="cb1-11"><a href="visium-hd.html#cb1-11" tabindex="-1"></a>    <span class="at">url =</span> <span class="st">&quot;https://zenodo.org/records/13212855/files/workshop_VisiumHD.zip?download=1&quot;</span>,</span>
<span id="cb1-12"><a href="visium-hd.html#cb1-12" tabindex="-1"></a>    <span class="at">destfile =</span> <span class="fu">file.path</span>(save_dir, <span class="st">&quot;workshop_visiumHD.zip&quot;</span>)</span>
<span id="cb1-13"><a href="visium-hd.html#cb1-13" tabindex="-1"></a>)</span>
<span id="cb1-14"><a href="visium-hd.html#cb1-14" tabindex="-1"></a><span class="fu">untar</span>(<span class="at">tarfile =</span> <span class="fu">file.path</span>(save_dir, <span class="st">&quot;workshop_visiumHD.zip&quot;</span>), </span>
<span id="cb1-15"><a href="visium-hd.html#cb1-15" tabindex="-1"></a>      <span class="at">exdir =</span> data_path)</span></code></pre></div>
</div>
<div id="giotto-visium-hd-convenience-function" class="section level3 hasAnchor" number="9.3.3">
<h3><span class="header-section-number">9.3.3</span> Giotto Visium HD convenience function<a href="visium-hd.html#giotto-visium-hd-convenience-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The easiest way to read in Visium HD data in Giotto is through our convenience function. This function will automatically read in the data at your desired resolution, align the images, and finally create a Giotto Object.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="visium-hd.html#cb2-1" tabindex="-1"></a><span class="co"># importVisiumHD()</span></span></code></pre></div>
<p>However, for this tutorial we will illustrate how to create your own Giotto object in a step-by-step manner, which can also be applied to other similar technologies as discussed in the <a href="#Objective">Objective</a> section.</p>
</div>
<div id="read-in-data-manually" class="section level3 hasAnchor" number="9.3.4">
<h3><span class="header-section-number">9.3.4</span> Read in data manually<a href="visium-hd.html#read-in-data-manually" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="raw-expression-data" class="section level4 hasAnchor" number="9.3.4.1">
<h4><span class="header-section-number">9.3.4.1</span> Raw expression data<a href="visium-hd.html#raw-expression-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="visium-hd.html#cb3-1" tabindex="-1"></a>expression_path <span class="ot">=</span> <span class="fu">file.path</span>(data_path, <span class="st">&#39;raw_feature_bc_matrix&#39;</span>)</span>
<span id="cb3-2"><a href="visium-hd.html#cb3-2" tabindex="-1"></a>expr_results <span class="ot">&lt;-</span> <span class="fu">get10Xmatrix</span>(<span class="at">path_to_data =</span> expression_path, </span>
<span id="cb3-3"><a href="visium-hd.html#cb3-3" tabindex="-1"></a>                             <span class="at">gene_column_index =</span> <span class="dv">1</span>)</span></code></pre></div>
</div>
<div id="tissue-positions-data" class="section level4 hasAnchor" number="9.3.4.2">
<h4><span class="header-section-number">9.3.4.2</span> Tissue positions data<a href="visium-hd.html#tissue-positions-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="visium-hd.html#cb4-1" tabindex="-1"></a>tissue_positions_path <span class="ot">=</span> <span class="fu">file.path</span>(data_path, <span class="st">&#39;spatial&#39;</span>, <span class="st">&#39;tissue_positions.parquet&#39;</span>)</span>
<span id="cb4-2"><a href="visium-hd.html#cb4-2" tabindex="-1"></a>tissue_positions <span class="ot">=</span> data.table<span class="sc">::</span><span class="fu">as.data.table</span>(arrow<span class="sc">::</span><span class="fu">read_parquet</span>(tissue_positions_path))</span></code></pre></div>
</div>
<div id="merge-expression-and-2-micron-position-data" class="section level4 hasAnchor" number="9.3.4.3">
<h4><span class="header-section-number">9.3.4.3</span> Merge expression and 2 micron position data<a href="visium-hd.html#merge-expression-and-2-micron-position-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="visium-hd.html#cb5-1" tabindex="-1"></a><span class="co"># convert expression matrix to minimal data.frame or data.table object</span></span>
<span id="cb5-2"><a href="visium-hd.html#cb5-2" tabindex="-1"></a>matrix_tile_dt <span class="ot">=</span> data.table<span class="sc">::</span><span class="fu">as.data.table</span>(Matrix<span class="sc">::</span><span class="fu">summary</span>(expr_results))</span>
<span id="cb5-3"><a href="visium-hd.html#cb5-3" tabindex="-1"></a>genes <span class="ot">=</span> expr_results<span class="sc">@</span>Dimnames[[<span class="dv">1</span>]]</span>
<span id="cb5-4"><a href="visium-hd.html#cb5-4" tabindex="-1"></a>samples <span class="ot">=</span> expr_results<span class="sc">@</span>Dimnames[[<span class="dv">2</span>]]</span>
<span id="cb5-5"><a href="visium-hd.html#cb5-5" tabindex="-1"></a>matrix_tile_dt[, gene <span class="sc">:=</span> genes[i]]</span>
<span id="cb5-6"><a href="visium-hd.html#cb5-6" tabindex="-1"></a>matrix_tile_dt[, pixel <span class="sc">:=</span> samples[j]]</span>
<span id="cb5-7"><a href="visium-hd.html#cb5-7" tabindex="-1"></a></span>
<span id="cb5-8"><a href="visium-hd.html#cb5-8" tabindex="-1"></a><span class="co"># merge data.table matrix and spatial coordinates to create input for Giotto Polygons</span></span>
<span id="cb5-9"><a href="visium-hd.html#cb5-9" tabindex="-1"></a>expr_pos_data <span class="ot">=</span> data.table<span class="sc">::</span><span class="fu">merge.data.table</span>(matrix_tile_dt, </span>
<span id="cb5-10"><a href="visium-hd.html#cb5-10" tabindex="-1"></a>                                             tissue_positions, </span>
<span id="cb5-11"><a href="visium-hd.html#cb5-11" tabindex="-1"></a>                                             <span class="at">by.x =</span> <span class="st">&#39;pixel&#39;</span>, </span>
<span id="cb5-12"><a href="visium-hd.html#cb5-12" tabindex="-1"></a>                                             <span class="at">by.y =</span> <span class="st">&#39;barcode&#39;</span>)</span>
<span id="cb5-13"><a href="visium-hd.html#cb5-13" tabindex="-1"></a></span>
<span id="cb5-14"><a href="visium-hd.html#cb5-14" tabindex="-1"></a>expr_pos_data <span class="ot">=</span> expr_pos_data[,.(pixel, pxl_row_in_fullres, pxl_col_in_fullres, gene, x)]</span>
<span id="cb5-15"><a href="visium-hd.html#cb5-15" tabindex="-1"></a><span class="fu">colnames</span>(expr_pos_data) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;pixel&#39;</span>, <span class="st">&#39;x&#39;</span>, <span class="st">&#39;y&#39;</span>, <span class="st">&#39;gene&#39;</span>, <span class="st">&#39;counts&#39;</span>)</span></code></pre></div>
</div>
</div>
</div>
<div id="create-giotto-object" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> Create Giotto object<a href="visium-hd.html#create-giotto-object" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="create-giotto-points" class="section level3 hasAnchor" number="9.4.1">
<h3><span class="header-section-number">9.4.1</span> create giotto points<a href="visium-hd.html#create-giotto-points" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="visium-hd.html#cb6-1" tabindex="-1"></a>giotto_points <span class="ot">=</span> <span class="fu">createGiottoPoints</span>(<span class="at">x =</span> expr_pos_data[,.(x, y, gene, pixel, counts)])</span></code></pre></div>
</div>
<div id="create-giotto-polygons" class="section level3 hasAnchor" number="9.4.2">
<h3><span class="header-section-number">9.4.2</span> create giotto polygons<a href="visium-hd.html#create-giotto-polygons" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="tiling-and-aggregation" class="section level4 hasAnchor" number="9.4.2.1">
<h4><span class="header-section-number">9.4.2.1</span> Tiling and aggregation<a href="visium-hd.html#tiling-and-aggregation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Visium HD data is organized in a grid format. We can aggregate the data into larger bins to reduce the dimensionality of the data. Giotto Suite provides options to bin data not only with squares, but also through hexagons and triangles. Here we use a hexagon tesselation to aggregate the data into arbitrary cells.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="visium-hd.html#cb7-1" tabindex="-1"></a><span class="co"># create giotto polygons, here we create hexagons</span></span>
<span id="cb7-2"><a href="visium-hd.html#cb7-2" tabindex="-1"></a>hexbin400 <span class="ot">&lt;-</span> <span class="fu">tessellate</span>(<span class="at">extent =</span> <span class="fu">ext</span>(giotto_points), </span>
<span id="cb7-3"><a href="visium-hd.html#cb7-3" tabindex="-1"></a>                        <span class="at">shape =</span> <span class="st">&#39;hexagon&#39;</span>, </span>
<span id="cb7-4"><a href="visium-hd.html#cb7-4" tabindex="-1"></a>                        <span class="at">shape_size =</span> <span class="dv">400</span>, </span>
<span id="cb7-5"><a href="visium-hd.html#cb7-5" tabindex="-1"></a>                        <span class="at">name =</span> <span class="st">&#39;hex400&#39;</span>) </span>
<span id="cb7-6"><a href="visium-hd.html#cb7-6" tabindex="-1"></a><span class="fu">plot</span>(hexbin400)</span></code></pre></div>
</div>
</div>
<div id="combine-giotto-points-and-polygons-to-create-giotto-object" class="section level3 hasAnchor" number="9.4.3">
<h3><span class="header-section-number">9.4.3</span> combine Giotto points and polygons to create Giotto object<a href="visium-hd.html#combine-giotto-points-and-polygons-to-create-giotto-object" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="visium-hd.html#cb8-1" tabindex="-1"></a>instrs <span class="ot">=</span> <span class="fu">createGiottoInstructions</span>(</span>
<span id="cb8-2"><a href="visium-hd.html#cb8-2" tabindex="-1"></a>  <span class="at">save_dir =</span> results_folder,</span>
<span id="cb8-3"><a href="visium-hd.html#cb8-3" tabindex="-1"></a>  <span class="at">save_plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-4"><a href="visium-hd.html#cb8-4" tabindex="-1"></a>  <span class="at">show_plot =</span> <span class="cn">FALSE</span>,</span>
<span id="cb8-5"><a href="visium-hd.html#cb8-5" tabindex="-1"></a>  <span class="at">return_plot =</span> <span class="cn">FALSE</span></span>
<span id="cb8-6"><a href="visium-hd.html#cb8-6" tabindex="-1"></a>)</span>
<span id="cb8-7"><a href="visium-hd.html#cb8-7" tabindex="-1"></a></span>
<span id="cb8-8"><a href="visium-hd.html#cb8-8" tabindex="-1"></a>visiumHD <span class="ot">=</span> <span class="fu">createGiottoObjectSubcellular</span>(<span class="at">gpoints =</span> <span class="fu">list</span>(<span class="st">&#39;rna&#39;</span> <span class="ot">=</span> giotto_points),</span>
<span id="cb8-9"><a href="visium-hd.html#cb8-9" tabindex="-1"></a>                                         <span class="at">gpolygons =</span> <span class="fu">list</span>(<span class="st">&#39;hex400&#39;</span> <span class="ot">=</span> hexbin400),</span>
<span id="cb8-10"><a href="visium-hd.html#cb8-10" tabindex="-1"></a>                                         <span class="at">instructions =</span> instrs)</span>
<span id="cb8-11"><a href="visium-hd.html#cb8-11" tabindex="-1"></a></span>
<span id="cb8-12"><a href="visium-hd.html#cb8-12" tabindex="-1"></a>visiumHD <span class="ot">=</span> <span class="fu">addSpatialCentroidLocations</span>(<span class="at">gobject =</span> visiumHD,</span>
<span id="cb8-13"><a href="visium-hd.html#cb8-13" tabindex="-1"></a>                                       <span class="at">poly_info =</span> <span class="st">&#39;hex400&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="visium-hd.html#cb9-1" tabindex="-1"></a>feature_data <span class="ot">=</span> <span class="fu">fDataDT</span>(visiumHD)</span>
<span id="cb9-2"><a href="visium-hd.html#cb9-2" tabindex="-1"></a></span>
<span id="cb9-3"><a href="visium-hd.html#cb9-3" tabindex="-1"></a><span class="fu">spatInSituPlotPoints</span>(visiumHD,</span>
<span id="cb9-4"><a href="visium-hd.html#cb9-4" tabindex="-1"></a>                     <span class="at">show_image =</span> F,</span>
<span id="cb9-5"><a href="visium-hd.html#cb9-5" tabindex="-1"></a>                     <span class="at">feats =</span> <span class="fu">list</span>(<span class="st">&#39;rna&#39;</span> <span class="ot">=</span> feature_data<span class="sc">$</span>feat_ID[<span class="dv">10</span><span class="sc">:</span><span class="dv">20</span>]),</span>
<span id="cb9-6"><a href="visium-hd.html#cb9-6" tabindex="-1"></a>                     <span class="at">show_legend =</span> T,</span>
<span id="cb9-7"><a href="visium-hd.html#cb9-7" tabindex="-1"></a>                     <span class="at">spat_unit =</span> <span class="st">&#39;hex400&#39;</span>,</span>
<span id="cb9-8"><a href="visium-hd.html#cb9-8" tabindex="-1"></a>                     <span class="at">point_size =</span> <span class="fl">0.25</span>,</span>
<span id="cb9-9"><a href="visium-hd.html#cb9-9" tabindex="-1"></a>                     <span class="at">show_polygon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-10"><a href="visium-hd.html#cb9-10" tabindex="-1"></a>                     <span class="at">use_overlap =</span> <span class="cn">FALSE</span>,</span>
<span id="cb9-11"><a href="visium-hd.html#cb9-11" tabindex="-1"></a>                     <span class="at">polygon_feat_type =</span> <span class="st">&#39;hex400&#39;</span>,</span>
<span id="cb9-12"><a href="visium-hd.html#cb9-12" tabindex="-1"></a>                     <span class="at">polygon_bg_color =</span> <span class="cn">NA</span>,</span>
<span id="cb9-13"><a href="visium-hd.html#cb9-13" tabindex="-1"></a>                     <span class="at">polygon_color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb9-14"><a href="visium-hd.html#cb9-14" tabindex="-1"></a>                     <span class="at">polygon_line_size =</span> <span class="fl">0.1</span>,</span>
<span id="cb9-15"><a href="visium-hd.html#cb9-15" tabindex="-1"></a>                     <span class="at">expand_counts =</span> <span class="cn">TRUE</span>, </span>
<span id="cb9-16"><a href="visium-hd.html#cb9-16" tabindex="-1"></a>                     <span class="at">count_info_column =</span> <span class="st">&#39;count&#39;</span>,</span>
<span id="cb9-17"><a href="visium-hd.html#cb9-17" tabindex="-1"></a>                     <span class="at">jitter =</span> <span class="fu">c</span>(<span class="dv">25</span>,<span class="dv">25</span>))</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="visium-hd.html#cb10-1" tabindex="-1"></a><span class="fu">spatInSituPlotPoints</span>(visiumHD,</span>
<span id="cb10-2"><a href="visium-hd.html#cb10-2" tabindex="-1"></a>                     <span class="at">show_image =</span> F,</span>
<span id="cb10-3"><a href="visium-hd.html#cb10-3" tabindex="-1"></a>                     <span class="at">feats =</span> <span class="fu">list</span>(<span class="st">&#39;rna&#39;</span> <span class="ot">=</span> feature_data<span class="sc">$</span>feat_ID[<span class="dv">10</span><span class="sc">:</span><span class="dv">20</span>]),</span>
<span id="cb10-4"><a href="visium-hd.html#cb10-4" tabindex="-1"></a>                     <span class="at">show_legend =</span> T,</span>
<span id="cb10-5"><a href="visium-hd.html#cb10-5" tabindex="-1"></a>                     <span class="at">spat_unit =</span> <span class="st">&#39;hex400&#39;</span>,</span>
<span id="cb10-6"><a href="visium-hd.html#cb10-6" tabindex="-1"></a>                     <span class="at">point_size =</span> <span class="fl">0.25</span>,</span>
<span id="cb10-7"><a href="visium-hd.html#cb10-7" tabindex="-1"></a>                     <span class="at">show_polygon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb10-8"><a href="visium-hd.html#cb10-8" tabindex="-1"></a>                     <span class="at">use_overlap =</span> <span class="cn">FALSE</span>,</span>
<span id="cb10-9"><a href="visium-hd.html#cb10-9" tabindex="-1"></a>                     <span class="at">polygon_feat_type =</span> <span class="st">&#39;hex400&#39;</span>,</span>
<span id="cb10-10"><a href="visium-hd.html#cb10-10" tabindex="-1"></a>                     <span class="at">polygon_bg_color =</span> <span class="cn">NA</span>,</span>
<span id="cb10-11"><a href="visium-hd.html#cb10-11" tabindex="-1"></a>                     <span class="at">polygon_color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb10-12"><a href="visium-hd.html#cb10-12" tabindex="-1"></a>                     <span class="at">polygon_line_size =</span> <span class="fl">0.1</span>,</span>
<span id="cb10-13"><a href="visium-hd.html#cb10-13" tabindex="-1"></a>                     <span class="at">expand_counts =</span> <span class="cn">TRUE</span>, </span>
<span id="cb10-14"><a href="visium-hd.html#cb10-14" tabindex="-1"></a>                     <span class="at">count_info_column =</span> <span class="st">&#39;count&#39;</span>,</span>
<span id="cb10-15"><a href="visium-hd.html#cb10-15" tabindex="-1"></a>                     <span class="at">jitter =</span> <span class="fu">c</span>(<span class="dv">25</span>,<span class="dv">25</span>), </span>
<span id="cb10-16"><a href="visium-hd.html#cb10-16" tabindex="-1"></a>                     <span class="at">plot_method =</span> <span class="st">&#39;scattermore&#39;</span>)</span></code></pre></div>
</div>
</div>
<div id="process-giotto-object" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> Process Giotto object<a href="visium-hd.html#process-giotto-object" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="calculate-overlap-between-points-and-polygons" class="section level3 hasAnchor" number="9.5.1">
<h3><span class="header-section-number">9.5.1</span> calculate overlap between points and polygons<a href="visium-hd.html#calculate-overlap-between-points-and-polygons" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="visium-hd.html#cb11-1" tabindex="-1"></a><span class="co"># calculate overlap between points and polygons</span></span>
<span id="cb11-2"><a href="visium-hd.html#cb11-2" tabindex="-1"></a>visiumHD <span class="ot">=</span> <span class="fu">calculateOverlap</span>(visiumHD,</span>
<span id="cb11-3"><a href="visium-hd.html#cb11-3" tabindex="-1"></a>                            <span class="at">spatial_info =</span> <span class="st">&#39;hex400&#39;</span>,</span>
<span id="cb11-4"><a href="visium-hd.html#cb11-4" tabindex="-1"></a>                            <span class="at">feat_info =</span> <span class="st">&#39;rna&#39;</span>)</span>
<span id="cb11-5"><a href="visium-hd.html#cb11-5" tabindex="-1"></a></span>
<span id="cb11-6"><a href="visium-hd.html#cb11-6" tabindex="-1"></a><span class="fu">showGiottoSpatialInfo</span>(visiumHD)</span></code></pre></div>
</div>
<div id="convert-overlap-results-to-a-bin-by-gene-matrix" class="section level3 hasAnchor" number="9.5.2">
<h3><span class="header-section-number">9.5.2</span> convert overlap results to a bin-by-gene matrix<a href="visium-hd.html#convert-overlap-results-to-a-bin-by-gene-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="visium-hd.html#cb12-1" tabindex="-1"></a><span class="co"># convert overlap results to bin by gene matrix</span></span>
<span id="cb12-2"><a href="visium-hd.html#cb12-2" tabindex="-1"></a>visiumHD <span class="ot">=</span> <span class="fu">overlapToMatrix</span>(visiumHD,</span>
<span id="cb12-3"><a href="visium-hd.html#cb12-3" tabindex="-1"></a>                           <span class="at">poly_info =</span> <span class="st">&#39;hex400&#39;</span>,</span>
<span id="cb12-4"><a href="visium-hd.html#cb12-4" tabindex="-1"></a>                           <span class="at">feat_info =</span> <span class="st">&#39;rna&#39;</span>,</span>
<span id="cb12-5"><a href="visium-hd.html#cb12-5" tabindex="-1"></a>                           <span class="at">name =</span> <span class="st">&#39;raw&#39;</span>)</span>
<span id="cb12-6"><a href="visium-hd.html#cb12-6" tabindex="-1"></a></span>
<span id="cb12-7"><a href="visium-hd.html#cb12-7" tabindex="-1"></a><span class="fu">activeSpatUnit</span>(visiumHD)</span></code></pre></div>
</div>
<div id="default-processing-steps" class="section level3 hasAnchor" number="9.5.3">
<h3><span class="header-section-number">9.5.3</span> default processing steps<a href="visium-hd.html#default-processing-steps" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="visium-hd.html#cb13-1" tabindex="-1"></a>visiumHD <span class="ot">&lt;-</span> <span class="fu">filterGiotto</span>(visiumHD,</span>
<span id="cb13-2"><a href="visium-hd.html#cb13-2" tabindex="-1"></a>                         <span class="at">expression_threshold =</span> <span class="dv">1</span>,</span>
<span id="cb13-3"><a href="visium-hd.html#cb13-3" tabindex="-1"></a>                         <span class="at">feat_det_in_min_cells =</span> <span class="dv">5</span>,</span>
<span id="cb13-4"><a href="visium-hd.html#cb13-4" tabindex="-1"></a>                         <span class="at">min_det_feats_per_cell =</span> <span class="dv">25</span>)</span>
<span id="cb13-5"><a href="visium-hd.html#cb13-5" tabindex="-1"></a></span>
<span id="cb13-6"><a href="visium-hd.html#cb13-6" tabindex="-1"></a><span class="co"># normalize</span></span>
<span id="cb13-7"><a href="visium-hd.html#cb13-7" tabindex="-1"></a>visiumHD <span class="ot">&lt;-</span> <span class="fu">normalizeGiotto</span>(visiumHD, <span class="at">scalefactor =</span> <span class="dv">1000</span>, <span class="at">verbose =</span> T)</span>
<span id="cb13-8"><a href="visium-hd.html#cb13-8" tabindex="-1"></a></span>
<span id="cb13-9"><a href="visium-hd.html#cb13-9" tabindex="-1"></a><span class="co"># add statistics</span></span>
<span id="cb13-10"><a href="visium-hd.html#cb13-10" tabindex="-1"></a>visiumHD <span class="ot">&lt;-</span> <span class="fu">addStatistics</span>(visiumHD)</span></code></pre></div>
</div>
<div id="visualize-number-of-features" class="section level3 hasAnchor" number="9.5.4">
<h3><span class="header-section-number">9.5.4</span> visualize number of features<a href="visium-hd.html#visualize-number-of-features" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>At the centroid level.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="visium-hd.html#cb14-1" tabindex="-1"></a><span class="co"># each dot here represents a 200x200 aggregation of spatial barcodes (bin size 200)</span></span>
<span id="cb14-2"><a href="visium-hd.html#cb14-2" tabindex="-1"></a><span class="fu">spatPlot2D</span>(<span class="at">gobject =</span> visiumHD,</span>
<span id="cb14-3"><a href="visium-hd.html#cb14-3" tabindex="-1"></a>           <span class="at">cell_color =</span> <span class="st">&quot;nr_feats&quot;</span>,</span>
<span id="cb14-4"><a href="visium-hd.html#cb14-4" tabindex="-1"></a>           <span class="at">color_as_factor =</span> F,</span>
<span id="cb14-5"><a href="visium-hd.html#cb14-5" tabindex="-1"></a>           <span class="at">point_size =</span> <span class="fl">2.5</span>)</span></code></pre></div>
<p>Using the spatial polygon (hexagon) tiles</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="visium-hd.html#cb15-1" tabindex="-1"></a><span class="fu">spatInSituPlotPoints</span>(visiumHD,</span>
<span id="cb15-2"><a href="visium-hd.html#cb15-2" tabindex="-1"></a>                     <span class="at">show_image =</span> F,</span>
<span id="cb15-3"><a href="visium-hd.html#cb15-3" tabindex="-1"></a>                     <span class="at">feats =</span> <span class="cn">NULL</span>,</span>
<span id="cb15-4"><a href="visium-hd.html#cb15-4" tabindex="-1"></a>                     <span class="at">show_legend =</span> F,</span>
<span id="cb15-5"><a href="visium-hd.html#cb15-5" tabindex="-1"></a>                     <span class="at">spat_unit =</span> <span class="st">&#39;hex400&#39;</span>,</span>
<span id="cb15-6"><a href="visium-hd.html#cb15-6" tabindex="-1"></a>                     <span class="at">point_size =</span> <span class="fl">0.1</span>,</span>
<span id="cb15-7"><a href="visium-hd.html#cb15-7" tabindex="-1"></a>                     <span class="at">show_polygon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-8"><a href="visium-hd.html#cb15-8" tabindex="-1"></a>                     <span class="at">use_overlap =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-9"><a href="visium-hd.html#cb15-9" tabindex="-1"></a>                     <span class="at">polygon_feat_type =</span> <span class="st">&#39;hex400&#39;</span>, </span>
<span id="cb15-10"><a href="visium-hd.html#cb15-10" tabindex="-1"></a>                     <span class="at">polygon_fill =</span> <span class="st">&#39;nr_feats&#39;</span>, </span>
<span id="cb15-11"><a href="visium-hd.html#cb15-11" tabindex="-1"></a>                     <span class="at">polygon_fill_as_factor =</span> F,</span>
<span id="cb15-12"><a href="visium-hd.html#cb15-12" tabindex="-1"></a>                     <span class="at">polygon_bg_color =</span> <span class="cn">NA</span>,</span>
<span id="cb15-13"><a href="visium-hd.html#cb15-13" tabindex="-1"></a>                     <span class="at">polygon_color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb15-14"><a href="visium-hd.html#cb15-14" tabindex="-1"></a>                     <span class="at">polygon_line_size =</span> <span class="fl">0.1</span>)</span></code></pre></div>
</div>
</div>
<div id="dimension-reduction-clustering" class="section level2 hasAnchor" number="9.6">
<h2><span class="header-section-number">9.6</span> Dimension reduction + clustering<a href="visium-hd.html#dimension-reduction-clustering" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="highly-variable-features-pca" class="section level3 hasAnchor" number="9.6.1">
<h3><span class="header-section-number">9.6.1</span> Highly variable features + PCA<a href="visium-hd.html#highly-variable-features-pca" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="visium-hd.html#cb16-1" tabindex="-1"></a>visiumHD <span class="ot">&lt;-</span> <span class="fu">calculateHVF</span>(visiumHD, <span class="at">zscore_threshold =</span> <span class="dv">1</span>)</span>
<span id="cb16-2"><a href="visium-hd.html#cb16-2" tabindex="-1"></a>visiumHD <span class="ot">&lt;-</span> <span class="fu">runPCA</span>(visiumHD, <span class="at">expression_values =</span> <span class="st">&#39;normalized&#39;</span>, <span class="at">feats_to_use =</span> <span class="st">&#39;hvf&#39;</span>)</span>
<span id="cb16-3"><a href="visium-hd.html#cb16-3" tabindex="-1"></a><span class="fu">screePlot</span>(visiumHD, <span class="at">ncp =</span> <span class="dv">30</span>)</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="visium-hd.html#cb17-1" tabindex="-1"></a><span class="fu">plotPCA</span>(visiumHD)</span></code></pre></div>
</div>
<div id="umap-reduction-for-visualization" class="section level3 hasAnchor" number="9.6.2">
<h3><span class="header-section-number">9.6.2</span> UMAP reduction for visualization<a href="visium-hd.html#umap-reduction-for-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="visium-hd.html#cb18-1" tabindex="-1"></a>visiumHD <span class="ot">&lt;-</span> <span class="fu">runUMAP</span>(visiumHD, </span>
<span id="cb18-2"><a href="visium-hd.html#cb18-2" tabindex="-1"></a>                    <span class="at">dimensions_to_use =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>, </span>
<span id="cb18-3"><a href="visium-hd.html#cb18-3" tabindex="-1"></a>                    <span class="at">n_threads =</span> <span class="dv">10</span>)</span>
<span id="cb18-4"><a href="visium-hd.html#cb18-4" tabindex="-1"></a></span>
<span id="cb18-5"><a href="visium-hd.html#cb18-5" tabindex="-1"></a><span class="fu">plotUMAP</span>(<span class="at">gobject =</span> visiumHD,</span>
<span id="cb18-6"><a href="visium-hd.html#cb18-6" tabindex="-1"></a>         <span class="at">point_size =</span> <span class="dv">1</span>)</span></code></pre></div>
</div>
<div id="create-network-based-on-expression-similarity-graph-partition-cluster" class="section level3 hasAnchor" number="9.6.3">
<h3><span class="header-section-number">9.6.3</span> Create network based on expression similarity + graph partition cluster<a href="visium-hd.html#create-network-based-on-expression-similarity-graph-partition-cluster" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="visium-hd.html#cb19-1" tabindex="-1"></a><span class="co"># sNN network (default)</span></span>
<span id="cb19-2"><a href="visium-hd.html#cb19-2" tabindex="-1"></a>visiumHD <span class="ot">&lt;-</span> <span class="fu">createNearestNetwork</span>(visiumHD, </span>
<span id="cb19-3"><a href="visium-hd.html#cb19-3" tabindex="-1"></a>                                 <span class="at">dimensions_to_use =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>, <span class="at">k =</span> <span class="dv">5</span>)</span>
<span id="cb19-4"><a href="visium-hd.html#cb19-4" tabindex="-1"></a></span>
<span id="cb19-5"><a href="visium-hd.html#cb19-5" tabindex="-1"></a></span>
<span id="cb19-6"><a href="visium-hd.html#cb19-6" tabindex="-1"></a><span class="do">## leiden clustering ####</span></span>
<span id="cb19-7"><a href="visium-hd.html#cb19-7" tabindex="-1"></a>visiumHD <span class="ot">&lt;-</span> <span class="fu">doLeidenClusterIgraph</span>(visiumHD, <span class="at">resolution =</span> <span class="fl">0.5</span>, <span class="at">n_iterations =</span> <span class="dv">1000</span>, <span class="at">spat_unit =</span> <span class="st">&#39;hex400&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="visium-hd.html#cb20-1" tabindex="-1"></a><span class="fu">plotUMAP</span>(<span class="at">gobject =</span> visiumHD,</span>
<span id="cb20-2"><a href="visium-hd.html#cb20-2" tabindex="-1"></a>         <span class="at">cell_color =</span> <span class="st">&#39;leiden_clus&#39;</span>, </span>
<span id="cb20-3"><a href="visium-hd.html#cb20-3" tabindex="-1"></a>         <span class="at">point_size =</span> <span class="fl">1.5</span>,</span>
<span id="cb20-4"><a href="visium-hd.html#cb20-4" tabindex="-1"></a>         <span class="at">show_NN_network =</span> F, </span>
<span id="cb20-5"><a href="visium-hd.html#cb20-5" tabindex="-1"></a>         <span class="at">edge_alpha =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="visium-hd.html#cb21-1" tabindex="-1"></a><span class="fu">spatInSituPlotPoints</span>(visiumHD,</span>
<span id="cb21-2"><a href="visium-hd.html#cb21-2" tabindex="-1"></a>                     <span class="at">show_image =</span> F,</span>
<span id="cb21-3"><a href="visium-hd.html#cb21-3" tabindex="-1"></a>                     <span class="at">feats =</span> <span class="cn">NULL</span>,</span>
<span id="cb21-4"><a href="visium-hd.html#cb21-4" tabindex="-1"></a>                     <span class="at">show_legend =</span> F,</span>
<span id="cb21-5"><a href="visium-hd.html#cb21-5" tabindex="-1"></a>                     <span class="at">spat_unit =</span> <span class="st">&#39;hex400&#39;</span>,</span>
<span id="cb21-6"><a href="visium-hd.html#cb21-6" tabindex="-1"></a>                     <span class="at">point_size =</span> <span class="fl">0.25</span>,</span>
<span id="cb21-7"><a href="visium-hd.html#cb21-7" tabindex="-1"></a>                     <span class="at">show_polygon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb21-8"><a href="visium-hd.html#cb21-8" tabindex="-1"></a>                     <span class="at">use_overlap =</span> <span class="cn">FALSE</span>,</span>
<span id="cb21-9"><a href="visium-hd.html#cb21-9" tabindex="-1"></a>                     <span class="at">polygon_feat_type =</span> <span class="st">&#39;hex400&#39;</span>,</span>
<span id="cb21-10"><a href="visium-hd.html#cb21-10" tabindex="-1"></a>                     <span class="at">polygon_fill_as_factor =</span> <span class="cn">TRUE</span>,</span>
<span id="cb21-11"><a href="visium-hd.html#cb21-11" tabindex="-1"></a>                     <span class="at">polygon_fill =</span> <span class="st">&#39;leiden_clus&#39;</span>,</span>
<span id="cb21-12"><a href="visium-hd.html#cb21-12" tabindex="-1"></a>                     <span class="at">polygon_color =</span> <span class="st">&#39;black&#39;</span>,</span>
<span id="cb21-13"><a href="visium-hd.html#cb21-13" tabindex="-1"></a>                     <span class="at">polygon_line_size =</span> <span class="fl">0.3</span>)</span></code></pre></div>
</div>
</div>
<div id="hexbin-100" class="section level2 hasAnchor" number="9.7">
<h2><span class="header-section-number">9.7</span> Hexbin 100<a href="visium-hd.html#hexbin-100" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Goal is to create a higher resolution bin (hex100) and add to the Giotto object.</p>
<div id="standard-subcellular-pipeline" class="section level3 hasAnchor" number="9.7.1">
<h3><span class="header-section-number">9.7.1</span> Standard subcellular pipeline<a href="visium-hd.html#standard-subcellular-pipeline" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="visium-hd.html#cb22-1" tabindex="-1"></a>hexbin100 <span class="ot">&lt;-</span> <span class="fu">tessellate</span>(<span class="at">extent =</span> <span class="fu">ext</span>(visiumHD), </span>
<span id="cb22-2"><a href="visium-hd.html#cb22-2" tabindex="-1"></a>                        <span class="at">shape =</span> <span class="st">&#39;hexagon&#39;</span>, </span>
<span id="cb22-3"><a href="visium-hd.html#cb22-3" tabindex="-1"></a>                        <span class="at">shape_size =</span> <span class="dv">100</span>, </span>
<span id="cb22-4"><a href="visium-hd.html#cb22-4" tabindex="-1"></a>                        <span class="at">name =</span> <span class="st">&#39;hex100&#39;</span>) </span>
<span id="cb22-5"><a href="visium-hd.html#cb22-5" tabindex="-1"></a><span class="fu">plot</span>(hexbin100)</span>
<span id="cb22-6"><a href="visium-hd.html#cb22-6" tabindex="-1"></a></span>
<span id="cb22-7"><a href="visium-hd.html#cb22-7" tabindex="-1"></a>visiumHD <span class="ot">=</span> <span class="fu">setPolygonInfo</span>(<span class="at">gobject =</span> visiumHD,</span>
<span id="cb22-8"><a href="visium-hd.html#cb22-8" tabindex="-1"></a>                          <span class="at">x =</span> hexbin100,</span>
<span id="cb22-9"><a href="visium-hd.html#cb22-9" tabindex="-1"></a>                          <span class="at">name =</span> <span class="st">&#39;hex100&#39;</span>,</span>
<span id="cb22-10"><a href="visium-hd.html#cb22-10" tabindex="-1"></a>                          <span class="at">initialize =</span> T)</span>
<span id="cb22-11"><a href="visium-hd.html#cb22-11" tabindex="-1"></a></span>
<span id="cb22-12"><a href="visium-hd.html#cb22-12" tabindex="-1"></a>visiumHD <span class="ot">=</span> <span class="fu">addSpatialCentroidLocations</span>(<span class="at">gobject =</span> visiumHD,</span>
<span id="cb22-13"><a href="visium-hd.html#cb22-13" tabindex="-1"></a>                                       <span class="at">poly_info =</span> <span class="st">&#39;hex100&#39;</span>)</span></code></pre></div>
<p>Set active spatial unit. This can also be set manually.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="visium-hd.html#cb23-1" tabindex="-1"></a><span class="fu">activeSpatUnit</span>(visiumHD) <span class="ot">&lt;-</span> <span class="st">&#39;hex100&#39;</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="visium-hd.html#cb24-1" tabindex="-1"></a><span class="fu">spatInSituPlotPoints</span>(visiumHD,</span>
<span id="cb24-2"><a href="visium-hd.html#cb24-2" tabindex="-1"></a>                     <span class="at">show_image =</span> F,</span>
<span id="cb24-3"><a href="visium-hd.html#cb24-3" tabindex="-1"></a>                     <span class="at">feats =</span> <span class="fu">list</span>(<span class="st">&#39;rna&#39;</span> <span class="ot">=</span> feature_data<span class="sc">$</span>feat_ID[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>]),</span>
<span id="cb24-4"><a href="visium-hd.html#cb24-4" tabindex="-1"></a>                     <span class="at">show_legend =</span> T,</span>
<span id="cb24-5"><a href="visium-hd.html#cb24-5" tabindex="-1"></a>                     <span class="at">spat_unit =</span> <span class="st">&#39;hex100&#39;</span>,</span>
<span id="cb24-6"><a href="visium-hd.html#cb24-6" tabindex="-1"></a>                     <span class="at">point_size =</span> <span class="fl">0.1</span>,</span>
<span id="cb24-7"><a href="visium-hd.html#cb24-7" tabindex="-1"></a>                     <span class="at">show_polygon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb24-8"><a href="visium-hd.html#cb24-8" tabindex="-1"></a>                     <span class="at">use_overlap =</span> <span class="cn">FALSE</span>,</span>
<span id="cb24-9"><a href="visium-hd.html#cb24-9" tabindex="-1"></a>                     <span class="at">polygon_feat_type =</span> <span class="st">&#39;hex100&#39;</span>,</span>
<span id="cb24-10"><a href="visium-hd.html#cb24-10" tabindex="-1"></a>                     <span class="at">polygon_bg_color =</span> <span class="cn">NA</span>,</span>
<span id="cb24-11"><a href="visium-hd.html#cb24-11" tabindex="-1"></a>                     <span class="at">polygon_color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb24-12"><a href="visium-hd.html#cb24-12" tabindex="-1"></a>                     <span class="at">polygon_line_size =</span> <span class="fl">0.2</span>,</span>
<span id="cb24-13"><a href="visium-hd.html#cb24-13" tabindex="-1"></a>                     <span class="at">expand_counts =</span> <span class="cn">TRUE</span>, </span>
<span id="cb24-14"><a href="visium-hd.html#cb24-14" tabindex="-1"></a>                     <span class="at">count_info_column =</span> <span class="st">&#39;count&#39;</span>,</span>
<span id="cb24-15"><a href="visium-hd.html#cb24-15" tabindex="-1"></a>                     <span class="at">jitter =</span> <span class="fu">c</span>(<span class="dv">25</span>,<span class="dv">25</span>))</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="visium-hd.html#cb25-1" tabindex="-1"></a>visiumHD <span class="ot">=</span> <span class="fu">calculateOverlap</span>(visiumHD,</span>
<span id="cb25-2"><a href="visium-hd.html#cb25-2" tabindex="-1"></a>                            <span class="at">spatial_info =</span> <span class="st">&#39;hex100&#39;</span>,</span>
<span id="cb25-3"><a href="visium-hd.html#cb25-3" tabindex="-1"></a>                            <span class="at">feat_info =</span> <span class="st">&#39;rna&#39;</span>)</span>
<span id="cb25-4"><a href="visium-hd.html#cb25-4" tabindex="-1"></a></span>
<span id="cb25-5"><a href="visium-hd.html#cb25-5" tabindex="-1"></a>visiumHD <span class="ot">=</span> <span class="fu">overlapToMatrix</span>(visiumHD,</span>
<span id="cb25-6"><a href="visium-hd.html#cb25-6" tabindex="-1"></a>                           <span class="at">poly_info =</span> <span class="st">&#39;hex100&#39;</span>,</span>
<span id="cb25-7"><a href="visium-hd.html#cb25-7" tabindex="-1"></a>                           <span class="at">feat_info =</span> <span class="st">&#39;rna&#39;</span>,</span>
<span id="cb25-8"><a href="visium-hd.html#cb25-8" tabindex="-1"></a>                           <span class="at">name =</span> <span class="st">&#39;raw&#39;</span>)</span>
<span id="cb25-9"><a href="visium-hd.html#cb25-9" tabindex="-1"></a></span>
<span id="cb25-10"><a href="visium-hd.html#cb25-10" tabindex="-1"></a>visiumHD <span class="ot">&lt;-</span> <span class="fu">filterGiotto</span>(visiumHD,</span>
<span id="cb25-11"><a href="visium-hd.html#cb25-11" tabindex="-1"></a>                         <span class="at">expression_threshold =</span> <span class="dv">1</span>,</span>
<span id="cb25-12"><a href="visium-hd.html#cb25-12" tabindex="-1"></a>                         <span class="at">feat_det_in_min_cells =</span> <span class="dv">10</span>,</span>
<span id="cb25-13"><a href="visium-hd.html#cb25-13" tabindex="-1"></a>                         <span class="at">min_det_feats_per_cell =</span> <span class="dv">10</span>)</span>
<span id="cb25-14"><a href="visium-hd.html#cb25-14" tabindex="-1"></a></span>
<span id="cb25-15"><a href="visium-hd.html#cb25-15" tabindex="-1"></a>visiumHD <span class="ot">&lt;-</span> <span class="fu">normalizeGiotto</span>(visiumHD, <span class="at">scalefactor =</span> <span class="dv">1000</span>, <span class="at">verbose =</span> T)</span>
<span id="cb25-16"><a href="visium-hd.html#cb25-16" tabindex="-1"></a></span>
<span id="cb25-17"><a href="visium-hd.html#cb25-17" tabindex="-1"></a>visiumHD <span class="ot">&lt;-</span> <span class="fu">addStatistics</span>(visiumHD)</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="visium-hd.html#cb26-1" tabindex="-1"></a><span class="fu">pDataDT</span>(visiumHD, <span class="at">spat_unit =</span> <span class="st">&#39;hex100&#39;</span>)</span>
<span id="cb26-2"><a href="visium-hd.html#cb26-2" tabindex="-1"></a><span class="fu">pDataDT</span>(visiumHD, <span class="at">spat_unit =</span> <span class="st">&#39;hex400&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="visium-hd.html#cb27-1" tabindex="-1"></a><span class="do">## dimension reduction ####</span></span>
<span id="cb27-2"><a href="visium-hd.html#cb27-2" tabindex="-1"></a><span class="co"># --------------------------- #</span></span>
<span id="cb27-3"><a href="visium-hd.html#cb27-3" tabindex="-1"></a>visiumHD <span class="ot">&lt;-</span> <span class="fu">calculateHVF</span>(visiumHD, <span class="at">zscore_threshold =</span> <span class="dv">1</span>)</span>
<span id="cb27-4"><a href="visium-hd.html#cb27-4" tabindex="-1"></a></span>
<span id="cb27-5"><a href="visium-hd.html#cb27-5" tabindex="-1"></a>visiumHD <span class="ot">&lt;-</span> <span class="fu">runPCA</span>(visiumHD, <span class="at">expression_values =</span> <span class="st">&#39;normalized&#39;</span>, <span class="at">feats_to_use =</span> <span class="st">&#39;hvf&#39;</span>)</span>
<span id="cb27-6"><a href="visium-hd.html#cb27-6" tabindex="-1"></a></span>
<span id="cb27-7"><a href="visium-hd.html#cb27-7" tabindex="-1"></a><span class="fu">plotPCA</span>(visiumHD)</span>
<span id="cb27-8"><a href="visium-hd.html#cb27-8" tabindex="-1"></a></span>
<span id="cb27-9"><a href="visium-hd.html#cb27-9" tabindex="-1"></a>visiumHD <span class="ot">&lt;-</span> <span class="fu">runUMAP</span>(visiumHD, <span class="at">dimensions_to_use =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>, <span class="at">n_threads =</span> <span class="dv">10</span>)</span>
<span id="cb27-10"><a href="visium-hd.html#cb27-10" tabindex="-1"></a></span>
<span id="cb27-11"><a href="visium-hd.html#cb27-11" tabindex="-1"></a><span class="co"># plot UMAP, coloring cells/points based on nr_feats</span></span>
<span id="cb27-12"><a href="visium-hd.html#cb27-12" tabindex="-1"></a><span class="fu">plotUMAP</span>(<span class="at">gobject =</span> visiumHD,</span>
<span id="cb27-13"><a href="visium-hd.html#cb27-13" tabindex="-1"></a>         <span class="at">point_size =</span> <span class="dv">2</span>)</span>
<span id="cb27-14"><a href="visium-hd.html#cb27-14" tabindex="-1"></a></span>
<span id="cb27-15"><a href="visium-hd.html#cb27-15" tabindex="-1"></a><span class="co"># sNN network (default)</span></span>
<span id="cb27-16"><a href="visium-hd.html#cb27-16" tabindex="-1"></a>visiumHD <span class="ot">&lt;-</span> <span class="fu">createNearestNetwork</span>(visiumHD, </span>
<span id="cb27-17"><a href="visium-hd.html#cb27-17" tabindex="-1"></a>                                 <span class="at">dimensions_to_use =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>, </span>
<span id="cb27-18"><a href="visium-hd.html#cb27-18" tabindex="-1"></a>                                 <span class="at">k =</span> <span class="dv">5</span>)</span>
<span id="cb27-19"><a href="visium-hd.html#cb27-19" tabindex="-1"></a></span>
<span id="cb27-20"><a href="visium-hd.html#cb27-20" tabindex="-1"></a><span class="do">## leiden clustering ####</span></span>
<span id="cb27-21"><a href="visium-hd.html#cb27-21" tabindex="-1"></a>visiumHD <span class="ot">&lt;-</span> <span class="fu">doLeidenClusterIgraph</span>(visiumHD, <span class="at">resolution =</span> <span class="fl">0.2</span>, <span class="at">n_iterations =</span> <span class="dv">1000</span>)</span>
<span id="cb27-22"><a href="visium-hd.html#cb27-22" tabindex="-1"></a></span>
<span id="cb27-23"><a href="visium-hd.html#cb27-23" tabindex="-1"></a><span class="fu">plotUMAP</span>(<span class="at">gobject =</span> visiumHD,</span>
<span id="cb27-24"><a href="visium-hd.html#cb27-24" tabindex="-1"></a>         <span class="at">cell_color =</span> <span class="st">&#39;leiden_clus&#39;</span>, </span>
<span id="cb27-25"><a href="visium-hd.html#cb27-25" tabindex="-1"></a>         <span class="at">point_size =</span> <span class="fl">1.5</span>,</span>
<span id="cb27-26"><a href="visium-hd.html#cb27-26" tabindex="-1"></a>         <span class="at">show_NN_network =</span> F, </span>
<span id="cb27-27"><a href="visium-hd.html#cb27-27" tabindex="-1"></a>         <span class="at">edge_alpha =</span> <span class="fl">0.05</span>)</span>
<span id="cb27-28"><a href="visium-hd.html#cb27-28" tabindex="-1"></a></span>
<span id="cb27-29"><a href="visium-hd.html#cb27-29" tabindex="-1"></a><span class="fu">spatInSituPlotPoints</span>(visiumHD,</span>
<span id="cb27-30"><a href="visium-hd.html#cb27-30" tabindex="-1"></a>                     <span class="at">show_image =</span> F,</span>
<span id="cb27-31"><a href="visium-hd.html#cb27-31" tabindex="-1"></a>                     <span class="at">feats =</span> <span class="cn">NULL</span>,</span>
<span id="cb27-32"><a href="visium-hd.html#cb27-32" tabindex="-1"></a>                     <span class="at">show_legend =</span> F,</span>
<span id="cb27-33"><a href="visium-hd.html#cb27-33" tabindex="-1"></a>                     <span class="at">spat_unit =</span> <span class="st">&#39;hex100&#39;</span>,</span>
<span id="cb27-34"><a href="visium-hd.html#cb27-34" tabindex="-1"></a>                     <span class="at">point_size =</span> <span class="fl">0.5</span>,</span>
<span id="cb27-35"><a href="visium-hd.html#cb27-35" tabindex="-1"></a>                     <span class="at">show_polygon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-36"><a href="visium-hd.html#cb27-36" tabindex="-1"></a>                     <span class="at">use_overlap =</span> <span class="cn">FALSE</span>,</span>
<span id="cb27-37"><a href="visium-hd.html#cb27-37" tabindex="-1"></a>                     <span class="at">polygon_feat_type =</span> <span class="st">&#39;hex100&#39;</span>,</span>
<span id="cb27-38"><a href="visium-hd.html#cb27-38" tabindex="-1"></a>                     <span class="at">polygon_fill_as_factor =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-39"><a href="visium-hd.html#cb27-39" tabindex="-1"></a>                     <span class="at">polygon_fill =</span> <span class="st">&#39;leiden_clus&#39;</span>,</span>
<span id="cb27-40"><a href="visium-hd.html#cb27-40" tabindex="-1"></a>                     <span class="at">polygon_color =</span> <span class="st">&#39;black&#39;</span>,</span>
<span id="cb27-41"><a href="visium-hd.html#cb27-41" tabindex="-1"></a>                     <span class="at">polygon_line_size =</span> <span class="fl">0.3</span>)</span></code></pre></div>
</div>
<div id="spatial-expression-patterns-1" class="section level3 hasAnchor" number="9.7.2">
<h3><span class="header-section-number">9.7.2</span> Spatial expression patterns<a href="visium-hd.html#spatial-expression-patterns-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="identify-single-genes" class="section level4 hasAnchor" number="9.7.2.1">
<h4><span class="header-section-number">9.7.2.1</span> Identify single genes<a href="visium-hd.html#identify-single-genes" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="visium-hd.html#cb28-1" tabindex="-1"></a>featData <span class="ot">=</span> <span class="fu">fDataDT</span>(visiumHD)</span>
<span id="cb28-2"><a href="visium-hd.html#cb28-2" tabindex="-1"></a>hvf_genes <span class="ot">=</span> featData[hvf <span class="sc">==</span> <span class="st">&#39;yes&#39;</span>]<span class="sc">$</span>feat_ID</span>
<span id="cb28-3"><a href="visium-hd.html#cb28-3" tabindex="-1"></a></span>
<span id="cb28-4"><a href="visium-hd.html#cb28-4" tabindex="-1"></a>visiumHD <span class="ot">=</span> <span class="fu">createSpatialNetwork</span>(visiumHD,</span>
<span id="cb28-5"><a href="visium-hd.html#cb28-5" tabindex="-1"></a>                                <span class="at">name =</span> <span class="st">&#39;kNN_network&#39;</span>,</span>
<span id="cb28-6"><a href="visium-hd.html#cb28-6" tabindex="-1"></a>                                <span class="at">spat_unit =</span> <span class="st">&#39;hex100&#39;</span>, </span>
<span id="cb28-7"><a href="visium-hd.html#cb28-7" tabindex="-1"></a>                                <span class="at">method =</span> <span class="st">&#39;kNN&#39;</span>,</span>
<span id="cb28-8"><a href="visium-hd.html#cb28-8" tabindex="-1"></a>                                <span class="at">k =</span> <span class="dv">8</span>)</span>
<span id="cb28-9"><a href="visium-hd.html#cb28-9" tabindex="-1"></a></span>
<span id="cb28-10"><a href="visium-hd.html#cb28-10" tabindex="-1"></a>ranktest <span class="ot">=</span> <span class="fu">binSpect</span>(visiumHD,</span>
<span id="cb28-11"><a href="visium-hd.html#cb28-11" tabindex="-1"></a>                    <span class="at">spat_unit =</span> <span class="st">&#39;hex100&#39;</span>,</span>
<span id="cb28-12"><a href="visium-hd.html#cb28-12" tabindex="-1"></a>                    <span class="at">subset_feats =</span> hvf_genes,</span>
<span id="cb28-13"><a href="visium-hd.html#cb28-13" tabindex="-1"></a>                    <span class="at">bin_method =</span> <span class="st">&#39;rank&#39;</span>,</span>
<span id="cb28-14"><a href="visium-hd.html#cb28-14" tabindex="-1"></a>                    <span class="at">calc_hub =</span> <span class="cn">FALSE</span>,</span>
<span id="cb28-15"><a href="visium-hd.html#cb28-15" tabindex="-1"></a>                    <span class="at">do_fisher_test =</span> <span class="cn">TRUE</span>,</span>
<span id="cb28-16"><a href="visium-hd.html#cb28-16" tabindex="-1"></a>                    <span class="at">spatial_network_name =</span> <span class="st">&#39;kNN_network&#39;</span>)</span></code></pre></div>
<p>Visualize top 2 ranked spatial genes per expression bin:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="visium-hd.html#cb29-1" tabindex="-1"></a>set1 <span class="ot">=</span> ranktest[high_expr <span class="sc">&gt;</span> <span class="dv">50</span> <span class="sc">&amp;</span> high_expr <span class="sc">&lt;</span> <span class="dv">100</span>][<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]<span class="sc">$</span>feats</span>
<span id="cb29-2"><a href="visium-hd.html#cb29-2" tabindex="-1"></a>set2 <span class="ot">=</span> ranktest[high_expr <span class="sc">&gt;</span> <span class="dv">100</span> <span class="sc">&amp;</span> high_expr <span class="sc">&lt;</span> <span class="dv">200</span>][<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]<span class="sc">$</span>feats</span>
<span id="cb29-3"><a href="visium-hd.html#cb29-3" tabindex="-1"></a>set3 <span class="ot">=</span> ranktest[high_expr <span class="sc">&gt;</span> <span class="dv">200</span> <span class="sc">&amp;</span> high_expr <span class="sc">&lt;</span> <span class="dv">400</span>][<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]<span class="sc">$</span>feats</span>
<span id="cb29-4"><a href="visium-hd.html#cb29-4" tabindex="-1"></a>set4 <span class="ot">=</span> ranktest[high_expr <span class="sc">&gt;</span> <span class="dv">400</span> <span class="sc">&amp;</span> high_expr <span class="sc">&lt;</span> <span class="dv">1000</span>][<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]<span class="sc">$</span>feats</span>
<span id="cb29-5"><a href="visium-hd.html#cb29-5" tabindex="-1"></a>set5 <span class="ot">=</span> ranktest[high_expr <span class="sc">&gt;</span> <span class="dv">1000</span>][<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]<span class="sc">$</span>feats</span>
<span id="cb29-6"><a href="visium-hd.html#cb29-6" tabindex="-1"></a></span>
<span id="cb29-7"><a href="visium-hd.html#cb29-7" tabindex="-1"></a><span class="co"># set 1 and 2</span></span>
<span id="cb29-8"><a href="visium-hd.html#cb29-8" tabindex="-1"></a><span class="fu">spatFeatPlot2D</span>(visiumHD,</span>
<span id="cb29-9"><a href="visium-hd.html#cb29-9" tabindex="-1"></a>               <span class="at">expression_values =</span> <span class="st">&#39;scaled&#39;</span>,</span>
<span id="cb29-10"><a href="visium-hd.html#cb29-10" tabindex="-1"></a>               <span class="at">feats =</span> <span class="fu">c</span>(set1, set2),</span>
<span id="cb29-11"><a href="visium-hd.html#cb29-11" tabindex="-1"></a>               <span class="at">cow_n_col =</span> <span class="dv">2</span>, <span class="at">point_size =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="visium-hd.html#cb30-1" tabindex="-1"></a><span class="co"># set 3 to 5</span></span>
<span id="cb30-2"><a href="visium-hd.html#cb30-2" tabindex="-1"></a><span class="fu">spatFeatPlot2D</span>(visiumHD,</span>
<span id="cb30-3"><a href="visium-hd.html#cb30-3" tabindex="-1"></a>               <span class="at">expression_values =</span> <span class="st">&#39;scaled&#39;</span>,</span>
<span id="cb30-4"><a href="visium-hd.html#cb30-4" tabindex="-1"></a>               <span class="at">feats =</span> <span class="fu">c</span>(set3, set4, set5),</span>
<span id="cb30-5"><a href="visium-hd.html#cb30-5" tabindex="-1"></a>               <span class="at">cow_n_col =</span> <span class="dv">2</span>, <span class="at">point_size =</span> <span class="dv">1</span>)</span></code></pre></div>
</div>
<div id="spatial-co-expression-modules-1" class="section level4 hasAnchor" number="9.7.2.2">
<h4><span class="header-section-number">9.7.2.2</span> Spatial co-expression modules<a href="visium-hd.html#spatial-co-expression-modules-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="visium-hd.html#cb31-1" tabindex="-1"></a>ext_spatial_genes <span class="ot">=</span> ranktest[adj.p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>]<span class="sc">$</span>feats</span>
<span id="cb31-2"><a href="visium-hd.html#cb31-2" tabindex="-1"></a></span>
<span id="cb31-3"><a href="visium-hd.html#cb31-3" tabindex="-1"></a>spat_cor_netw_DT <span class="ot">=</span> <span class="fu">detectSpatialCorFeats</span>(visiumHD,</span>
<span id="cb31-4"><a href="visium-hd.html#cb31-4" tabindex="-1"></a>                                         <span class="at">method =</span> <span class="st">&#39;network&#39;</span>,</span>
<span id="cb31-5"><a href="visium-hd.html#cb31-5" tabindex="-1"></a>                                         <span class="at">spatial_network_name =</span> <span class="st">&#39;kNN_network&#39;</span>,</span>
<span id="cb31-6"><a href="visium-hd.html#cb31-6" tabindex="-1"></a>                                         <span class="at">subset_feats =</span> ext_spatial_genes)</span>
<span id="cb31-7"><a href="visium-hd.html#cb31-7" tabindex="-1"></a></span>
<span id="cb31-8"><a href="visium-hd.html#cb31-8" tabindex="-1"></a><span class="co"># cluster spatial genes</span></span>
<span id="cb31-9"><a href="visium-hd.html#cb31-9" tabindex="-1"></a>spat_cor_netw_DT <span class="ot">=</span> <span class="fu">clusterSpatialCorFeats</span>(spat_cor_netw_DT, <span class="at">name =</span> <span class="st">&#39;spat_netw_clus&#39;</span>, <span class="at">k =</span> <span class="dv">20</span>)</span>
<span id="cb31-10"><a href="visium-hd.html#cb31-10" tabindex="-1"></a></span>
<span id="cb31-11"><a href="visium-hd.html#cb31-11" tabindex="-1"></a><span class="co"># visualize clusters</span></span>
<span id="cb31-12"><a href="visium-hd.html#cb31-12" tabindex="-1"></a><span class="fu">heatmSpatialCorFeats</span>(visiumHD,</span>
<span id="cb31-13"><a href="visium-hd.html#cb31-13" tabindex="-1"></a>                     <span class="at">spatCorObject =</span> spat_cor_netw_DT,</span>
<span id="cb31-14"><a href="visium-hd.html#cb31-14" tabindex="-1"></a>                     <span class="at">use_clus_name =</span> <span class="st">&#39;spat_netw_clus&#39;</span>,</span>
<span id="cb31-15"><a href="visium-hd.html#cb31-15" tabindex="-1"></a>                     <span class="at">heatmap_legend_param =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="cn">NULL</span>))</span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="visium-hd.html#cb32-1" tabindex="-1"></a><span class="co"># create metagene enrichment score for clusters</span></span>
<span id="cb32-2"><a href="visium-hd.html#cb32-2" tabindex="-1"></a>cluster_genes_DT <span class="ot">=</span> <span class="fu">showSpatialCorFeats</span>(spat_cor_netw_DT, </span>
<span id="cb32-3"><a href="visium-hd.html#cb32-3" tabindex="-1"></a>                                       <span class="at">use_clus_name =</span> <span class="st">&#39;spat_netw_clus&#39;</span>, </span>
<span id="cb32-4"><a href="visium-hd.html#cb32-4" tabindex="-1"></a>                                       <span class="at">show_top_feats =</span> <span class="dv">1</span>)</span>
<span id="cb32-5"><a href="visium-hd.html#cb32-5" tabindex="-1"></a>cluster_genes <span class="ot">=</span> cluster_genes_DT<span class="sc">$</span>clus; <span class="fu">names</span>(cluster_genes) <span class="ot">=</span> cluster_genes_DT<span class="sc">$</span>feat_ID</span>
<span id="cb32-6"><a href="visium-hd.html#cb32-6" tabindex="-1"></a></span>
<span id="cb32-7"><a href="visium-hd.html#cb32-7" tabindex="-1"></a>visiumHD <span class="ot">=</span> <span class="fu">createMetafeats</span>(visiumHD,</span>
<span id="cb32-8"><a href="visium-hd.html#cb32-8" tabindex="-1"></a>                           <span class="at">expression_values =</span> <span class="st">&#39;normalized&#39;</span>,</span>
<span id="cb32-9"><a href="visium-hd.html#cb32-9" tabindex="-1"></a>                           <span class="at">feat_clusters =</span> cluster_genes,</span>
<span id="cb32-10"><a href="visium-hd.html#cb32-10" tabindex="-1"></a>                           <span class="at">name =</span> <span class="st">&#39;cluster_metagene&#39;</span>)</span>
<span id="cb32-11"><a href="visium-hd.html#cb32-11" tabindex="-1"></a></span>
<span id="cb32-12"><a href="visium-hd.html#cb32-12" tabindex="-1"></a><span class="fu">spatCellPlot</span>(visiumHD,</span>
<span id="cb32-13"><a href="visium-hd.html#cb32-13" tabindex="-1"></a>             <span class="at">spat_enr_names =</span> <span class="st">&#39;cluster_metagene&#39;</span>,</span>
<span id="cb32-14"><a href="visium-hd.html#cb32-14" tabindex="-1"></a>             <span class="at">cell_annotation_values =</span> <span class="fu">as.character</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)),</span>
<span id="cb32-15"><a href="visium-hd.html#cb32-15" tabindex="-1"></a>             <span class="at">point_size =</span> <span class="dv">1</span>, <span class="at">cow_n_col =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="visium-hd.html#cb33-1" tabindex="-1"></a><span class="fu">spatCellPlot</span>(visiumHD,</span>
<span id="cb33-2"><a href="visium-hd.html#cb33-2" tabindex="-1"></a>             <span class="at">spat_enr_names =</span> <span class="st">&#39;cluster_metagene&#39;</span>,</span>
<span id="cb33-3"><a href="visium-hd.html#cb33-3" tabindex="-1"></a>             <span class="at">cell_annotation_values =</span> <span class="fu">as.character</span>(<span class="fu">c</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>)),</span>
<span id="cb33-4"><a href="visium-hd.html#cb33-4" tabindex="-1"></a>             <span class="at">point_size =</span> <span class="dv">1</span>, <span class="at">cow_n_col =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="visium-hd.html#cb34-1" tabindex="-1"></a><span class="fu">spatCellPlot</span>(visiumHD,</span>
<span id="cb34-2"><a href="visium-hd.html#cb34-2" tabindex="-1"></a>             <span class="at">spat_enr_names =</span> <span class="st">&#39;cluster_metagene&#39;</span>,</span>
<span id="cb34-3"><a href="visium-hd.html#cb34-3" tabindex="-1"></a>             <span class="at">cell_annotation_values =</span> <span class="fu">as.character</span>(<span class="fu">c</span>(<span class="dv">9</span><span class="sc">:</span><span class="dv">10</span>)),</span>
<span id="cb34-4"><a href="visium-hd.html#cb34-4" tabindex="-1"></a>             <span class="at">point_size =</span> <span class="dv">1</span>, <span class="at">cow_n_col =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="visium-hd.html#cb35-1" tabindex="-1"></a>balanced_genes <span class="ot">=</span> <span class="fu">getBalancedSpatCoexpressionFeats</span>(<span class="at">spatCorObject =</span> spat_cor_netw_DT, </span>
<span id="cb35-2"><a href="visium-hd.html#cb35-2" tabindex="-1"></a>                                                  <span class="at">maximum =</span> <span class="dv">5</span>)</span>
<span id="cb35-3"><a href="visium-hd.html#cb35-3" tabindex="-1"></a>selected_feats <span class="ot">=</span> <span class="fu">names</span>(balanced_genes)</span>
<span id="cb35-4"><a href="visium-hd.html#cb35-4" tabindex="-1"></a></span>
<span id="cb35-5"><a href="visium-hd.html#cb35-5" tabindex="-1"></a><span class="co"># give genes from same cluster same color</span></span>
<span id="cb35-6"><a href="visium-hd.html#cb35-6" tabindex="-1"></a>distinct_colors <span class="ot">=</span> <span class="fu">getDistinctColors</span>(<span class="at">n =</span> <span class="dv">20</span>)</span>
<span id="cb35-7"><a href="visium-hd.html#cb35-7" tabindex="-1"></a><span class="fu">names</span>(distinct_colors) <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb35-8"><a href="visium-hd.html#cb35-8" tabindex="-1"></a></span>
<span id="cb35-9"><a href="visium-hd.html#cb35-9" tabindex="-1"></a>my_colors <span class="ot">=</span> distinct_colors[balanced_genes]</span>
<span id="cb35-10"><a href="visium-hd.html#cb35-10" tabindex="-1"></a><span class="fu">names</span>(my_colors) <span class="ot">=</span> <span class="fu">names</span>(balanced_genes)</span>
<span id="cb35-11"><a href="visium-hd.html#cb35-11" tabindex="-1"></a></span>
<span id="cb35-12"><a href="visium-hd.html#cb35-12" tabindex="-1"></a><span class="fu">spatInSituPlotPoints</span>(visiumHD,</span>
<span id="cb35-13"><a href="visium-hd.html#cb35-13" tabindex="-1"></a>                     <span class="at">show_image =</span> F,</span>
<span id="cb35-14"><a href="visium-hd.html#cb35-14" tabindex="-1"></a>                     <span class="at">feats =</span> <span class="fu">list</span>(<span class="st">&#39;rna&#39;</span> <span class="ot">=</span> selected_feats), </span>
<span id="cb35-15"><a href="visium-hd.html#cb35-15" tabindex="-1"></a>                     <span class="at">feats_color_code =</span> my_colors,</span>
<span id="cb35-16"><a href="visium-hd.html#cb35-16" tabindex="-1"></a>                     <span class="at">show_legend =</span> F,</span>
<span id="cb35-17"><a href="visium-hd.html#cb35-17" tabindex="-1"></a>                     <span class="at">spat_unit =</span> <span class="st">&#39;hex100&#39;</span>,</span>
<span id="cb35-18"><a href="visium-hd.html#cb35-18" tabindex="-1"></a>                     <span class="at">point_size =</span> <span class="fl">0.20</span>,</span>
<span id="cb35-19"><a href="visium-hd.html#cb35-19" tabindex="-1"></a>                     <span class="at">show_polygon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb35-20"><a href="visium-hd.html#cb35-20" tabindex="-1"></a>                     <span class="at">use_overlap =</span> <span class="cn">FALSE</span>,</span>
<span id="cb35-21"><a href="visium-hd.html#cb35-21" tabindex="-1"></a>                     <span class="at">polygon_feat_type =</span> <span class="st">&#39;hex100&#39;</span>,</span>
<span id="cb35-22"><a href="visium-hd.html#cb35-22" tabindex="-1"></a>                     <span class="at">polygon_bg_color =</span> <span class="cn">NA</span>,</span>
<span id="cb35-23"><a href="visium-hd.html#cb35-23" tabindex="-1"></a>                     <span class="at">polygon_color =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb35-24"><a href="visium-hd.html#cb35-24" tabindex="-1"></a>                     <span class="at">polygon_line_size =</span> <span class="fl">0.05</span>,</span>
<span id="cb35-25"><a href="visium-hd.html#cb35-25" tabindex="-1"></a>                     <span class="at">jitter =</span> <span class="fu">c</span>(<span class="dv">25</span>,<span class="dv">25</span>))</span></code></pre></div>
</div>
</div>
</div>
<div id="hexbin-25" class="section level2 hasAnchor" number="9.8">
<h2><span class="header-section-number">9.8</span> Hexbin 25<a href="visium-hd.html#hexbin-25" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="subcellular-workflow-and-projection-functions" class="section level3 hasAnchor" number="9.8.1">
<h3><span class="header-section-number">9.8.1</span> Subcellular workflow and projection functions<a href="visium-hd.html#subcellular-workflow-and-projection-functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>filter and normalization workflow</li>
<li>PCA projection</li>
</ul>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="visium-hd.html#cb36-1" tabindex="-1"></a>visiumHD_subset <span class="ot">=</span> <span class="fu">subsetGiottoLocs</span>(<span class="at">gobject =</span> visiumHD,</span>
<span id="cb36-2"><a href="visium-hd.html#cb36-2" tabindex="-1"></a>                                   <span class="at">x_min =</span> <span class="dv">16000</span>, </span>
<span id="cb36-3"><a href="visium-hd.html#cb36-3" tabindex="-1"></a>                                   <span class="at">x_max =</span> <span class="dv">20000</span>, </span>
<span id="cb36-4"><a href="visium-hd.html#cb36-4" tabindex="-1"></a>                                   <span class="at">y_min =</span> <span class="dv">44250</span>,</span>
<span id="cb36-5"><a href="visium-hd.html#cb36-5" tabindex="-1"></a>                                   <span class="at">y_max =</span> <span class="dv">45500</span>)</span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="visium-hd.html#cb37-1" tabindex="-1"></a>hexbin25 <span class="ot">&lt;-</span> <span class="fu">tessellate</span>(<span class="at">extent =</span> <span class="fu">ext</span>(visiumHD_subset<span class="sc">@</span>feat_info<span class="sc">$</span>rna), </span>
<span id="cb37-2"><a href="visium-hd.html#cb37-2" tabindex="-1"></a>                       <span class="at">shape =</span> <span class="st">&#39;hexagon&#39;</span>, </span>
<span id="cb37-3"><a href="visium-hd.html#cb37-3" tabindex="-1"></a>                       <span class="at">shape_size =</span> <span class="dv">25</span>, </span>
<span id="cb37-4"><a href="visium-hd.html#cb37-4" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">&#39;hex25&#39;</span>) </span>
<span id="cb37-5"><a href="visium-hd.html#cb37-5" tabindex="-1"></a></span>
<span id="cb37-6"><a href="visium-hd.html#cb37-6" tabindex="-1"></a>visiumHD_subset <span class="ot">=</span> <span class="fu">setPolygonInfo</span>(<span class="at">gobject =</span> visiumHD_subset,</span>
<span id="cb37-7"><a href="visium-hd.html#cb37-7" tabindex="-1"></a>                                 <span class="at">x =</span> hexbin25,</span>
<span id="cb37-8"><a href="visium-hd.html#cb37-8" tabindex="-1"></a>                                 <span class="at">name =</span> <span class="st">&#39;hex25&#39;</span>,</span>
<span id="cb37-9"><a href="visium-hd.html#cb37-9" tabindex="-1"></a>                                 <span class="at">initialize =</span> T)</span>
<span id="cb37-10"><a href="visium-hd.html#cb37-10" tabindex="-1"></a></span>
<span id="cb37-11"><a href="visium-hd.html#cb37-11" tabindex="-1"></a>visiumHD_subset <span class="ot">=</span> <span class="fu">addSpatialCentroidLocations</span>(<span class="at">gobject =</span> visiumHD_subset,</span>
<span id="cb37-12"><a href="visium-hd.html#cb37-12" tabindex="-1"></a>                                              <span class="at">poly_info =</span> <span class="st">&#39;hex25&#39;</span>)</span>
<span id="cb37-13"><a href="visium-hd.html#cb37-13" tabindex="-1"></a></span>
<span id="cb37-14"><a href="visium-hd.html#cb37-14" tabindex="-1"></a><span class="fu">activeSpatUnit</span>(visiumHD_subset) <span class="ot">&lt;-</span> <span class="st">&#39;hex25&#39;</span></span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="visium-hd.html#cb38-1" tabindex="-1"></a>visiumHD_subset <span class="ot">=</span> <span class="fu">calculateOverlap</span>(visiumHD_subset,</span>
<span id="cb38-2"><a href="visium-hd.html#cb38-2" tabindex="-1"></a>                                   <span class="at">spatial_info =</span> <span class="st">&#39;hex25&#39;</span>,</span>
<span id="cb38-3"><a href="visium-hd.html#cb38-3" tabindex="-1"></a>                                   <span class="at">feat_info =</span> <span class="st">&#39;rna&#39;</span>)</span>
<span id="cb38-4"><a href="visium-hd.html#cb38-4" tabindex="-1"></a></span>
<span id="cb38-5"><a href="visium-hd.html#cb38-5" tabindex="-1"></a><span class="co"># convert overlap results to bin by gene matrix</span></span>
<span id="cb38-6"><a href="visium-hd.html#cb38-6" tabindex="-1"></a>visiumHD_subset <span class="ot">=</span> <span class="fu">overlapToMatrix</span>(visiumHD_subset,</span>
<span id="cb38-7"><a href="visium-hd.html#cb38-7" tabindex="-1"></a>                                  <span class="at">poly_info =</span> <span class="st">&#39;hex25&#39;</span>,</span>
<span id="cb38-8"><a href="visium-hd.html#cb38-8" tabindex="-1"></a>                                  <span class="at">feat_info =</span> <span class="st">&#39;rna&#39;</span>,</span>
<span id="cb38-9"><a href="visium-hd.html#cb38-9" tabindex="-1"></a>                                  <span class="at">name =</span> <span class="st">&#39;raw&#39;</span>)</span>
<span id="cb38-10"><a href="visium-hd.html#cb38-10" tabindex="-1"></a></span>
<span id="cb38-11"><a href="visium-hd.html#cb38-11" tabindex="-1"></a>visiumHD_subset <span class="ot">&lt;-</span> <span class="fu">filterGiotto</span>(visiumHD_subset,</span>
<span id="cb38-12"><a href="visium-hd.html#cb38-12" tabindex="-1"></a>                                <span class="at">expression_threshold =</span> <span class="dv">1</span>,</span>
<span id="cb38-13"><a href="visium-hd.html#cb38-13" tabindex="-1"></a>                                <span class="at">feat_det_in_min_cells =</span> <span class="dv">25</span>,</span>
<span id="cb38-14"><a href="visium-hd.html#cb38-14" tabindex="-1"></a>                                <span class="at">min_det_feats_per_cell =</span> <span class="dv">25</span>)</span>
<span id="cb38-15"><a href="visium-hd.html#cb38-15" tabindex="-1"></a></span>
<span id="cb38-16"><a href="visium-hd.html#cb38-16" tabindex="-1"></a><span class="co"># normalize</span></span>
<span id="cb38-17"><a href="visium-hd.html#cb38-17" tabindex="-1"></a>visiumHD_subset <span class="ot">&lt;-</span> <span class="fu">normalizeGiotto</span>(visiumHD_subset, <span class="at">scalefactor =</span> <span class="dv">1000</span>, <span class="at">verbose =</span> T)</span>
<span id="cb38-18"><a href="visium-hd.html#cb38-18" tabindex="-1"></a></span>
<span id="cb38-19"><a href="visium-hd.html#cb38-19" tabindex="-1"></a><span class="co"># add statistics</span></span>
<span id="cb38-20"><a href="visium-hd.html#cb38-20" tabindex="-1"></a>visiumHD_subset <span class="ot">&lt;-</span> <span class="fu">addStatistics</span>(visiumHD_subset)</span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="visium-part-ii.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="xenium-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
