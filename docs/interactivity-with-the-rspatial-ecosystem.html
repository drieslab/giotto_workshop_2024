<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>16 Interactivity with the R/Spatial ecosystem | Workshop: Spatial multi-omics data analysis with Giotto Suite</title>
  <meta name="description" content="16 Interactivity with the R/Spatial ecosystem | Workshop: Spatial multi-omics data analysis with Giotto Suite" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="16 Interactivity with the R/Spatial ecosystem | Workshop: Spatial multi-omics data analysis with Giotto Suite" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="drieslab/giotto_workshop_2024" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="16 Interactivity with the R/Spatial ecosystem | Workshop: Spatial multi-omics data analysis with Giotto Suite" />
  
  
  

<meta name="author" content="Ruben Dries, Jiaji George Chen, Joselyn Cristina Chávez-Fuentes, Junxiang Xu ,Edward Ruiz, Jeff Sheridan, Iqra Amin, Wen Wang" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="interoperability-with-isolated-tools.html"/>
<link rel="next" href="contributing-to-giotto.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Giotto Suite Workshop 2024</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#instructors"><i class="fa fa-check"></i><b>1.1</b> Instructors</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#topics-and-schedule"><i class="fa fa-check"></i><b>1.2</b> Topics and Schedule:</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i><b>1.3</b> License</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="spatial-omics-technologies.html"><a href="spatial-omics-technologies.html"><i class="fa fa-check"></i><b>2</b> Spatial omics technologies</a>
<ul>
<li class="chapter" data-level="2.1" data-path="spatial-omics-technologies.html"><a href="spatial-omics-technologies.html#presentation"><i class="fa fa-check"></i><b>2.1</b> Presentation</a></li>
<li class="chapter" data-level="2.2" data-path="spatial-omics-technologies.html"><a href="spatial-omics-technologies.html#short-summary"><i class="fa fa-check"></i><b>2.2</b> Short summary</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="spatial-omics-technologies.html"><a href="spatial-omics-technologies.html#why-do-we-need-spatial-omics-technologies"><i class="fa fa-check"></i><b>2.2.1</b> Why do we need spatial omics technologies?</a></li>
<li class="chapter" data-level="2.2.2" data-path="spatial-omics-technologies.html"><a href="spatial-omics-technologies.html#what-is-spatial-omics"><i class="fa fa-check"></i><b>2.2.2</b> What is spatial omics?</a></li>
<li class="chapter" data-level="2.2.3" data-path="spatial-omics-technologies.html"><a href="spatial-omics-technologies.html#what-are-the-main-spatial-omics-technologies"><i class="fa fa-check"></i><b>2.2.3</b> What are the main spatial omics technologies?</a></li>
<li class="chapter" data-level="2.2.4" data-path="spatial-omics-technologies.html"><a href="spatial-omics-technologies.html#other-spatial-omics-atac-seq-cuttag-lipidomics-etc"><i class="fa fa-check"></i><b>2.2.4</b> Other Spatial omics: ATAC-seq, CUT&amp;Tag, lipidomics, etc</a></li>
<li class="chapter" data-level="2.2.5" data-path="spatial-omics-technologies.html"><a href="spatial-omics-technologies.html#what-are-the-different-types-of-spatial-downstream-analyses"><i class="fa fa-check"></i><b>2.2.5</b> What are the different types of spatial downstream analyses?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction-to-the-giotto-package.html"><a href="introduction-to-the-giotto-package.html"><i class="fa fa-check"></i><b>3</b> Introduction to the Giotto package</a>
<ul>
<li class="chapter" data-level="3.1" data-path="introduction-to-the-giotto-package.html"><a href="introduction-to-the-giotto-package.html#presentation-1"><i class="fa fa-check"></i><b>3.1</b> Presentation</a></li>
<li class="chapter" data-level="3.2" data-path="introduction-to-the-giotto-package.html"><a href="introduction-to-the-giotto-package.html#ecosystem"><i class="fa fa-check"></i><b>3.2</b> Ecosystem</a></li>
<li class="chapter" data-level="3.3" data-path="introduction-to-the-giotto-package.html"><a href="introduction-to-the-giotto-package.html#installation-python-environment"><i class="fa fa-check"></i><b>3.3</b> Installation + python environment</a></li>
<li class="chapter" data-level="3.4" data-path="introduction-to-the-giotto-package.html"><a href="introduction-to-the-giotto-package.html#giotto-instructions"><i class="fa fa-check"></i><b>3.4</b> Giotto instructions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-formatting-and-pre-processing.html"><a href="data-formatting-and-pre-processing.html"><i class="fa fa-check"></i><b>4</b> Data formatting and Pre-processing</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-formatting-and-pre-processing.html"><a href="data-formatting-and-pre-processing.html#data-formats"><i class="fa fa-check"></i><b>4.1</b> Data formats</a></li>
<li class="chapter" data-level="4.2" data-path="data-formatting-and-pre-processing.html"><a href="data-formatting-and-pre-processing.html#pre-processing"><i class="fa fa-check"></i><b>4.2</b> Pre-processing</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="creating-a-giotto-object.html"><a href="creating-a-giotto-object.html"><i class="fa fa-check"></i><b>5</b> Creating a Giotto object</a>
<ul>
<li class="chapter" data-level="5.0.1" data-path="creating-a-giotto-object.html"><a href="creating-a-giotto-object.html#used-packages"><i class="fa fa-check"></i><b>5.0.1</b> Used packages</a></li>
<li class="chapter" data-level="5.1" data-path="creating-a-giotto-object.html"><a href="creating-a-giotto-object.html#overview"><i class="fa fa-check"></i><b>5.1</b> Overview</a></li>
<li class="chapter" data-level="5.2" data-path="creating-a-giotto-object.html"><a href="creating-a-giotto-object.html#from-matrix-locations"><i class="fa fa-check"></i><b>5.2</b> From matrix + locations</a></li>
<li class="chapter" data-level="5.3" data-path="creating-a-giotto-object.html"><a href="creating-a-giotto-object.html#from-subcellular-raw-data-transcripts-or-images-polygons"><i class="fa fa-check"></i><b>5.3</b> From subcellular raw data (transcripts or images) + polygons</a></li>
<li class="chapter" data-level="5.4" data-path="creating-a-giotto-object.html"><a href="creating-a-giotto-object.html#from-piece-wise"><i class="fa fa-check"></i><b>5.4</b> From piece-wise</a></li>
<li class="chapter" data-level="5.5" data-path="creating-a-giotto-object.html"><a href="creating-a-giotto-object.html#using-convenience-functions-for-popular-technologies-vizgen-xenium-cosmx"><i class="fa fa-check"></i><b>5.5</b> Using convenience functions for popular technologies (Vizgen, Xenium, CosMx, …)</a></li>
<li class="chapter" data-level="5.6" data-path="creating-a-giotto-object.html"><a href="creating-a-giotto-object.html#spatial-plots"><i class="fa fa-check"></i><b>5.6</b> Spatial plots</a></li>
<li class="chapter" data-level="5.7" data-path="creating-a-giotto-object.html"><a href="creating-a-giotto-object.html#subsetting"><i class="fa fa-check"></i><b>5.7</b> Subsetting</a></li>
<li class="chapter" data-level="5.8" data-path="creating-a-giotto-object.html"><a href="creating-a-giotto-object.html#mini-objects-giottodata"><i class="fa fa-check"></i><b>5.8</b> Mini objects &amp; GiottoData</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="visium-part-i.html"><a href="visium-part-i.html"><i class="fa fa-check"></i><b>6</b> Visium Part I</a>
<ul>
<li class="chapter" data-level="6.1" data-path="visium-part-i.html"><a href="visium-part-i.html#introduction-to-the-spatial-dataset"><i class="fa fa-check"></i><b>6.1</b> Introduction to the spatial dataset</a></li>
<li class="chapter" data-level="6.2" data-path="visium-part-i.html"><a href="visium-part-i.html#download-dataset"><i class="fa fa-check"></i><b>6.2</b> Download dataset</a></li>
<li class="chapter" data-level="6.3" data-path="visium-part-i.html"><a href="visium-part-i.html#create-the-giotto-object"><i class="fa fa-check"></i><b>6.3</b> Create the Giotto object</a></li>
<li class="chapter" data-level="6.4" data-path="visium-part-i.html"><a href="visium-part-i.html#subset-on-spots-that-were-covered-by-tissue"><i class="fa fa-check"></i><b>6.4</b> Subset on spots that were covered by tissue</a></li>
<li class="chapter" data-level="6.5" data-path="visium-part-i.html"><a href="visium-part-i.html#quality-control"><i class="fa fa-check"></i><b>6.5</b> Quality control</a></li>
<li class="chapter" data-level="6.6" data-path="visium-part-i.html"><a href="visium-part-i.html#filtering"><i class="fa fa-check"></i><b>6.6</b> Filtering</a></li>
<li class="chapter" data-level="6.7" data-path="visium-part-i.html"><a href="visium-part-i.html#normalization"><i class="fa fa-check"></i><b>6.7</b> Normalization</a></li>
<li class="chapter" data-level="6.8" data-path="visium-part-i.html"><a href="visium-part-i.html#feature-selection"><i class="fa fa-check"></i><b>6.8</b> Feature selection</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="visium-part-i.html"><a href="visium-part-i.html#highly-variable-features"><i class="fa fa-check"></i><b>6.8.1</b> Highly Variable Features:</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="visium-part-i.html"><a href="visium-part-i.html#dimension-reduction"><i class="fa fa-check"></i><b>6.9</b> Dimension Reduction</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="visium-part-i.html"><a href="visium-part-i.html#pca"><i class="fa fa-check"></i><b>6.9.1</b> PCA</a></li>
<li class="chapter" data-level="6.9.2" data-path="visium-part-i.html"><a href="visium-part-i.html#umap"><i class="fa fa-check"></i><b>6.9.2</b> UMAP</a></li>
<li class="chapter" data-level="6.9.3" data-path="visium-part-i.html"><a href="visium-part-i.html#t-sne"><i class="fa fa-check"></i><b>6.9.3</b> t-SNE</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="visium-part-i.html"><a href="visium-part-i.html#clustering"><i class="fa fa-check"></i><b>6.10</b> Clustering</a>
<ul>
<li class="chapter" data-level="6.10.1" data-path="visium-part-i.html"><a href="visium-part-i.html#calculate-leiden-clustering"><i class="fa fa-check"></i><b>6.10.1</b> Calculate Leiden clustering</a></li>
<li class="chapter" data-level="6.10.2" data-path="visium-part-i.html"><a href="visium-part-i.html#calculate-louvain-clustering"><i class="fa fa-check"></i><b>6.10.2</b> Calculate Louvain clustering</a></li>
</ul></li>
<li class="chapter" data-level="6.11" data-path="visium-part-i.html"><a href="visium-part-i.html#save-the-object"><i class="fa fa-check"></i><b>6.11</b> Save the object</a></li>
<li class="chapter" data-level="6.12" data-path="visium-part-i.html"><a href="visium-part-i.html#session-info"><i class="fa fa-check"></i><b>6.12</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="visium-part-ii.html"><a href="visium-part-ii.html"><i class="fa fa-check"></i><b>7</b> Visium Part II</a>
<ul>
<li class="chapter" data-level="7.1" data-path="visium-part-ii.html"><a href="visium-part-ii.html#load-the-object"><i class="fa fa-check"></i><b>7.1</b> Load the object</a></li>
<li class="chapter" data-level="7.2" data-path="visium-part-ii.html"><a href="visium-part-ii.html#differential-expression"><i class="fa fa-check"></i><b>7.2</b> Differential expression</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="visium-part-ii.html"><a href="visium-part-ii.html#gini-markers"><i class="fa fa-check"></i><b>7.2.1</b> Gini markers</a></li>
<li class="chapter" data-level="7.2.2" data-path="visium-part-ii.html"><a href="visium-part-ii.html#scran-markers"><i class="fa fa-check"></i><b>7.2.2</b> Scran markers</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="visium-part-ii.html"><a href="visium-part-ii.html#enrichment-deconvolution"><i class="fa fa-check"></i><b>7.3</b> Enrichment &amp; Deconvolution</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="visium-part-ii.html"><a href="visium-part-ii.html#pagerank"><i class="fa fa-check"></i><b>7.3.1</b> PAGE/Rank</a></li>
<li class="chapter" data-level="7.3.2" data-path="visium-part-ii.html"><a href="visium-part-ii.html#spatialdwls"><i class="fa fa-check"></i><b>7.3.2</b> SpatialDWLS</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="visium-part-ii.html"><a href="visium-part-ii.html#spatial-expression-patterns"><i class="fa fa-check"></i><b>7.4</b> Spatial expression patterns</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="visium-part-ii.html"><a href="visium-part-ii.html#spatial-variable-genes"><i class="fa fa-check"></i><b>7.4.1</b> Spatial variable genes</a></li>
<li class="chapter" data-level="7.4.2" data-path="visium-part-ii.html"><a href="visium-part-ii.html#spatial-co-expression-modules"><i class="fa fa-check"></i><b>7.4.2</b> Spatial co-expression modules</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="visium-part-ii.html"><a href="visium-part-ii.html#spatially-informed-clusters"><i class="fa fa-check"></i><b>7.5</b> Spatially informed clusters</a></li>
<li class="chapter" data-level="7.6" data-path="visium-part-ii.html"><a href="visium-part-ii.html#spatial-domains-hmrf"><i class="fa fa-check"></i><b>7.6</b> Spatial domains HMRF</a></li>
<li class="chapter" data-level="7.7" data-path="visium-part-ii.html"><a href="visium-part-ii.html#interactive-tools"><i class="fa fa-check"></i><b>7.7</b> Interactive tools</a></li>
<li class="chapter" data-level="7.8" data-path="visium-part-ii.html"><a href="visium-part-ii.html#session-info-1"><i class="fa fa-check"></i><b>7.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="visium-hd.html"><a href="visium-hd.html"><i class="fa fa-check"></i><b>8</b> Visium HD</a>
<ul>
<li class="chapter" data-level="8.1" data-path="visium-hd.html"><a href="visium-hd.html#objective"><i class="fa fa-check"></i><b>8.1</b> Objective</a></li>
<li class="chapter" data-level="8.2" data-path="visium-hd.html"><a href="visium-hd.html#background"><i class="fa fa-check"></i><b>8.2</b> Background</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="visium-hd.html"><a href="visium-hd.html#visium-hd-technology"><i class="fa fa-check"></i><b>8.2.1</b> Visium HD Technology</a></li>
<li class="chapter" data-level="8.2.2" data-path="visium-hd.html"><a href="visium-hd.html#colorectal-cancer-sample"><i class="fa fa-check"></i><b>8.2.2</b> Colorectal Cancer Sample</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="visium-hd.html"><a href="visium-hd.html#data-ingestion"><i class="fa fa-check"></i><b>8.3</b> Data Ingestion</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="visium-hd.html"><a href="visium-hd.html#visium-hd-output-data-format"><i class="fa fa-check"></i><b>8.3.1</b> Visium HD output data format</a></li>
<li class="chapter" data-level="8.3.2" data-path="visium-hd.html"><a href="visium-hd.html#read-in-raw-data"><i class="fa fa-check"></i><b>8.3.2</b> Read in raw data</a></li>
<li class="chapter" data-level="8.3.3" data-path="visium-hd.html"><a href="visium-hd.html#giotto-visium-hd-convenience-function"><i class="fa fa-check"></i><b>8.3.3</b> Giotto Visium HD convenience function</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="visium-hd.html"><a href="visium-hd.html#tiling-and-aggregation"><i class="fa fa-check"></i><b>8.4</b> Tiling and aggregation</a></li>
<li class="chapter" data-level="8.5" data-path="visium-hd.html"><a href="visium-hd.html#scalability-and-projection-functions"><i class="fa fa-check"></i><b>8.5</b> Scalability and projection functions</a></li>
<li class="chapter" data-level="8.6" data-path="visium-hd.html"><a href="visium-hd.html#spatial-expression-patterns-1"><i class="fa fa-check"></i><b>8.6</b> Spatial expression patterns</a></li>
<li class="chapter" data-level="8.7" data-path="visium-hd.html"><a href="visium-hd.html#spatial-co-expression-modules-1"><i class="fa fa-check"></i><b>8.7</b> Spatial co-expression modules</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="xenium.html"><a href="xenium.html"><i class="fa fa-check"></i><b>9</b> Xenium</a>
<ul>
<li class="chapter" data-level="9.1" data-path="xenium.html"><a href="xenium.html#introduction-to-spatial-dataset"><i class="fa fa-check"></i><b>9.1</b> Introduction to spatial dataset</a></li>
<li class="chapter" data-level="9.2" data-path="xenium.html"><a href="xenium.html#additional-package-requirements"><i class="fa fa-check"></i><b>9.2</b> Additional package requirements</a></li>
<li class="chapter" data-level="9.3" data-path="xenium.html"><a href="xenium.html#introduce-mini-object"><i class="fa fa-check"></i><b>9.3</b> Introduce mini object</a></li>
<li class="chapter" data-level="9.4" data-path="xenium.html"><a href="xenium.html#read-in-raw-data-1"><i class="fa fa-check"></i><b>9.4</b> Read in raw data</a></li>
<li class="chapter" data-level="9.5" data-path="xenium.html"><a href="xenium.html#overlap-txs-polygons"><i class="fa fa-check"></i><b>9.5</b> Overlap txs &amp; polygons</a></li>
<li class="chapter" data-level="9.6" data-path="xenium.html"><a href="xenium.html#transcript-enrichment-gsea"><i class="fa fa-check"></i><b>9.6</b> Transcript enrichment GSEA</a></li>
<li class="chapter" data-level="9.7" data-path="xenium.html"><a href="xenium.html#spatial-location-analysis"><i class="fa fa-check"></i><b>9.7</b> Spatial location analysis</a></li>
<li class="chapter" data-level="9.8" data-path="xenium.html"><a href="xenium.html#visualizations"><i class="fa fa-check"></i><b>9.8</b> Visualizations</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="spatial-proteomics-multiplex-if.html"><a href="spatial-proteomics-multiplex-if.html"><i class="fa fa-check"></i><b>10</b> Spatial proteomics: multiplex IF</a>
<ul>
<li class="chapter" data-level="10.1" data-path="spatial-proteomics-multiplex-if.html"><a href="spatial-proteomics-multiplex-if.html#read-in-raw-data-2"><i class="fa fa-check"></i><b>10.1</b> Read in raw data</a></li>
<li class="chapter" data-level="10.2" data-path="spatial-proteomics-multiplex-if.html"><a href="spatial-proteomics-multiplex-if.html#overlap-intensity-workflows"><i class="fa fa-check"></i><b>10.2</b> Overlap intensity &amp; workflows</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html"><i class="fa fa-check"></i><b>11</b> Working with multiple samples</a>
<ul>
<li class="chapter" data-level="11.1" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#objective-1"><i class="fa fa-check"></i><b>11.1</b> Objective</a></li>
<li class="chapter" data-level="11.2" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#background-1"><i class="fa fa-check"></i><b>11.2</b> Background</a></li>
<li class="chapter" data-level="11.3" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#create-individual-giotto-objects"><i class="fa fa-check"></i><b>11.3</b> Create individual giotto objects</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#download-the-data"><i class="fa fa-check"></i><b>11.3.1</b> Download the data</a></li>
<li class="chapter" data-level="11.3.2" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#create-giotto-instructions"><i class="fa fa-check"></i><b>11.3.2</b> create giotto instructions</a></li>
<li class="chapter" data-level="11.3.3" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#load-visium-data-into-giotto"><i class="fa fa-check"></i><b>11.3.3</b> load visium data into Giotto</a></li>
<li class="chapter" data-level="11.3.4" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#healthy-prostate-tissue-coverage"><i class="fa fa-check"></i><b>11.3.4</b> Healthy prostate tissue coverage</a></li>
<li class="chapter" data-level="11.3.5" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#adenocarcinoma-prostate-tissue-coverage"><i class="fa fa-check"></i><b>11.3.5</b> Adenocarcinoma prostate tissue coverage</a></li>
<li class="chapter" data-level="11.3.6" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#showing-the-data-strucutre-for-the-inidividual-objects"><i class="fa fa-check"></i><b>11.3.6</b> Showing the data strucutre for the inidividual objects</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#join-giotto-objects"><i class="fa fa-check"></i><b>11.4</b> Join Giotto Objects</a></li>
<li class="chapter" data-level="11.5" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#visualizing-combined-datasets"><i class="fa fa-check"></i><b>11.5</b> Visualizing combined datasets</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#vizualizing-in-the-same-plot"><i class="fa fa-check"></i><b>11.5.1</b> Vizualizing in the same plot</a></li>
<li class="chapter" data-level="11.5.2" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#vizualizing-on-separate-plots"><i class="fa fa-check"></i><b>11.5.2</b> Vizualizing on separate plots</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#splitting-combined-dataset"><i class="fa fa-check"></i><b>11.6</b> Splitting combined dataset</a></li>
<li class="chapter" data-level="11.7" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#analyzing-joined-objects"><i class="fa fa-check"></i><b>11.7</b> Analyzing joined objects</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#normalization-and-adding-statistics"><i class="fa fa-check"></i><b>11.7.1</b> Normalization and adding statistics</a></li>
<li class="chapter" data-level="11.7.2" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#clustering-the-datasets"><i class="fa fa-check"></i><b>11.7.2</b> Clustering the datasets</a></li>
<li class="chapter" data-level="11.7.3" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#vizualizing-spatial-location-of-clusters"><i class="fa fa-check"></i><b>11.7.3</b> Vizualizing spatial location of clusters</a></li>
<li class="chapter" data-level="11.7.4" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#vizualizing-tissue-contribution-to-clusters"><i class="fa fa-check"></i><b>11.7.4</b> Vizualizing tissue contribution to clusters</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#perform-harmony-and-default-workflows"><i class="fa fa-check"></i><b>11.8</b> Perform Harmony and default workflows</a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#clustering-harmonized-object"><i class="fa fa-check"></i><b>11.8.1</b> Clustering harmonized object</a></li>
<li class="chapter" data-level="11.8.2" data-path="working-with-multiple-samples.html"><a href="working-with-multiple-samples.html#vizualizing-the-tissue-contribution"><i class="fa fa-check"></i><b>11.8.2</b> Vizualizing the tissue contribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="spatial-multi-modal-analysis.html"><a href="spatial-multi-modal-analysis.html"><i class="fa fa-check"></i><b>12</b> Spatial multi-modal analysis</a>
<ul>
<li class="chapter" data-level="12.1" data-path="spatial-multi-modal-analysis.html"><a href="spatial-multi-modal-analysis.html#overview-1"><i class="fa fa-check"></i><b>12.1</b> Overview</a></li>
<li class="chapter" data-level="12.2" data-path="spatial-multi-modal-analysis.html"><a href="spatial-multi-modal-analysis.html#spatial-manipulation"><i class="fa fa-check"></i><b>12.2</b> Spatial manipulation</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="spatial-multi-modal-analysis.html"><a href="spatial-multi-modal-analysis.html#spatial-transforms"><i class="fa fa-check"></i><b>12.2.1</b> Spatial transforms:</a></li>
<li class="chapter" data-level="12.2.2" data-path="spatial-multi-modal-analysis.html"><a href="spatial-multi-modal-analysis.html#spatial-utilities"><i class="fa fa-check"></i><b>12.2.2</b> Spatial utilities:</a></li>
<li class="chapter" data-level="12.2.3" data-path="spatial-multi-modal-analysis.html"><a href="spatial-multi-modal-analysis.html#spatial-classes"><i class="fa fa-check"></i><b>12.2.3</b> Spatial classes:</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="spatial-multi-modal-analysis.html"><a href="spatial-multi-modal-analysis.html#image-transforms"><i class="fa fa-check"></i><b>12.3</b> Image transforms</a></li>
<li class="chapter" data-level="12.4" data-path="spatial-multi-modal-analysis.html"><a href="spatial-multi-modal-analysis.html#co-registration-of-datasets"><i class="fa fa-check"></i><b>12.4</b> Co-registration of datasets</a></li>
<li class="chapter" data-level="12.5" data-path="spatial-multi-modal-analysis.html"><a href="spatial-multi-modal-analysis.html#examples-in-giotto-suite-manuscript"><i class="fa fa-check"></i><b>12.5</b> Examples in giotto suite manuscript</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="multi-omics-integration.html"><a href="multi-omics-integration.html"><i class="fa fa-check"></i><b>13</b> Multi-omics integration</a>
<ul>
<li class="chapter" data-level="13.1" data-path="multi-omics-integration.html"><a href="multi-omics-integration.html#introduction-to-the-spatial-dataset-1"><i class="fa fa-check"></i><b>13.1</b> Introduction to the spatial dataset</a></li>
<li class="chapter" data-level="13.2" data-path="multi-omics-integration.html"><a href="multi-omics-integration.html#download-dataset-1"><i class="fa fa-check"></i><b>13.2</b> Download dataset</a></li>
<li class="chapter" data-level="13.3" data-path="multi-omics-integration.html"><a href="multi-omics-integration.html#create-the-giotto-object-1"><i class="fa fa-check"></i><b>13.3</b> Create the Giotto object</a></li>
<li class="chapter" data-level="13.4" data-path="multi-omics-integration.html"><a href="multi-omics-integration.html#subset-on-spots-that-were-covered-by-tissue-1"><i class="fa fa-check"></i><b>13.4</b> Subset on spots that were covered by tissue</a></li>
<li class="chapter" data-level="13.5" data-path="multi-omics-integration.html"><a href="multi-omics-integration.html#rna-processing"><i class="fa fa-check"></i><b>13.5</b> RNA processing</a></li>
<li class="chapter" data-level="13.6" data-path="multi-omics-integration.html"><a href="multi-omics-integration.html#protein-processing"><i class="fa fa-check"></i><b>13.6</b> Protein processing</a></li>
<li class="chapter" data-level="13.7" data-path="multi-omics-integration.html"><a href="multi-omics-integration.html#multi-omics-integration-1"><i class="fa fa-check"></i><b>13.7</b> Multi-omics integration</a></li>
<li class="chapter" data-level="13.8" data-path="multi-omics-integration.html"><a href="multi-omics-integration.html#session-info-2"><i class="fa fa-check"></i><b>13.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="interoperability-with-other-frameworks.html"><a href="interoperability-with-other-frameworks.html"><i class="fa fa-check"></i><b>14</b> Interoperability with other frameworks</a>
<ul>
<li class="chapter" data-level="14.1" data-path="interoperability-with-other-frameworks.html"><a href="interoperability-with-other-frameworks.html#load-giotto-object"><i class="fa fa-check"></i><b>14.1</b> Load Giotto object</a></li>
<li class="chapter" data-level="14.2" data-path="interoperability-with-other-frameworks.html"><a href="interoperability-with-other-frameworks.html#spatialexperiment"><i class="fa fa-check"></i><b>14.2</b> SpatialExperiment</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="interoperability-with-other-frameworks.html"><a href="interoperability-with-other-frameworks.html#convert-giotto-object-to-spatialexperiment-object"><i class="fa fa-check"></i><b>14.2.1</b> Convert Giotto Object to SpatialExperiment Object</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="interoperability-with-other-frameworks.html"><a href="interoperability-with-other-frameworks.html#identify-top-spatially-variable-genes-with-nnsvg"><i class="fa fa-check"></i><b>14.3</b> Identify top spatially variable genes with nnSVG</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="interoperability-with-other-frameworks.html"><a href="interoperability-with-other-frameworks.html#conversion-of-spatialexperiment-object-back-to-giotto"><i class="fa fa-check"></i><b>14.3.1</b> Conversion of SpatialExperiment object back to Giotto</a></li>
<li class="chapter" data-level="14.3.2" data-path="interoperability-with-other-frameworks.html"><a href="interoperability-with-other-frameworks.html#plotting-top-genes-from-nnsvg-in-giotto"><i class="fa fa-check"></i><b>14.3.2</b> Plotting top genes from nnSVG in Giotto</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="interoperability-with-other-frameworks.html"><a href="interoperability-with-other-frameworks.html#seurat"><i class="fa fa-check"></i><b>14.4</b> Seurat</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="interoperability-with-other-frameworks.html"><a href="interoperability-with-other-frameworks.html#giotto-to-seurat"><i class="fa fa-check"></i><b>14.4.1</b> Giotto to Seurat</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="interoperability-with-other-frameworks.html"><a href="interoperability-with-other-frameworks.html#anndataspatialdata"><i class="fa fa-check"></i><b>14.5</b> AnnData/SpatialData</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="interoperability-with-isolated-tools.html"><a href="interoperability-with-isolated-tools.html"><i class="fa fa-check"></i><b>15</b> Interoperability with isolated tools</a>
<ul>
<li class="chapter" data-level="15.1" data-path="interoperability-with-isolated-tools.html"><a href="interoperability-with-isolated-tools.html#spatial-niche-trajectory-analysis"><i class="fa fa-check"></i><b>15.1</b> Spatial niche trajectory analysis</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="interoperability-with-isolated-tools.html"><a href="interoperability-with-isolated-tools.html#dataset-download"><i class="fa fa-check"></i><b>15.1.1</b> Dataset download</a></li>
<li class="chapter" data-level="15.1.2" data-path="interoperability-with-isolated-tools.html"><a href="interoperability-with-isolated-tools.html#create-the-giotto-object-2"><i class="fa fa-check"></i><b>15.1.2</b> Create the Giotto object</a></li>
<li class="chapter" data-level="15.1.3" data-path="interoperability-with-isolated-tools.html"><a href="interoperability-with-isolated-tools.html#visualization"><i class="fa fa-check"></i><b>15.1.3</b> visualization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html"><i class="fa fa-check"></i><b>16</b> Interactivity with the R/Spatial ecosystem</a>
<ul>
<li class="chapter" data-level="16.1" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#kriging"><i class="fa fa-check"></i><b>16.1</b> Kriging</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#dataset"><i class="fa fa-check"></i><b>16.1.1</b> Dataset</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#importing-visium-data"><i class="fa fa-check"></i><b>16.2</b> Importing visium data</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#identifying-spatially-organized-features"><i class="fa fa-check"></i><b>16.2.1</b> Identifying spatially organized features</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#adding-cell-polygons-to-giotto-object"><i class="fa fa-check"></i><b>16.3</b> Adding cell polygons to Giotto object</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#read-in-the-poly-information"><i class="fa fa-check"></i><b>16.3.1</b> Read in the poly information</a></li>
<li class="chapter" data-level="16.3.2" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#vizualizing-polygons"><i class="fa fa-check"></i><b>16.3.2</b> Vizualizing polygons</a></li>
<li class="chapter" data-level="16.3.3" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#showing-giotto-object-prior-to-polygon-addition"><i class="fa fa-check"></i><b>16.3.3</b> Showing Giotto object prior to polygon addition</a></li>
<li class="chapter" data-level="16.3.4" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#adding-polygons-to-giotto-object"><i class="fa fa-check"></i><b>16.3.4</b> Adding polygons to giotto object</a></li>
<li class="chapter" data-level="16.3.5" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#check-polygon-information"><i class="fa fa-check"></i><b>16.3.5</b> Check polygon information</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#performing-kriging"><i class="fa fa-check"></i><b>16.4</b> Performing kriging</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#interpolating-features"><i class="fa fa-check"></i><b>16.4.1</b> Interpolating features</a></li>
<li class="chapter" data-level="16.4.2" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#expression-overlap"><i class="fa fa-check"></i><b>16.4.2</b> Expression overlap</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#reading-in-larger-dataset"><i class="fa fa-check"></i><b>16.5</b> Reading in larger dataset</a></li>
<li class="chapter" data-level="16.6" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#analyzing-interpolated-features"><i class="fa fa-check"></i><b>16.6</b> Analyzing interpolated features</a>
<ul>
<li class="chapter" data-level="16.6.1" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#filter-and-normalization"><i class="fa fa-check"></i><b>16.6.1</b> Filter and normalization</a></li>
<li class="chapter" data-level="16.6.2" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#visualizing-gene-expression-from-interpolated-expression"><i class="fa fa-check"></i><b>16.6.2</b> Visualizing gene expression from interpolated expression</a></li>
<li class="chapter" data-level="16.6.3" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#run-pca"><i class="fa fa-check"></i><b>16.6.3</b> Run PCA</a></li>
<li class="chapter" data-level="16.6.4" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#clustering-1"><i class="fa fa-check"></i><b>16.6.4</b> Clustering</a></li>
<li class="chapter" data-level="16.6.5" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#visualizing-clustering"><i class="fa fa-check"></i><b>16.6.5</b> Visualizing clustering</a></li>
<li class="chapter" data-level="16.6.6" data-path="interactivity-with-the-rspatial-ecosystem.html"><a href="interactivity-with-the-rspatial-ecosystem.html#cropping-objects"><i class="fa fa-check"></i><b>16.6.6</b> Cropping objects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="contributing-to-giotto.html"><a href="contributing-to-giotto.html"><i class="fa fa-check"></i><b>17</b> Contributing to Giotto</a>
<ul>
<li class="chapter" data-level="17.1" data-path="contributing-to-giotto.html"><a href="contributing-to-giotto.html#contribution-guideline"><i class="fa fa-check"></i><b>17.1</b> Contribution guideline</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Workshop: Spatial multi-omics data analysis with Giotto Suite</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="interactivity-with-the-rspatial-ecosystem" class="section level1 hasAnchor" number="16">
<h1><span class="header-section-number">16</span> Interactivity with the R/Spatial ecosystem<a href="interactivity-with-the-rspatial-ecosystem.html#interactivity-with-the-rspatial-ecosystem" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Jeff Sheridan</p>
<p>August 7th 2024</p>
<div id="kriging" class="section level2 hasAnchor" number="16.1">
<h2><span class="header-section-number">16.1</span> Kriging<a href="interactivity-with-the-rspatial-ecosystem.html#kriging" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Low resolution spatial data typically covers multiple cells making it difficult to
delineate the cell contribution to gene expression. Using a process called kriging
we can interpolate gene expression at the single cell levels from low resolution
datasets.</p>
<p>Visium datasets require a high resolution H&amp;E or IF image to align spots to. Using
these images we can identify individual nuclei and cells to be used for kriging. Identifying
nuclei is outside the scope of the current tutorial but is required to perform kriging.
Tutorials can found here for H&amp;E and IF.</p>
<div id="dataset" class="section level3 hasAnchor" number="16.1.1">
<h3><span class="header-section-number">16.1.1</span> Dataset<a href="interactivity-with-the-rspatial-ecosystem.html#dataset" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For this tutorial we’ll be using the mouse brain dataset described in section 6.</p>
</div>
</div>
<div id="importing-visium-data" class="section level2 hasAnchor" number="16.2">
<h2><span class="header-section-number">16.2</span> Importing visium data<a href="interactivity-with-the-rspatial-ecosystem.html#importing-visium-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We first need to import a dataset that we want to perform kriging on.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="interactivity-with-the-rspatial-ecosystem.html#cb184-1" tabindex="-1"></a>data_directory <span class="ot">&lt;-</span> <span class="st">&quot;data&quot;</span></span>
<span id="cb184-2"><a href="interactivity-with-the-rspatial-ecosystem.html#cb184-2" tabindex="-1"></a></span>
<span id="cb184-3"><a href="interactivity-with-the-rspatial-ecosystem.html#cb184-3" tabindex="-1"></a><span class="fu">download.file</span>(<span class="at">url =</span> <span class="st">&quot;https://cf.10xgenomics.com/samples/spatial-exp/1.1.0/V1_Adult_Mouse_Brain/V1_Adult_Mouse_Brain_raw_feature_bc_matrix.tar.gz&quot;</span>,</span>
<span id="cb184-4"><a href="interactivity-with-the-rspatial-ecosystem.html#cb184-4" tabindex="-1"></a>              <span class="at">destfile =</span> <span class="st">&quot;data/V1_Adult_Mouse_Brain_raw_feature_bc_matrix.tar.gz&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in download.file(url =
## &quot;https://cf.10xgenomics.com/samples/spatial-exp/1.1.0/V1_Adult_Mouse_Brain/V1_Adult_Mouse_Brain_raw_feature_bc_matrix.tar.gz&quot;,
## : URL
## https://cf.10xgenomics.com/samples/spatial-exp/1.1.0/V1_Adult_Mouse_Brain/V1_Adult_Mouse_Brain_raw_feature_bc_matrix.tar.gz:
## cannot open destfile &#39;data/V1_Adult_Mouse_Brain_raw_feature_bc_matrix.tar.gz&#39;, reason &#39;No such file or
## directory&#39;</code></pre>
<pre><code>## Warning in download.file(url =
## &quot;https://cf.10xgenomics.com/samples/spatial-exp/1.1.0/V1_Adult_Mouse_Brain/V1_Adult_Mouse_Brain_raw_feature_bc_matrix.tar.gz&quot;,
## : download had nonzero exit status</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="interactivity-with-the-rspatial-ecosystem.html#cb187-1" tabindex="-1"></a><span class="fu">download.file</span>(<span class="at">url =</span> <span class="st">&quot;https://cf.10xgenomics.com/samples/spatial-exp/1.1.0/V1_Adult_Mouse_Brain/V1_Adult_Mouse_Brain_spatial.tar.gz&quot;</span>,</span>
<span id="cb187-2"><a href="interactivity-with-the-rspatial-ecosystem.html#cb187-2" tabindex="-1"></a>              <span class="at">destfile =</span> <span class="st">&quot;data/V1_Adult_Mouse_Brain_spatial.tar.gz&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in download.file(url =
## &quot;https://cf.10xgenomics.com/samples/spatial-exp/1.1.0/V1_Adult_Mouse_Brain/V1_Adult_Mouse_Brain_spatial.tar.gz&quot;,
## : URL
## https://cf.10xgenomics.com/samples/spatial-exp/1.1.0/V1_Adult_Mouse_Brain/V1_Adult_Mouse_Brain_spatial.tar.gz:
## cannot open destfile &#39;data/V1_Adult_Mouse_Brain_spatial.tar.gz&#39;, reason &#39;No such file or directory&#39;</code></pre>
<pre><code>## Warning in download.file(url =
## &quot;https://cf.10xgenomics.com/samples/spatial-exp/1.1.0/V1_Adult_Mouse_Brain/V1_Adult_Mouse_Brain_spatial.tar.gz&quot;,
## : download had nonzero exit status</code></pre>
<p>After downloading, unzip the gz files. You should get the “raw_feature_bc_matrix” and “spatial” folders inside “data/”.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-1" tabindex="-1"></a><span class="fu">library</span>(Giotto)</span>
<span id="cb190-2"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-2" tabindex="-1"></a></span>
<span id="cb190-3"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-3" tabindex="-1"></a>save_directory <span class="ot">&lt;-</span> <span class="st">&#39;results&#39;</span></span>
<span id="cb190-4"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-4" tabindex="-1"></a>visium_save_directory <span class="ot">&lt;-</span> <span class="fu">file.path</span>(save_directory, <span class="st">&#39;visium_mouse_brain&#39;</span>)</span>
<span id="cb190-5"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-5" tabindex="-1"></a>subcell_save_directory <span class="ot">&lt;-</span> <span class="fu">file.path</span>(save_directory, <span class="st">&#39;pseudo_subcellular/&#39;</span>)</span>
<span id="cb190-6"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-6" tabindex="-1"></a></span>
<span id="cb190-7"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-7" tabindex="-1"></a>instrs <span class="ot">&lt;-</span> <span class="fu">createGiottoInstructions</span>(<span class="at">show_plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb190-8"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-8" tabindex="-1"></a>                                  <span class="at">save_plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb190-9"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-9" tabindex="-1"></a>                                  <span class="at">save_dir =</span> visium_save_directory)</span>
<span id="cb190-10"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-10" tabindex="-1"></a></span>
<span id="cb190-11"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-11" tabindex="-1"></a>v_brain <span class="ot">&lt;-</span> <span class="fu">createGiottoVisiumObject</span>(data_directory, <span class="at">gene_column_index =</span> <span class="dv">2</span>, <span class="at">instructions =</span> instrs)</span>
<span id="cb190-12"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-12" tabindex="-1"></a></span>
<span id="cb190-13"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-13" tabindex="-1"></a><span class="co"># Subset to in tissue only</span></span>
<span id="cb190-14"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-14" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">pDataDT</span>(v_brain)</span>
<span id="cb190-15"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-15" tabindex="-1"></a>in_tissue_barcodes <span class="ot">=</span> cm[in_tissue <span class="sc">==</span> <span class="dv">1</span>]<span class="sc">$</span>cell_ID</span>
<span id="cb190-16"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-16" tabindex="-1"></a>v_brain <span class="ot">=</span> <span class="fu">subsetGiotto</span>(v_brain, <span class="at">cell_ids =</span> in_tissue_barcodes)</span>
<span id="cb190-17"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-17" tabindex="-1"></a></span>
<span id="cb190-18"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-18" tabindex="-1"></a><span class="co"># Filter</span></span>
<span id="cb190-19"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-19" tabindex="-1"></a>v_brain <span class="ot">=</span> <span class="fu">filterGiotto</span>(<span class="at">gobject =</span> v_brain,</span>
<span id="cb190-20"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-20" tabindex="-1"></a>                       <span class="at">expression_threshold =</span> <span class="dv">1</span>,</span>
<span id="cb190-21"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-21" tabindex="-1"></a>                       <span class="at">feat_det_in_min_cells =</span> <span class="dv">50</span>,</span>
<span id="cb190-22"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-22" tabindex="-1"></a>                       <span class="at">min_det_feats_per_cell =</span> <span class="dv">1000</span>,</span>
<span id="cb190-23"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-23" tabindex="-1"></a>                       <span class="at">expression_values =</span> <span class="fu">c</span>(<span class="st">&#39;raw&#39;</span>))</span>
<span id="cb190-24"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-24" tabindex="-1"></a></span>
<span id="cb190-25"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-25" tabindex="-1"></a><span class="co"># Normalize</span></span>
<span id="cb190-26"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-26" tabindex="-1"></a>v_brain <span class="ot">=</span> <span class="fu">normalizeGiotto</span>(<span class="at">gobject =</span> v_brain,</span>
<span id="cb190-27"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-27" tabindex="-1"></a>                          <span class="at">scalefactor =</span> <span class="dv">6000</span>,</span>
<span id="cb190-28"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-28" tabindex="-1"></a>                          <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb190-29"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-29" tabindex="-1"></a></span>
<span id="cb190-30"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-30" tabindex="-1"></a><span class="co"># Add stats</span></span>
<span id="cb190-31"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-31" tabindex="-1"></a>v_brain <span class="ot">=</span> <span class="fu">addStatistics</span>(<span class="at">gobject =</span> v_brain)</span>
<span id="cb190-32"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-32" tabindex="-1"></a></span>
<span id="cb190-33"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-33" tabindex="-1"></a><span class="co"># ID HVF</span></span>
<span id="cb190-34"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-34" tabindex="-1"></a>v_brain <span class="ot">=</span> <span class="fu">calculateHVF</span>(<span class="at">gobject =</span> v_brain, <span class="at">method =</span> <span class="st">&quot;cov_loess&quot;</span>)</span>
<span id="cb190-35"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-35" tabindex="-1"></a>fm <span class="ot">=</span> <span class="fu">fDataDT</span>(v_brain)</span>
<span id="cb190-36"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-36" tabindex="-1"></a>hv_feats <span class="ot">=</span> fm[hvf <span class="sc">==</span> <span class="st">&#39;yes&#39;</span> <span class="sc">&amp;</span> perc_cells <span class="sc">&gt;</span> <span class="dv">3</span> <span class="sc">&amp;</span> mean_expr_det <span class="sc">&gt;</span> <span class="fl">0.4</span>]<span class="sc">$</span>feat_ID</span>
<span id="cb190-37"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-37" tabindex="-1"></a><span class="fu">length</span>(hv_feats)</span>
<span id="cb190-38"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-38" tabindex="-1"></a></span>
<span id="cb190-39"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-39" tabindex="-1"></a><span class="co"># Dimension Reductions</span></span>
<span id="cb190-40"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-40" tabindex="-1"></a>v_brain <span class="ot">=</span> <span class="fu">runPCA</span>(<span class="at">gobject =</span> v_brain,</span>
<span id="cb190-41"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-41" tabindex="-1"></a>                 <span class="at">feats_to_use =</span> hv_feats)</span>
<span id="cb190-42"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-42" tabindex="-1"></a></span>
<span id="cb190-43"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-43" tabindex="-1"></a>v_brain <span class="ot">=</span> <span class="fu">runUMAP</span>(v_brain,</span>
<span id="cb190-44"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-44" tabindex="-1"></a>                  <span class="at">dimensions_to_use =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb190-45"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-45" tabindex="-1"></a>                  <span class="at">n_neighbors =</span> <span class="dv">15</span>,</span>
<span id="cb190-46"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-46" tabindex="-1"></a>                  <span class="at">set_seed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb190-47"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-47" tabindex="-1"></a></span>
<span id="cb190-48"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-48" tabindex="-1"></a><span class="co"># NN Network</span></span>
<span id="cb190-49"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-49" tabindex="-1"></a>v_brain <span class="ot">=</span> <span class="fu">createNearestNetwork</span>(<span class="at">gobject =</span> v_brain,</span>
<span id="cb190-50"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-50" tabindex="-1"></a>                               <span class="at">dimensions_to_use =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb190-51"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-51" tabindex="-1"></a>                               <span class="at">k =</span> <span class="dv">15</span>)</span>
<span id="cb190-52"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-52" tabindex="-1"></a><span class="co"># Leiden Cluster</span></span>
<span id="cb190-53"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-53" tabindex="-1"></a>v_brain <span class="ot">=</span> <span class="fu">doLeidenCluster</span>(<span class="at">gobject =</span> v_brain,</span>
<span id="cb190-54"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-54" tabindex="-1"></a>                          <span class="at">resolution =</span> <span class="fl">0.4</span>,</span>
<span id="cb190-55"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-55" tabindex="-1"></a>                          <span class="at">n_iterations =</span> <span class="dv">1000</span>,</span>
<span id="cb190-56"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-56" tabindex="-1"></a>                          <span class="at">set_seed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb190-57"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-57" tabindex="-1"></a></span>
<span id="cb190-58"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-58" tabindex="-1"></a><span class="co"># Spatial Network (kNN)</span></span>
<span id="cb190-59"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-59" tabindex="-1"></a>v_brain <span class="ot">&lt;-</span> <span class="fu">createSpatialNetwork</span>(<span class="at">gobject =</span> v_brain,</span>
<span id="cb190-60"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-60" tabindex="-1"></a>                                <span class="at">method =</span> <span class="st">&#39;kNN&#39;</span>,</span>
<span id="cb190-61"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-61" tabindex="-1"></a>                                <span class="at">k =</span> <span class="dv">5</span>,</span>
<span id="cb190-62"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-62" tabindex="-1"></a>                                <span class="at">maximum_distance_knn =</span> <span class="dv">400</span>,</span>
<span id="cb190-63"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-63" tabindex="-1"></a>                                <span class="at">name =</span> <span class="st">&#39;spatial_network&#39;</span>)</span>
<span id="cb190-64"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-64" tabindex="-1"></a></span>
<span id="cb190-65"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-65" tabindex="-1"></a><span class="fu">spatPlot2D</span>(<span class="at">gobject =</span> v_brain,</span>
<span id="cb190-66"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-66" tabindex="-1"></a>           <span class="at">spat_unit =</span> <span class="st">&#39;cell&#39;</span>,</span>
<span id="cb190-67"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-67" tabindex="-1"></a>           <span class="at">cell_color =</span> <span class="st">&#39;leiden_clus&#39;</span>,</span>
<span id="cb190-68"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-68" tabindex="-1"></a>           <span class="at">show_image =</span> T,</span>
<span id="cb190-69"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-69" tabindex="-1"></a>           <span class="at">point_size =</span> <span class="fl">1.5</span>,</span>
<span id="cb190-70"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-70" tabindex="-1"></a>           <span class="at">point_shape =</span> <span class="st">&#39;no_border&#39;</span>,</span>
<span id="cb190-71"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-71" tabindex="-1"></a>           <span class="at">background_color =</span> <span class="st">&#39;black&#39;</span>,</span>
<span id="cb190-72"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-72" tabindex="-1"></a>           <span class="at">show_legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb190-73"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-73" tabindex="-1"></a>           <span class="at">save_plot =</span> T,</span>
<span id="cb190-74"><a href="interactivity-with-the-rspatial-ecosystem.html#cb190-74" tabindex="-1"></a>           <span class="at">save_param =</span> <span class="fu">list</span>(<span class="at">save_name =</span> <span class="st">&#39;03_ses6_1_vis_spat&#39;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-269"></span>
<img src="img/03_session6/03_ses6_1_vis_spat.png" alt="Mouse brain spatial plot showing leiden clustering" width="75%" />
<p class="caption">
Figure 16.1: Mouse brain spatial plot showing leiden clustering
</p>
</div>
<div id="identifying-spatially-organized-features" class="section level3 hasAnchor" number="16.2.1">
<h3><span class="header-section-number">16.2.1</span> Identifying spatially organized features<a href="interactivity-with-the-rspatial-ecosystem.html#identifying-spatially-organized-features" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We need to identify genes to be used for interpolation. This works best with genes that are spatially distinct.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="interactivity-with-the-rspatial-ecosystem.html#cb191-1" tabindex="-1"></a><span class="co"># Spatially Variable Features</span></span>
<span id="cb191-2"><a href="interactivity-with-the-rspatial-ecosystem.html#cb191-2" tabindex="-1"></a>ranktest <span class="ot">=</span> <span class="fu">binSpect</span>(v_brain,</span>
<span id="cb191-3"><a href="interactivity-with-the-rspatial-ecosystem.html#cb191-3" tabindex="-1"></a>                    <span class="at">bin_method =</span> <span class="st">&#39;rank&#39;</span>,</span>
<span id="cb191-4"><a href="interactivity-with-the-rspatial-ecosystem.html#cb191-4" tabindex="-1"></a>                    <span class="at">calc_hub =</span> T,</span>
<span id="cb191-5"><a href="interactivity-with-the-rspatial-ecosystem.html#cb191-5" tabindex="-1"></a>                    <span class="at">hub_min_int =</span> <span class="dv">5</span>,</span>
<span id="cb191-6"><a href="interactivity-with-the-rspatial-ecosystem.html#cb191-6" tabindex="-1"></a>                    <span class="at">spatial_network_name =</span> <span class="st">&#39;spatial_network&#39;</span>,</span>
<span id="cb191-7"><a href="interactivity-with-the-rspatial-ecosystem.html#cb191-7" tabindex="-1"></a>                    <span class="at">do_parallel =</span> T,</span>
<span id="cb191-8"><a href="interactivity-with-the-rspatial-ecosystem.html#cb191-8" tabindex="-1"></a>                    <span class="at">cores =</span> <span class="dv">8</span>) <span class="co">#not able to provide a seed number, so do not set one</span></span>
<span id="cb191-9"><a href="interactivity-with-the-rspatial-ecosystem.html#cb191-9" tabindex="-1"></a></span>
<span id="cb191-10"><a href="interactivity-with-the-rspatial-ecosystem.html#cb191-10" tabindex="-1"></a><span class="co"># Getting the top 15 spatially organized genes</span></span>
<span id="cb191-11"><a href="interactivity-with-the-rspatial-ecosystem.html#cb191-11" tabindex="-1"></a>ext_spatial_features <span class="ot">=</span> ranktest[<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>,]<span class="sc">$</span>feats</span></code></pre></div>
</div>
</div>
<div id="adding-cell-polygons-to-giotto-object" class="section level2 hasAnchor" number="16.3">
<h2><span class="header-section-number">16.3</span> Adding cell polygons to Giotto object<a href="interactivity-with-the-rspatial-ecosystem.html#adding-cell-polygons-to-giotto-object" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First we need to read in the geojson file that contains the cell polygons that
we’ll interpolate gene expression onto. These will then be added to the Giotto object</p>
<div id="read-in-the-poly-information" class="section level3 hasAnchor" number="16.3.1">
<h3><span class="header-section-number">16.3.1</span> Read in the poly information<a href="interactivity-with-the-rspatial-ecosystem.html#read-in-the-poly-information" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="interactivity-with-the-rspatial-ecosystem.html#cb192-1" tabindex="-1"></a><span class="co"># Read in the data</span></span>
<span id="cb192-2"><a href="interactivity-with-the-rspatial-ecosystem.html#cb192-2" tabindex="-1"></a>stardist_cell_poly_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(data_directory, <span class="st">&quot;segmentations/stardist_only_cell_bounds.geojson&quot;</span>)</span>
<span id="cb192-3"><a href="interactivity-with-the-rspatial-ecosystem.html#cb192-3" tabindex="-1"></a></span>
<span id="cb192-4"><a href="interactivity-with-the-rspatial-ecosystem.html#cb192-4" tabindex="-1"></a>stardist_cell_gpoly <span class="ot">&lt;-</span> <span class="fu">createGiottoPolygonsFromGeoJSON</span>(<span class="at">GeoJSON =</span> stardist_cell_poly_path,</span>
<span id="cb192-5"><a href="interactivity-with-the-rspatial-ecosystem.html#cb192-5" tabindex="-1"></a>                                                      <span class="at">name =</span> <span class="st">&quot;stardist_cell&quot;</span>,</span>
<span id="cb192-6"><a href="interactivity-with-the-rspatial-ecosystem.html#cb192-6" tabindex="-1"></a>                                                      <span class="at">calc_centroids =</span> <span class="cn">TRUE</span>)</span>
<span id="cb192-7"><a href="interactivity-with-the-rspatial-ecosystem.html#cb192-7" tabindex="-1"></a></span>
<span id="cb192-8"><a href="interactivity-with-the-rspatial-ecosystem.html#cb192-8" tabindex="-1"></a>stardist_cell_gpoly <span class="ot">&lt;-</span> <span class="fu">flip</span>(stardist_cell_gpoly)</span>
<span id="cb192-9"><a href="interactivity-with-the-rspatial-ecosystem.html#cb192-9" tabindex="-1"></a><span class="fu">plot</span>(stardist_cell_gpoly, <span class="at">max_poly =</span> <span class="fl">1e6</span>)</span></code></pre></div>
</div>
<div id="vizualizing-polygons" class="section level3 hasAnchor" number="16.3.2">
<h3><span class="header-section-number">16.3.2</span> Vizualizing polygons<a href="interactivity-with-the-rspatial-ecosystem.html#vizualizing-polygons" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="interactivity-with-the-rspatial-ecosystem.html#cb193-1" tabindex="-1"></a><span class="co"># show the data</span></span>
<span id="cb193-2"><a href="interactivity-with-the-rspatial-ecosystem.html#cb193-2" tabindex="-1"></a><span class="fu">plot</span>(stardist_cell_gpoly, <span class="at">max_poly =</span> <span class="fl">1e6</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-273"></span>
<img src="img/03_session6/03_ses6_2_cell_poly.png" alt="Mouse brain cell polygons" width="100%" />
<p class="caption">
Figure 16.2: Mouse brain cell polygons
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-274"></span>
<img src="img/03_session6/03_ses6_2_cell_poly_flipped.png" alt="Mouse brain cell polygons with artifacts removed and flipped" width="100%" />
<p class="caption">
Figure 16.3: Mouse brain cell polygons with artifacts removed and flipped
</p>
</div>
</div>
<div id="showing-giotto-object-prior-to-polygon-addition" class="section level3 hasAnchor" number="16.3.3">
<h3><span class="header-section-number">16.3.3</span> Showing Giotto object prior to polygon addition<a href="interactivity-with-the-rspatial-ecosystem.html#showing-giotto-object-prior-to-polygon-addition" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="interactivity-with-the-rspatial-ecosystem.html#cb194-1" tabindex="-1"></a><span class="fu">print</span>(v_brain)</span></code></pre></div>
</div>
<div id="adding-polygons-to-giotto-object" class="section level3 hasAnchor" number="16.3.4">
<h3><span class="header-section-number">16.3.4</span> Adding polygons to giotto object<a href="interactivity-with-the-rspatial-ecosystem.html#adding-polygons-to-giotto-object" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="interactivity-with-the-rspatial-ecosystem.html#cb195-1" tabindex="-1"></a>v_brain <span class="ot">&lt;-</span> <span class="fu">addGiottoPolygons</span>(v_brain, </span>
<span id="cb195-2"><a href="interactivity-with-the-rspatial-ecosystem.html#cb195-2" tabindex="-1"></a>                             <span class="at">gpolygons =</span> <span class="fu">list</span>(<span class="st">&#39;stardist_cell&#39;</span> <span class="ot">=</span> stardist_cell_gpoly))</span>
<span id="cb195-3"><a href="interactivity-with-the-rspatial-ecosystem.html#cb195-3" tabindex="-1"></a></span>
<span id="cb195-4"><a href="interactivity-with-the-rspatial-ecosystem.html#cb195-4" tabindex="-1"></a><span class="fu">print</span>(v_brain)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-277"></span>
<img src="img/03_session6/03_ses6_gobject_sub.png" alt="Giotto object after to adding subcellular polygons. Addition of new stardist_cell polygon." width="40%" />
<p class="caption">
Figure 16.4: Giotto object after to adding subcellular polygons. Addition of new stardist_cell polygon.
</p>
</div>
</div>
<div id="check-polygon-information" class="section level3 hasAnchor" number="16.3.5">
<h3><span class="header-section-number">16.3.5</span> Check polygon information<a href="interactivity-with-the-rspatial-ecosystem.html#check-polygon-information" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="interactivity-with-the-rspatial-ecosystem.html#cb196-1" tabindex="-1"></a>poly_info <span class="ot">&lt;-</span> <span class="fu">getPolygonInfo</span>(v_brain,<span class="at">polygon_name  =</span> <span class="st">&#39;stardist_cell&#39;</span>)</span></code></pre></div>
</div>
</div>
<div id="performing-kriging" class="section level2 hasAnchor" number="16.4">
<h2><span class="header-section-number">16.4</span> Performing kriging<a href="interactivity-with-the-rspatial-ecosystem.html#performing-kriging" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="interpolating-features" class="section level3 hasAnchor" number="16.4.1">
<h3><span class="header-section-number">16.4.1</span> Interpolating features<a href="interactivity-with-the-rspatial-ecosystem.html#interpolating-features" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now we can perform the first step in interpolating expression data onto cell polygons.
This involves creating a raster image for the gene expression of each of the selected genes.
The steps from here can be time consuming and require large amounts of memory. We will only be
analyzing 50 genes to show the process of expression interpolation.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="interactivity-with-the-rspatial-ecosystem.html#cb197-1" tabindex="-1"></a>future<span class="sc">::</span><span class="fu">plan</span>(future<span class="sc">::</span><span class="fu">multisession</span>()) <span class="co"># comment out for single threading</span></span>
<span id="cb197-2"><a href="interactivity-with-the-rspatial-ecosystem.html#cb197-2" tabindex="-1"></a>subcell_v_brain <span class="ot">&lt;-</span> <span class="fu">interpolateFeature</span>(v_brain,</span>
<span id="cb197-3"><a href="interactivity-with-the-rspatial-ecosystem.html#cb197-3" tabindex="-1"></a>                                  <span class="at">spat_unit =</span> <span class="st">&#39;cell&#39;</span>,</span>
<span id="cb197-4"><a href="interactivity-with-the-rspatial-ecosystem.html#cb197-4" tabindex="-1"></a>                                  <span class="at">feat_type =</span> <span class="st">&#39;rna&#39;</span>,</span>
<span id="cb197-5"><a href="interactivity-with-the-rspatial-ecosystem.html#cb197-5" tabindex="-1"></a>                                  <span class="at">ext =</span> <span class="fu">ext</span>(v_brain),</span>
<span id="cb197-6"><a href="interactivity-with-the-rspatial-ecosystem.html#cb197-6" tabindex="-1"></a>                                  <span class="at">feats =</span> ext_spatial_features,</span>
<span id="cb197-7"><a href="interactivity-with-the-rspatial-ecosystem.html#cb197-7" tabindex="-1"></a>                                  <span class="at">overwrite =</span> T)</span>
<span id="cb197-8"><a href="interactivity-with-the-rspatial-ecosystem.html#cb197-8" tabindex="-1"></a></span>
<span id="cb197-9"><a href="interactivity-with-the-rspatial-ecosystem.html#cb197-9" tabindex="-1"></a><span class="fu">print</span>(subcell_v_brain)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-280"></span>
<img src="img/03_session6/03_ses6_gobject_sub_interpolate.png" alt="Giotto object after to interpolating features. Addition of images for each interoplated feature (left) and an example of rasterized gene expression image (right)." width="100%" />
<p class="caption">
Figure 16.5: Giotto object after to interpolating features. Addition of images for each interoplated feature (left) and an example of rasterized gene expression image (right).
</p>
</div>
</div>
<div id="expression-overlap" class="section level3 hasAnchor" number="16.4.2">
<h3><span class="header-section-number">16.4.2</span> Expression overlap<a href="interactivity-with-the-rspatial-ecosystem.html#expression-overlap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next we will calculate the overlap of the rasterized gene expression image to the polygons supplied earlier.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="interactivity-with-the-rspatial-ecosystem.html#cb198-1" tabindex="-1"></a>subcell_v_brain <span class="ot">&lt;-</span> <span class="fu">calculateOverlapPolygonImages</span>(<span class="at">gobject =</span> subcell_v_brain,</span>
<span id="cb198-2"><a href="interactivity-with-the-rspatial-ecosystem.html#cb198-2" tabindex="-1"></a>                                             <span class="at">name_overlap =</span> <span class="st">&quot;rna&quot;</span>,</span>
<span id="cb198-3"><a href="interactivity-with-the-rspatial-ecosystem.html#cb198-3" tabindex="-1"></a>                                             <span class="at">spatial_info =</span> <span class="st">&quot;stardist_cell&quot;</span>,</span>
<span id="cb198-4"><a href="interactivity-with-the-rspatial-ecosystem.html#cb198-4" tabindex="-1"></a>                                             <span class="at">image_names =</span> ext_spatial_features)</span>
<span id="cb198-5"><a href="interactivity-with-the-rspatial-ecosystem.html#cb198-5" tabindex="-1"></a></span>
<span id="cb198-6"><a href="interactivity-with-the-rspatial-ecosystem.html#cb198-6" tabindex="-1"></a>subcell_v_brain <span class="ot">&lt;-</span> Giotto<span class="sc">::</span><span class="fu">overlapToMatrix</span>(<span class="at">x =</span> subcell_v_brain,</span>
<span id="cb198-7"><a href="interactivity-with-the-rspatial-ecosystem.html#cb198-7" tabindex="-1"></a>                                     <span class="at">poly_info =</span> <span class="st">&quot;stardist_cell&quot;</span>,</span>
<span id="cb198-8"><a href="interactivity-with-the-rspatial-ecosystem.html#cb198-8" tabindex="-1"></a>                                     <span class="at">feat_info =</span> <span class="st">&quot;rna&quot;</span>,</span>
<span id="cb198-9"><a href="interactivity-with-the-rspatial-ecosystem.html#cb198-9" tabindex="-1"></a>                                     <span class="at">aggr_function =</span> <span class="st">&quot;sum&quot;</span>,</span>
<span id="cb198-10"><a href="interactivity-with-the-rspatial-ecosystem.html#cb198-10" tabindex="-1"></a>                                     <span class="at">type=</span><span class="st">&#39;intensity&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-282"></span>
<img src="img/03_session6/03_ses6_interpolate_gene_express.png" alt="Gene expression for cells based on interpolation." width="100%" />
<p class="caption">
Figure 16.6: Gene expression for cells based on interpolation.
</p>
</div>
</div>
</div>
<div id="reading-in-larger-dataset" class="section level2 hasAnchor" number="16.5">
<h2><span class="header-section-number">16.5</span> Reading in larger dataset<a href="interactivity-with-the-rspatial-ecosystem.html#reading-in-larger-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For better results more genes are required. The above data used only 15 genes. We will now read in a dataset that has 1500 interpolated genes an use this for the remained of the tutorial.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="interactivity-with-the-rspatial-ecosystem.html#cb199-1" tabindex="-1"></a>subcell_v_brain <span class="ot">&lt;-</span> <span class="fu">loadGiotto</span>(<span class="fu">file.path</span>(data_directory, <span class="st">&#39;subcellular_1500_overlap&#39;</span>))</span></code></pre></div>
</div>
<div id="analyzing-interpolated-features" class="section level2 hasAnchor" number="16.6">
<h2><span class="header-section-number">16.6</span> Analyzing interpolated features<a href="interactivity-with-the-rspatial-ecosystem.html#analyzing-interpolated-features" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="filter-and-normalization" class="section level3 hasAnchor" number="16.6.1">
<h3><span class="header-section-number">16.6.1</span> Filter and normalization<a href="interactivity-with-the-rspatial-ecosystem.html#filter-and-normalization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="interactivity-with-the-rspatial-ecosystem.html#cb200-1" tabindex="-1"></a>subcell_v_brain <span class="ot">&lt;-</span> <span class="fu">filterGiotto</span>(<span class="at">gobject =</span> subcell_v_brain,</span>
<span id="cb200-2"><a href="interactivity-with-the-rspatial-ecosystem.html#cb200-2" tabindex="-1"></a>                               <span class="at">spat_unit =</span> <span class="st">&quot;stardist_cell&quot;</span>,</span>
<span id="cb200-3"><a href="interactivity-with-the-rspatial-ecosystem.html#cb200-3" tabindex="-1"></a>                               <span class="at">expression_values =</span> <span class="st">&quot;raw&quot;</span>,</span>
<span id="cb200-4"><a href="interactivity-with-the-rspatial-ecosystem.html#cb200-4" tabindex="-1"></a>                               <span class="at">expression_threshold =</span> <span class="dv">1</span>,</span>
<span id="cb200-5"><a href="interactivity-with-the-rspatial-ecosystem.html#cb200-5" tabindex="-1"></a>                               <span class="at">feat_det_in_min_cells =</span> <span class="dv">0</span>,</span>
<span id="cb200-6"><a href="interactivity-with-the-rspatial-ecosystem.html#cb200-6" tabindex="-1"></a>                               <span class="at">min_det_feats_per_cell =</span> <span class="dv">1</span>)</span>
<span id="cb200-7"><a href="interactivity-with-the-rspatial-ecosystem.html#cb200-7" tabindex="-1"></a></span>
<span id="cb200-8"><a href="interactivity-with-the-rspatial-ecosystem.html#cb200-8" tabindex="-1"></a></span>
<span id="cb200-9"><a href="interactivity-with-the-rspatial-ecosystem.html#cb200-9" tabindex="-1"></a>subcell_v_brain <span class="ot">&lt;-</span> <span class="fu">normalizeGiotto</span>(<span class="at">gobject =</span> subcell_v_brain,</span>
<span id="cb200-10"><a href="interactivity-with-the-rspatial-ecosystem.html#cb200-10" tabindex="-1"></a>                                  <span class="at">spat_unit =</span> <span class="st">&quot;stardist_cell&quot;</span>,</span>
<span id="cb200-11"><a href="interactivity-with-the-rspatial-ecosystem.html#cb200-11" tabindex="-1"></a>                                  <span class="at">scalefactor =</span> <span class="dv">6000</span>,</span>
<span id="cb200-12"><a href="interactivity-with-the-rspatial-ecosystem.html#cb200-12" tabindex="-1"></a>                                  <span class="at">verbose =</span> T)</span></code></pre></div>
</div>
<div id="visualizing-gene-expression-from-interpolated-expression" class="section level3 hasAnchor" number="16.6.2">
<h3><span class="header-section-number">16.6.2</span> Visualizing gene expression from interpolated expression<a href="interactivity-with-the-rspatial-ecosystem.html#visualizing-gene-expression-from-interpolated-expression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-1" tabindex="-1"></a><span class="fu">spatFeatPlot2D</span>(subcell_v_brain,</span>
<span id="cb201-2"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-2" tabindex="-1"></a>               <span class="at">spat_unit =</span> <span class="st">&#39;cell&#39;</span>,</span>
<span id="cb201-3"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-3" tabindex="-1"></a>               <span class="at">gradient_style =</span> <span class="st">&#39;sequential&#39;</span>,</span>
<span id="cb201-4"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-4" tabindex="-1"></a>              <span class="at">cell_color_gradient =</span> <span class="st">&#39;Geyser&#39;</span>,</span>
<span id="cb201-5"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-5" tabindex="-1"></a>              <span class="at">feats =</span> <span class="st">&#39;Sparc&#39;</span>,</span>
<span id="cb201-6"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-6" tabindex="-1"></a>              <span class="at">point_size =</span> <span class="dv">2</span>,</span>
<span id="cb201-7"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-7" tabindex="-1"></a>              <span class="at">save_plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb201-8"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-8" tabindex="-1"></a>              <span class="at">show_image =</span> <span class="cn">TRUE</span>,</span>
<span id="cb201-9"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-9" tabindex="-1"></a>              <span class="at">save_param =</span> <span class="fu">list</span>(<span class="at">save_name =</span> <span class="st">&#39;03_ses6_sparc_vis&#39;</span>))</span>
<span id="cb201-10"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-10" tabindex="-1"></a></span>
<span id="cb201-11"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-11" tabindex="-1"></a><span class="fu">spatFeatPlot2D</span>(subcell_v_brain,</span>
<span id="cb201-12"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-12" tabindex="-1"></a>               <span class="at">spat_unit =</span> <span class="st">&#39;stardist_cell&#39;</span>,</span>
<span id="cb201-13"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-13" tabindex="-1"></a>               <span class="at">gradient_style =</span> <span class="st">&#39;sequential&#39;</span>,</span>
<span id="cb201-14"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-14" tabindex="-1"></a>               <span class="at">cell_color_gradient =</span> <span class="st">&#39;Geyser&#39;</span>,</span>
<span id="cb201-15"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-15" tabindex="-1"></a>              <span class="at">feats =</span> <span class="st">&#39;Sparc&#39;</span>,</span>
<span id="cb201-16"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-16" tabindex="-1"></a>              <span class="at">point_size =</span> <span class="fl">0.6</span>,</span>
<span id="cb201-17"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-17" tabindex="-1"></a>              <span class="at">save_plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb201-18"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-18" tabindex="-1"></a>              <span class="at">show_image =</span> <span class="cn">TRUE</span>,</span>
<span id="cb201-19"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-19" tabindex="-1"></a>              <span class="at">save_param =</span> <span class="fu">list</span>(<span class="at">save_name =</span> <span class="st">&#39;03_ses6_sparc&#39;</span>))</span>
<span id="cb201-20"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-20" tabindex="-1"></a></span>
<span id="cb201-21"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-21" tabindex="-1"></a><span class="fu">spatFeatPlot2D</span>(subcell_v_brain,</span>
<span id="cb201-22"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-22" tabindex="-1"></a>               <span class="at">spat_unit =</span> <span class="st">&#39;cell&#39;</span>,</span>
<span id="cb201-23"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-23" tabindex="-1"></a>               <span class="at">gradient_style =</span> <span class="st">&#39;sequential&#39;</span>,</span>
<span id="cb201-24"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-24" tabindex="-1"></a>              <span class="at">feats =</span> <span class="st">&#39;Pantr1&#39;</span>,</span>
<span id="cb201-25"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-25" tabindex="-1"></a>              <span class="at">cell_color_gradient =</span> <span class="st">&#39;Geyser&#39;</span>,</span>
<span id="cb201-26"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-26" tabindex="-1"></a>              <span class="at">point_size =</span> <span class="dv">2</span>,</span>
<span id="cb201-27"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-27" tabindex="-1"></a>              <span class="at">save_plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb201-28"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-28" tabindex="-1"></a>              <span class="at">show_image =</span> <span class="cn">TRUE</span>,</span>
<span id="cb201-29"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-29" tabindex="-1"></a>              <span class="at">save_param =</span> <span class="fu">list</span>(<span class="at">save_name =</span> <span class="st">&#39;03_ses6_pantr1_vis&#39;</span>))</span>
<span id="cb201-30"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-30" tabindex="-1"></a> </span>
<span id="cb201-31"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-31" tabindex="-1"></a><span class="fu">spatFeatPlot2D</span>(subcell_v_brain,</span>
<span id="cb201-32"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-32" tabindex="-1"></a>               <span class="at">spat_unit =</span> <span class="st">&#39;stardist_cell&#39;</span>,</span>
<span id="cb201-33"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-33" tabindex="-1"></a>               <span class="at">gradient_style =</span> <span class="st">&#39;sequential&#39;</span>,</span>
<span id="cb201-34"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-34" tabindex="-1"></a>               <span class="at">cell_color_gradient =</span> <span class="st">&#39;Geyser&#39;</span>,</span>
<span id="cb201-35"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-35" tabindex="-1"></a>              <span class="at">feats =</span> <span class="st">&#39;Pantr1&#39;</span>,</span>
<span id="cb201-36"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-36" tabindex="-1"></a>              <span class="at">point_size =</span> <span class="fl">0.6</span>,</span>
<span id="cb201-37"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-37" tabindex="-1"></a>              <span class="at">save_plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb201-38"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-38" tabindex="-1"></a>              <span class="at">show_image =</span> <span class="cn">TRUE</span>,</span>
<span id="cb201-39"><a href="interactivity-with-the-rspatial-ecosystem.html#cb201-39" tabindex="-1"></a>              <span class="at">save_param =</span> <span class="fu">list</span>(<span class="at">save_name =</span> <span class="st">&#39;03_ses6_pantr1&#39;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-286"></span>
<img src="img/03_session6/03_ses6_gene_expression.png" alt="Gene expression for visium (left) and interpolated (right) expression for Sparc (top) and Pantr1 (bottom)." width="100%" />
<p class="caption">
Figure 16.7: Gene expression for visium (left) and interpolated (right) expression for Sparc (top) and Pantr1 (bottom).
</p>
</div>
</div>
<div id="run-pca" class="section level3 hasAnchor" number="16.6.3">
<h3><span class="header-section-number">16.6.3</span> Run PCA<a href="interactivity-with-the-rspatial-ecosystem.html#run-pca" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="interactivity-with-the-rspatial-ecosystem.html#cb202-1" tabindex="-1"></a>subcell_v_brain <span class="ot">&lt;-</span> <span class="fu">runPCA</span>(<span class="at">gobject =</span> subcell_v_brain,</span>
<span id="cb202-2"><a href="interactivity-with-the-rspatial-ecosystem.html#cb202-2" tabindex="-1"></a>                         <span class="at">spat_unit =</span> <span class="st">&quot;stardist_cell&quot;</span>,</span>
<span id="cb202-3"><a href="interactivity-with-the-rspatial-ecosystem.html#cb202-3" tabindex="-1"></a>                         <span class="at">expression_values =</span> <span class="st">&quot;normalized&quot;</span>,</span>
<span id="cb202-4"><a href="interactivity-with-the-rspatial-ecosystem.html#cb202-4" tabindex="-1"></a>                         <span class="at">feats_to_use =</span> <span class="cn">NULL</span>)</span></code></pre></div>
</div>
<div id="clustering-1" class="section level3 hasAnchor" number="16.6.4">
<h3><span class="header-section-number">16.6.4</span> Clustering<a href="interactivity-with-the-rspatial-ecosystem.html#clustering-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="interactivity-with-the-rspatial-ecosystem.html#cb203-1" tabindex="-1"></a><span class="co"># UMAP</span></span>
<span id="cb203-2"><a href="interactivity-with-the-rspatial-ecosystem.html#cb203-2" tabindex="-1"></a>subcell_v_brain <span class="ot">&lt;-</span> <span class="fu">runUMAP</span>(subcell_v_brain,</span>
<span id="cb203-3"><a href="interactivity-with-the-rspatial-ecosystem.html#cb203-3" tabindex="-1"></a>                          <span class="at">spat_unit =</span> <span class="st">&quot;stardist_cell&quot;</span>,</span>
<span id="cb203-4"><a href="interactivity-with-the-rspatial-ecosystem.html#cb203-4" tabindex="-1"></a>                          <span class="at">dimensions_to_use =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>,</span>
<span id="cb203-5"><a href="interactivity-with-the-rspatial-ecosystem.html#cb203-5" tabindex="-1"></a>                          <span class="at">n_neighbors =</span> <span class="dv">1000</span>,</span>
<span id="cb203-6"><a href="interactivity-with-the-rspatial-ecosystem.html#cb203-6" tabindex="-1"></a>                          <span class="at">min_dist =</span> <span class="fl">0.001</span>,</span>
<span id="cb203-7"><a href="interactivity-with-the-rspatial-ecosystem.html#cb203-7" tabindex="-1"></a>                          <span class="at">spread =</span> <span class="dv">1</span>)</span>
<span id="cb203-8"><a href="interactivity-with-the-rspatial-ecosystem.html#cb203-8" tabindex="-1"></a></span>
<span id="cb203-9"><a href="interactivity-with-the-rspatial-ecosystem.html#cb203-9" tabindex="-1"></a><span class="co"># NN Network</span></span>
<span id="cb203-10"><a href="interactivity-with-the-rspatial-ecosystem.html#cb203-10" tabindex="-1"></a>subcell_v_brain <span class="ot">&lt;-</span> <span class="fu">createNearestNetwork</span>(<span class="at">gobject =</span> subcell_v_brain,</span>
<span id="cb203-11"><a href="interactivity-with-the-rspatial-ecosystem.html#cb203-11" tabindex="-1"></a>                                       <span class="at">spat_unit =</span> <span class="st">&quot;stardist_cell&quot;</span>,</span>
<span id="cb203-12"><a href="interactivity-with-the-rspatial-ecosystem.html#cb203-12" tabindex="-1"></a>                                       <span class="at">dimensions_to_use =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb203-13"><a href="interactivity-with-the-rspatial-ecosystem.html#cb203-13" tabindex="-1"></a>                                       <span class="at">feats_to_use =</span> hv_feats,</span>
<span id="cb203-14"><a href="interactivity-with-the-rspatial-ecosystem.html#cb203-14" tabindex="-1"></a>                                       <span class="at">expression_values =</span> <span class="st">&#39;normalized&#39;</span>,</span>
<span id="cb203-15"><a href="interactivity-with-the-rspatial-ecosystem.html#cb203-15" tabindex="-1"></a>                                       <span class="at">k =</span> <span class="dv">70</span>)</span>
<span id="cb203-16"><a href="interactivity-with-the-rspatial-ecosystem.html#cb203-16" tabindex="-1"></a></span>
<span id="cb203-17"><a href="interactivity-with-the-rspatial-ecosystem.html#cb203-17" tabindex="-1"></a>subcell_v_brain <span class="ot">&lt;-</span> <span class="fu">doLeidenCluster</span>(<span class="at">gobject =</span> subcell_v_brain,</span>
<span id="cb203-18"><a href="interactivity-with-the-rspatial-ecosystem.html#cb203-18" tabindex="-1"></a>                                  <span class="at">spat_unit =</span> <span class="st">&quot;stardist_cell&quot;</span>,</span>
<span id="cb203-19"><a href="interactivity-with-the-rspatial-ecosystem.html#cb203-19" tabindex="-1"></a>                                  <span class="at">resolution =</span> <span class="fl">0.15</span>,</span>
<span id="cb203-20"><a href="interactivity-with-the-rspatial-ecosystem.html#cb203-20" tabindex="-1"></a>                                  <span class="at">n_iterations =</span> <span class="dv">100</span>,</span>
<span id="cb203-21"><a href="interactivity-with-the-rspatial-ecosystem.html#cb203-21" tabindex="-1"></a>                                  <span class="at">partition_type =</span> <span class="st">&#39;RBConfigurationVertexPartition&#39;</span>)</span>
<span id="cb203-22"><a href="interactivity-with-the-rspatial-ecosystem.html#cb203-22" tabindex="-1"></a></span>
<span id="cb203-23"><a href="interactivity-with-the-rspatial-ecosystem.html#cb203-23" tabindex="-1"></a><span class="fu">plotUMAP</span>(subcell_v_brain, <span class="at">spat_unit =</span> <span class="st">&#39;stardist_cell&#39;</span>, <span class="at">cell_color =</span> <span class="st">&#39;leiden_clus&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-289"></span>
<img src="img/03_session6/03_ses6_subcell_umap.png" alt="UMAP for stardist_cell based on the 1500 interpolated gene expressions. Colored based on leiden clustering." width="100%" />
<p class="caption">
Figure 16.8: UMAP for stardist_cell based on the 1500 interpolated gene expressions. Colored based on leiden clustering.
</p>
</div>
</div>
<div id="visualizing-clustering" class="section level3 hasAnchor" number="16.6.5">
<h3><span class="header-section-number">16.6.5</span> Visualizing clustering<a href="interactivity-with-the-rspatial-ecosystem.html#visualizing-clustering" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="interactivity-with-the-rspatial-ecosystem.html#cb204-1" tabindex="-1"></a><span class="fu">spatPlot2D</span>(<span class="at">gobject =</span> subcell_v_brain,</span>
<span id="cb204-2"><a href="interactivity-with-the-rspatial-ecosystem.html#cb204-2" tabindex="-1"></a>           <span class="at">spat_unit =</span> <span class="st">&#39;cell&#39;</span>,</span>
<span id="cb204-3"><a href="interactivity-with-the-rspatial-ecosystem.html#cb204-3" tabindex="-1"></a>           <span class="at">cell_color =</span> <span class="st">&#39;leiden_clus&#39;</span>,</span>
<span id="cb204-4"><a href="interactivity-with-the-rspatial-ecosystem.html#cb204-4" tabindex="-1"></a>           <span class="at">show_image =</span> T,</span>
<span id="cb204-5"><a href="interactivity-with-the-rspatial-ecosystem.html#cb204-5" tabindex="-1"></a>           <span class="at">point_size =</span> <span class="fl">0.5</span>,</span>
<span id="cb204-6"><a href="interactivity-with-the-rspatial-ecosystem.html#cb204-6" tabindex="-1"></a>           <span class="at">point_shape =</span> <span class="st">&#39;no_border&#39;</span>,</span>
<span id="cb204-7"><a href="interactivity-with-the-rspatial-ecosystem.html#cb204-7" tabindex="-1"></a>           <span class="at">background_color =</span> <span class="st">&#39;black&#39;</span>,</span>
<span id="cb204-8"><a href="interactivity-with-the-rspatial-ecosystem.html#cb204-8" tabindex="-1"></a>           <span class="at">save_plot =</span> F,</span>
<span id="cb204-9"><a href="interactivity-with-the-rspatial-ecosystem.html#cb204-9" tabindex="-1"></a>           <span class="at">show_legend =</span> <span class="cn">TRUE</span>)</span>
<span id="cb204-10"><a href="interactivity-with-the-rspatial-ecosystem.html#cb204-10" tabindex="-1"></a></span>
<span id="cb204-11"><a href="interactivity-with-the-rspatial-ecosystem.html#cb204-11" tabindex="-1"></a><span class="fu">spatPlot2D</span>(<span class="at">gobject =</span> subcell_v_brain,</span>
<span id="cb204-12"><a href="interactivity-with-the-rspatial-ecosystem.html#cb204-12" tabindex="-1"></a>           <span class="at">spat_unit =</span> <span class="st">&#39;stardist_cell&#39;</span>,</span>
<span id="cb204-13"><a href="interactivity-with-the-rspatial-ecosystem.html#cb204-13" tabindex="-1"></a>           <span class="at">cell_color =</span> <span class="st">&#39;leiden_clus&#39;</span>,</span>
<span id="cb204-14"><a href="interactivity-with-the-rspatial-ecosystem.html#cb204-14" tabindex="-1"></a>           <span class="at">show_image =</span> T,</span>
<span id="cb204-15"><a href="interactivity-with-the-rspatial-ecosystem.html#cb204-15" tabindex="-1"></a>           <span class="at">point_size =</span> <span class="fl">0.1</span>,</span>
<span id="cb204-16"><a href="interactivity-with-the-rspatial-ecosystem.html#cb204-16" tabindex="-1"></a>           <span class="at">point_shape =</span> <span class="st">&#39;no_border&#39;</span>,</span>
<span id="cb204-17"><a href="interactivity-with-the-rspatial-ecosystem.html#cb204-17" tabindex="-1"></a>           <span class="at">background_color =</span> <span class="st">&#39;black&#39;</span>,</span>
<span id="cb204-18"><a href="interactivity-with-the-rspatial-ecosystem.html#cb204-18" tabindex="-1"></a>           <span class="at">show_legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb204-19"><a href="interactivity-with-the-rspatial-ecosystem.html#cb204-19" tabindex="-1"></a>           <span class="at">save_plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb204-20"><a href="interactivity-with-the-rspatial-ecosystem.html#cb204-20" tabindex="-1"></a>           <span class="at">save_param =</span> <span class="fu">list</span>(<span class="at">save_name =</span> <span class="st">&#39;03_ses6_subcell_spat&#39;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-291"></span>
<img src="img/03_session6/03_ses6_spat_plots.png" alt="Spatial plots showing leiden clustering mapped onto the base visium spots (left) and individual nuceli through interpolation (right)" width="100%" />
<p class="caption">
Figure 16.9: Spatial plots showing leiden clustering mapped onto the base visium spots (left) and individual nuceli through interpolation (right)
</p>
</div>
</div>
<div id="cropping-objects" class="section level3 hasAnchor" number="16.6.6">
<h3><span class="header-section-number">16.6.6</span> Cropping objects<a href="interactivity-with-the-rspatial-ecosystem.html#cropping-objects" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-1" tabindex="-1"></a>subcell_v_brain_crop <span class="ot">&lt;-</span> <span class="fu">subsetGiottoLocs</span>(<span class="at">gobject =</span> subcell_v_brain,</span>
<span id="cb205-2"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-2" tabindex="-1"></a>                           <span class="at">spat_unit =</span> <span class="st">&quot;:all:&quot;</span>,</span>
<span id="cb205-3"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-3" tabindex="-1"></a>                           <span class="at">x_min =</span> <span class="dv">4000</span>,</span>
<span id="cb205-4"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-4" tabindex="-1"></a>                           <span class="at">x_max =</span> <span class="dv">7000</span>,</span>
<span id="cb205-5"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-5" tabindex="-1"></a>                           <span class="at">y_min =</span> <span class="sc">-</span><span class="dv">6500</span>,</span>
<span id="cb205-6"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-6" tabindex="-1"></a>                           <span class="at">y_max =</span> <span class="sc">-</span><span class="dv">3500</span>,</span>
<span id="cb205-7"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-7" tabindex="-1"></a>                           <span class="at">z_max =</span> <span class="cn">NULL</span>,</span>
<span id="cb205-8"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-8" tabindex="-1"></a>                           <span class="at">z_min =</span> <span class="cn">NULL</span>)</span>
<span id="cb205-9"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-9" tabindex="-1"></a></span>
<span id="cb205-10"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-10" tabindex="-1"></a><span class="fu">spatPlot2D</span>(<span class="at">gobject =</span> subcell_v_brain_crop,</span>
<span id="cb205-11"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-11" tabindex="-1"></a>           <span class="at">spat_unit =</span> <span class="st">&#39;cell&#39;</span>,</span>
<span id="cb205-12"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-12" tabindex="-1"></a>           <span class="at">cell_color =</span> <span class="st">&#39;leiden_clus&#39;</span>,</span>
<span id="cb205-13"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-13" tabindex="-1"></a>           <span class="at">show_image =</span> T,</span>
<span id="cb205-14"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-14" tabindex="-1"></a>           <span class="at">point_size =</span> <span class="dv">2</span>,</span>
<span id="cb205-15"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-15" tabindex="-1"></a>           <span class="at">point_shape =</span> <span class="st">&#39;no_border&#39;</span>,</span>
<span id="cb205-16"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-16" tabindex="-1"></a>           <span class="at">background_color =</span> <span class="st">&#39;black&#39;</span>,</span>
<span id="cb205-17"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-17" tabindex="-1"></a>           <span class="at">show_legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb205-18"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-18" tabindex="-1"></a>           <span class="at">save_plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb205-19"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-19" tabindex="-1"></a>           <span class="at">save_param =</span> <span class="fu">list</span>(<span class="at">save_name =</span> <span class="st">&#39;03_ses6_vis_spat_crop&#39;</span>))</span>
<span id="cb205-20"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-20" tabindex="-1"></a></span>
<span id="cb205-21"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-21" tabindex="-1"></a><span class="fu">spatPlot2D</span>(<span class="at">gobject =</span> subcell_v_brain_crop,</span>
<span id="cb205-22"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-22" tabindex="-1"></a>           <span class="at">spat_unit =</span> <span class="st">&#39;stardist_cell&#39;</span>,</span>
<span id="cb205-23"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-23" tabindex="-1"></a>           <span class="at">cell_color =</span> <span class="st">&#39;leiden_clus&#39;</span>,</span>
<span id="cb205-24"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-24" tabindex="-1"></a>           <span class="at">show_image =</span> T,</span>
<span id="cb205-25"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-25" tabindex="-1"></a>           <span class="at">point_size =</span> <span class="fl">0.1</span>,</span>
<span id="cb205-26"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-26" tabindex="-1"></a>           <span class="at">point_shape =</span> <span class="st">&#39;no_border&#39;</span>,</span>
<span id="cb205-27"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-27" tabindex="-1"></a>           <span class="at">background_color =</span> <span class="st">&#39;black&#39;</span>,</span>
<span id="cb205-28"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-28" tabindex="-1"></a>           <span class="at">show_legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb205-29"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-29" tabindex="-1"></a>           <span class="at">save_plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb205-30"><a href="interactivity-with-the-rspatial-ecosystem.html#cb205-30" tabindex="-1"></a>           <span class="at">save_param =</span> <span class="fu">list</span>(<span class="at">save_name =</span> <span class="st">&#39;03_ses6_subcell_spat_crop&#39;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-293"></span>
<img src="img/03_session6/03_ses_spat_crop.png" alt="Spatial plots showing leiden clustering mapped onto the base visium spots (left) and individual nuceli through interpolation (right)" width="100%" />
<p class="caption">
Figure 16.10: Spatial plots showing leiden clustering mapped onto the base visium spots (left) and individual nuceli through interpolation (right)
</p>
</div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="interoperability-with-isolated-tools.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="contributing-to-giotto.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
